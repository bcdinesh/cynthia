# Exported from:        https://xebiarlmgmt.wdprapps.disney.com/
# Release version:      25.3.1-1124.941
# Date created:         Wed Dec 31 16:45:41 UTC 2025

---
apiVersion: xl-release/v1
kind: Templates
metadata:
  path: /
  home: Gitops
spec:
- template: Deploy + SE - Optional
  scheduledStartDate: 2020-06-29T03:30:00Z
  phases:
  - phase: Initialize
    tasks:
    - name: Initialize
      type: xlrelease.SequentialGroup
      tasks:
      - name: PCP Release
        type: delivery.FindOrCreateDelivery
        searchStrategy: Search by criteria
        nameFilter: "PCP Release ${delivery_effort}"
        fallback: true
        ^title: "PCP Release ${delivery_effort}"
        pattern: Cynthia/PCP Release
        flagStatus: ATTENTION_NEEDED
        flagComment: "Task 'PCP Release' in Phase '`c e wvy' has properties that do\
          \ not match with the known type. Following properties do not match: [configurationUri]."
        variableMapping:
          pythonScript.deliveryId: "${delivery_id}"
      - name: Register
        type: delivery.RegisterTrackedItems
        delivery: "${delivery_id}"
        flagStatus: ATTENTION_NEEDED
        flagComment: "Task 'Register' in Phase '`c e wvy' has properties that do not\
          \ match with the known type. Following properties do not match: [configurationUri]."
        variableMapping:
          pythonScript.trackedItems: "${application}"
      - name: Capture Release Date
        type: webhook.JsonWebhook
        URL: "https://xebiarlmgmt.wdprapps.disney.com/api/v1/releases/byTitle?releaseTitle=${release.title}"
        username: admin
        password: !value "webhook_JsonWebhook_Capture_Release_Date_password"
        jsonPathExpression: "$[0].startDate"
        jsonPathExpression2: "$[0].dueDate"
        precondition: "False"
        variableMapping:
          pythonScript.result: "${sdate}"
          pythonScript.result2: "${edate}"
      - name: Initialize App Data
        type: xlrelease.ScriptTask
        script: |-
          #app_name=releaseVariables['${app_name}']
          #variable_map=releaseVariables['${app_name}']

          #######Automation Testing######
          #if 'stage_test' in variable_map  and variable_map['stage_test'] != '':
          #    releaseVariables['stage_test']=variable_map['stage_test']

          #if 'load_test' in variable_map  and variable_map['load_test'] != '':
          #    releaseVariables['load_test']=variable_map['load_test']

          #if 'shield_report' in variable_map  and variable_map['shield_report'] != '':
          #    releaseVariables['shield_report']=variable_map['shield_report']

          ##############################

          #releaseVariables['harnessAccountId']=variable_map['harnessAccountId']
          #releaseVariables['harnessOrgId']=variable_map['harnessOrgId']
          #releaseVariables['harnessPAT']=variable_map['harnessPAT']
          #releaseVariables['harnessPipelineIdentifier']=variable_map['harnessPipelineIdentifier']
          #releaseVariables['harnessProjectIdentifier']=variable_map['harnessProjectIdentifier']
          #releaseVariables['app_bappid']=variable_map['app_bappid']
          #releaseVariables['app_gitorg']=variable_map['app_gitorg']
          #releaseVariables['app_gitrepo']=variable_map['app_gitrepo']
          #releaseVariables['app_buildjob']=variable_map['app_buildjob']
          #releaseVariables['app_deployjob']=variable_map['app_deployjob']
          #releaseVariables['app_stagevalidateendpoint']=variable_map['app_stagevalidateendpoint']
          #releaseVariables['app_loadvalidateendpoint']=variable_map['app_loadvalidateendpoint']
          #releaseVariables['app_jenkins_build_url']=variable_map['app_jenkins_base_url'] + 'job/' + releaseVariables['app_buildjob']
          #releaseVariables['app_jenkins_deploy_url']=variable_map['app_jenkins_base_url'] + 'job/' + releaseVariables['app_deployjob']
          #releaseVariables['service_owner']=variable_map['service_owner']
          #releaseVariables['chg_peerapproval_group']=variable_map['chg_peerapproval_group']
          #releaseVariables['app_prodvalidateendpoint']=variable_map['app_prodvalidateendpoint']
          #releaseVariables['project_key']=variable_map['project_key']
          #releaseVariables['chg_ctaskassignment_group']=variable_map['chg_ctaskassignment_group']

          #brand=releaseVariables['${select_brand}']
          #variable_map=releaseVariables['${select_brand}']
          #releaseVariables['start']=variable_map['start']
          #releaseVariables['end']=variable_map['end']
          #releaseVariables['backout_rollback_time']=variable_map['backout_rollback_time']
          #releaseVariables['std_mnt_window']=variable_map['std_mnt_window']

          folderVar = folderVariables['folder.${app_name}']

          for var_entry in folderVar.keys():
              if(var_entry=="app_brand"):
                  app_brand = folderVar[var_entry]
              else:
                  releaseVariables[var_entry] = folderVar[var_entry]
                  print "key: "+var_entry+" = "+releaseVariables[var_entry]+"===>"+folderVar[var_entry]

          brand=releaseVariables['${select_brand}']
          variable_map=releaseVariables['${select_brand}']
          releaseVariables['start']=variable_map['start']
          releaseVariables['end']=variable_map['end']
          releaseVariables['backout_rollback_time']=variable_map['backout_rollback_time']
          releaseVariables['std_mnt_window']=variable_map['std_mnt_window']

          #releaseVariables['app_jenkins_build_url']='${app_jenkins_base_url}' + 'job/' + '${app_buildjob}'
          #releaseVariables['app_jenkins_deploy_url']='${app_jenkins_base_url}' + 'job/' + '${app_deployjob}'
      - name: Date Format for PROD CHG and OutLook Invite
        type: xlrelease.ScriptTask
        script: |-
          from java.text import SimpleDateFormat
          from java.util import Calendar

          app_brand = releaseVariables.get('select_brand')

          due_date_obj = release.dueDate

          date_format = SimpleDateFormat("yyyy-MM-dd")
          output_format = SimpleDateFormat("MM/dd/yy HH:mm")

          if due_date_obj:
              cal = Calendar.getInstance()
              cal.setTime(due_date_obj)

              if app_brand == "DLR":
                  # Start and end date both equal due date
                  start_date_str = date_format.format(due_date_obj)
                  end_date_str = date_format.format(due_date_obj)

                  print("DLR brand detected")
                  print("start_date (YYYY-MM-DD): %s" % start_date_str)
                  print("end_date (YYYY-MM-DD): %s" % end_date_str)

                  releaseVariables['start_date'] = start_date_str
                  releaseVariables['end_date'] = end_date_str

                  start_datetime_str = start_date_str + " ${start}"
                  end_datetime_str = end_date_str + " ${end}"

              else:
                  # WDW or default: start date = due date - 1 day, end date = due date
                  cal.add(Calendar.DAY_OF_MONTH, -1)
                  adjusted_start_date_obj = cal.getTime()
                  adjusted_start_date_str = date_format.format(adjusted_start_date_obj)
                  due_date_str = date_format.format(due_date_obj)

                  print("WDW or default brand detected")
                  print("start_date (YYYY-MM-DD): %s" % adjusted_start_date_str)
                  print("end_date (YYYY-MM-DD): %s" % due_date_str)

                  releaseVariables['start_date'] = adjusted_start_date_str
                  releaseVariables['end_date'] = due_date_str

                  start_datetime_str = adjusted_start_date_str + " ${start}"
                  end_datetime_str = due_date_str + " ${end}"

              datetime_parser = SimpleDateFormat("yyyy-MM-dd HH:mm:ss")

              start_datetime_obj = datetime_parser.parse(start_datetime_str)
              end_datetime_obj = datetime_parser.parse(end_datetime_str)

              event_start_str = output_format.format(start_datetime_obj)
              event_end_str = output_format.format(end_datetime_obj)

              print("event_start: %s" % event_start_str)
              print("event_end: %s" % event_end_str)

              releaseVariables['event_start'] = event_start_str
              releaseVariables['event_end'] = event_end_str

          else:
              print("Due date is not set; cannot calculate dates.")
      - name: Lambda Deploy Options Update Check
        type: xlrelease.ScriptTask
        script: |-
          # === DYNAMIC MULTI-TEXT VARIABLE ===
          app_name = releaseVariables.get('app_name', '').lower()
          lambda_apps_list = releaseVariables.get('lambdaAppsList', [])

          # Check if current app is in lambda apps list
          is_lambda_app = False
          for lambda_app in lambda_apps_list:
              if lambda_app.lower() in app_name:
                  is_lambda_app = True
                  break

          # Update rundeck_deploy_lambda_options MULTI-TEXT variable (Jython 2.7 compatible)
          lambda_multi_text_var = 'rundeck_deploy_lambda_options'

          if is_lambda_app:
              releaseVariables[lambda_multi_text_var] = "function: all\nstage: live"
              print "üêë Lambda app (%s): set rundeck_deploy_lambda_options to Lambda content" % app_name
          else:
              releaseVariables[lambda_multi_text_var] = ""
              print "üì± Standard app (%s): cleared rundeck_deploy_lambda_options" % app_name

          print "rundeck_deploy_lambda_options content: '%s'" % releaseVariables[lambda_multi_text_var]
      - name: SmartSheet APP Update As per DueDate
        type: xlrelease.ScriptTask
        script: |-
          from java.net import URL
          from java.io import BufferedReader, InputStreamReader, DataOutputStream
          from java.text import SimpleDateFormat
          from java.util import Locale, TimeZone, Date
          import com.xhaus.jyson.JysonCodec as json

          # --- Configuration & Inputs ---
          smartsheet_token = "Bearer " + releaseVariables['smart_api_token']
          sheet_id = releaseVariables['smartsheet_sheet_id']

          month_year_col_name = "Project/Studio"
          task_desc_col_name = "Task Description"
          release_version_col_name = "Release Version Link"
          added_by_col_name = "Added By"
          date_col_name = "Date"
          completed_row_value = "COMPLETED"

          release_type_col_name = "Type of Release"
          brand_col_name = "Brand"
          brand_value = releaseVariables['select_brand']

          app_name = releaseVariables['app_name']
          build_version = releaseVariables['build_version']
          added_by = releaseVariables['bot']

          due_date_obj = release.dueDate
          if not due_date_obj:
              raise Exception("Release dueDate is not set.")

          month_year_format = SimpleDateFormat("MMMM yyyy", Locale.US)
          date_format = SimpleDateFormat("MM/dd/yy")
          iso_format = SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss'Z'")
          iso_format.setTimeZone(TimeZone.getTimeZone("UTC"))
          due_date_obj_iso = iso_format.format(due_date_obj)
          month_year_str = month_year_format.format(due_date_obj)
          due_date_str = date_format.format(due_date_obj)

          def smartsheet_api(url, method="GET", payload=None):
              try:
                  conn = URL(url).openConnection()
                  conn.setRequestMethod(method)
                  conn.setRequestProperty("Authorization", smartsheet_token)
                  conn.setRequestProperty("Content-Type", "application/json")
                  if payload is not None:
                      conn.setDoOutput(True)
                      wr = DataOutputStream(conn.getOutputStream())
                      wr.writeBytes(payload)
                      wr.flush()
                      wr.close()
                  if conn.getResponseCode() >= 400:
                      err_stream = conn.getErrorStream()
                      reader = BufferedReader(InputStreamReader(err_stream))
                      err_msg = ""
                      line = reader.readLine()
                      while line:
                          err_msg += line
                          line = reader.readLine()
                      reader.close()
                      raise Exception("HTTP Error %s: %s" % (conn.getResponseCode(), err_msg))
                  in_stream = conn.getInputStream()
                  reader = BufferedReader(InputStreamReader(in_stream))
                  result = ""
                  line = reader.readLine()
                  while line:
                      result += line
                      line = reader.readLine()
                  reader.close()
                  return result
              except Exception as e:
                  print("API call failed: %s" % e)
                  raise

          sheet_url = "https://api.smartsheet.com/2.0/sheets/%s" % sheet_id
          update_url = "https://api.smartsheet.com/2.0/sheets/%s/rows" % sheet_id

          sheet_json = json.loads(smartsheet_api(sheet_url))
          columns = sheet_json['columns']
          rows = sheet_json['rows']

          col_map = {c['title']: c['id'] for c in columns}

          month_year_col_id = col_map[month_year_col_name]
          task_desc_col_id = col_map[task_desc_col_name]
          release_version_col_id = col_map[release_version_col_name]
          added_by_col_id = col_map[added_by_col_name]
          date_col_id = col_map[date_col_name]
          release_type_col_id = col_map[release_type_col_name]
          brand_col_id = col_map[brand_col_name]

          # Date parsers
          iso_with_ms_z = SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss.SSS'Z'")
          iso_with_ms_z.setTimeZone(TimeZone.getTimeZone("UTC"))
          iso_with_z = SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss'Z'")
          iso_with_z.setTimeZone(TimeZone.getTimeZone("UTC"))
          iso_date_only = SimpleDateFormat("yyyy-MM-dd")
          parsers = [iso_with_ms_z, iso_with_z, iso_date_only, date_format]

          def robust_parse_date(date_val):
              if isinstance(date_val, Date):
                  return date_val
              s = str(date_val).strip()
              for parser in parsers:
                  try:
                      return parser.parse(s)
                  except:
                      pass
              return None

          # Search for Month YYYY in all rows (skip COMPLETED)
          month_year_rows = []
          for row in rows:
              for cell in row.get('cells', []):
                  if cell['columnId'] == month_year_col_id:
                      val = str(cell.get('value', '')).strip()
                      if val.upper() == completed_row_value:
                          break
                      if val == month_year_str:
                          month_year_rows.append(row)
                      break

          if not month_year_rows:
              print("No matching Month YYYY rows found for '%s'." % month_year_str)

          for parent_row in month_year_rows:
              parent_row_id = parent_row['id']
              print("\nFound Month YYYY row: ID=%s" % parent_row_id)

              # Gather children, skip COMPLETED
              child_rows = []
              for row in rows:
                  if row.get('parentId') == parent_row_id:
                      skip = False
                      for cell in row.get('cells', []):
                          if cell['columnId'] == month_year_col_id:
                              if str(cell.get('value', '')).strip().upper() == completed_row_value:
                                  skip = True
                                  break
                      if not skip:
                          child_rows.append(row)

              # Check for matching child by App/Build/Date
              matched_row = None
              for child_row in child_rows:
                  tdesc_val = None
                  rver_val = None
                  due_date_val_str = None
                  for cell in child_row.get('cells', []):
                      if cell['columnId'] == task_desc_col_id:
                          tdesc_val = cell.get('value')
                      elif cell['columnId'] == release_version_col_id:
                          rver_val = cell.get('value')
                      elif cell['columnId'] == date_col_id:
                          val = cell.get('value')
                          parsed_date = robust_parse_date(val)
                          if parsed_date:
                              due_date_val_str = date_format.format(parsed_date)
                  if tdesc_val == app_name and rver_val == build_version and due_date_val_str == due_date_str:
                      matched_row = child_row
                      break

              if matched_row:
                  print("  MATCH FOUND for App=%s, Build=%s, Date=%s at row ID=%s" % (app_name, build_version, due_date_str, matched_row['id']))
              else:
                  # -- Insert new row with all info; find date position --
                  due_time = due_date_obj.getTime()
                  closest_future_row = None
                  closest_future_diff = None

                  for row in child_rows:
                      row_date_val = None
                      for cell in row.get('cells', []):
                          if cell['columnId'] == date_col_id:
                              val = cell.get('displayValue') or cell.get('value')
                              row_date_val = robust_parse_date(val)
                              break
                      if row_date_val is None:
                          continue
                      diff = row_date_val.getTime() - due_time
                      if diff >= 0:
                          if closest_future_diff is None or diff < closest_future_diff:
                              closest_future_diff = diff
                              closest_future_row = row

                  if closest_future_row is not None:
                      sibling_row = closest_future_row
                      position_desc = "before row with future date %s" % sibling_row['id']
                      new_row_payload = {
                          "siblingId": sibling_row['id'],
                          "above": True,
                          "cells": [
                              {"columnId": task_desc_col_id, "value": app_name},
                              {"columnId": release_version_col_id, "value": build_version},
                              {"columnId": added_by_col_id, "value": added_by},
                              {"columnId": date_col_id, "value": due_date_obj_iso},
                              {"columnId": release_type_col_id, "value": "IR"},
                              {"columnId": brand_col_id, "value": brand_value}
                          ]
                      }
                  else:
                      new_row_payload = {
                          "parentId": parent_row_id,
                          "toBottom": True,
                          "cells": [
                              {"columnId": task_desc_col_id, "value": app_name},
                              {"columnId": release_version_col_id, "value": build_version},
                              {"columnId": added_by_col_id, "value": added_by},
                              {"columnId": date_col_id, "value": due_date_obj_iso},
                              {"columnId": release_type_col_id, "value": "IR"},
                              {"columnId": brand_col_id, "value": brand_value}
                          ]
                      }
                      position_desc = "at parent bottom"
                  print("  No match found, inserting new row %s..." % position_desc)
                  result = smartsheet_api(update_url, "POST", json.dumps([new_row_payload]))
                  print("  ‚úÖ New row added %s. API Response: %s" % (position_desc, result))

          print("\nScript finished.")
      - name: Initialize Release
        type: delivery.MarkTrackedItems
        stage: Initialize Release
        delivery: "${delivery_id}"
        pattern: Cynthia/PCP Release
        flagStatus: ATTENTION_NEEDED
        flagComment: "Task 'Initialize Release' in Phase '`c e wvy' has properties\
          \ that do not match with the known type. Following properties do not match:\
          \ [configurationUri]."
        variableMapping:
          pythonScript.trackedItems: "${application}"
    color: "#0079BC"
  - phase: MY JIRA
    tasks:
    - name: JIRA Info
      type: xlrelease.SequentialGroup
      tasks:
      - name: Jira Query
        type: jira.Query
        jiraServer: MyJira
        query: "fixVersion = \"${app_name} ${Release_Version}\""
        flagStatus: ATTENTION_NEEDED
        flagComment: "Task 'Jira Query' in Phase 'MY JIRA' has properties that do\
          \ not match with the known type. Following properties do not match: [cust,\
          \ cust1, custom]."
        precondition: "False"
        variableMapping:
          pythonScript.issues: "${JiraTicketSummary}"
      - name: Jira Query
        type: jira.Query
        jiraServer: MyJira
        query: "fixVersion = \"${app_name} ${Release_Version}\""
        variableMapping:
          pythonScript.issues: "${JiraTicketSummary}"
          pythonScript.issueKeys: "${JiraIssueIds}"
      - name: Jira Script
        type: xlrelease.ScriptTask
        taskRecoverOp: SKIP_TASK
        script: |-
          # Get the Jira ticket summary dictionary
          jira_summary = releaseVariables['JiraTicketSummary']

          # Check if the dictionary exists and is not empty
          if not jira_summary:
              print("ERROR: Unable to fetch any issues and summary for the Jira query. Please take a look at JIRA QUERY TASK AND MAKESURE THE QUERY STRING OR FIX VERSION  IS VALID IN YOUR TICKETS.")
              raise Exception("Unable to fetch any issues and summary for the Jira query. Please take a look at Fix Version.")

          # Process the ticket summary
          str_list = []
          for issue, summary in jira_summary.items():
              # Force all text to unicode, then encode to UTF-8 (if needed for the environment)
              issue_u = unicode(issue)
              summary_u = unicode(summary)
              line = u"<a href='https://myjira.disney.com/browse/{}'>{}</a>: {}".format(issue_u, issue_u, summary_u)
              str_list.append(line)

          # Join as Unicode, then encode safely if necessary
          final_result = u'<br/>'.join(str_list)

          # Optionally encode for setting release variable if your environment needs str, not unicode
          releaseVariables['JiraTicketDetails1'] = final_result  # safe if releaseVariables supports Unicode

          print(final_result.encode('utf-8'))
      - name: Jira Script
        type: xlrelease.ScriptTask
        taskRecoverOp: RESTART_PHASE
        script: |-
          str_list = []

          for issue, summary in releaseVariables['JiraTicketSummary'].items():
              issue_u = unicode(issue)
              summary_u = unicode(summary)
              line = u"{}: {}".format(issue_u, summary_u)
              str_list.append(line)

          # Join each line with a line break
          final_str = u'<br/>'.join(str_list)

          # Store in release variable, encoding as UTF-8 string if needed
          releaseVariables['JiraTicketDetails2'] = final_str

          # Optional: print for logging/debugging (encoding to UTF-8 bytes if required)
          print(final_str.encode('utf-8'))
      - name: "Git Compare Tag Within ${Release_Version} Script"
        type: xlrelease.ScriptTask
        script: |-
          from java.net import URL
          from java.util import Scanner
          import json
          import time
          from distutils.version import LooseVersion

          # === CONFIGURATION ===
          GITHUB_API_URL = "https://github.disney.com/api/v3"
          REPO = "${app_gitorg}/${app_gitrepo}"
          REPO_URL = "https://github.disney.com/" + REPO
          RELEASE_PREFIX = "v${Release_Version}"

          # Secure token
          GITHUB_TOKEN = releaseVariables["githubToken"]

          # === HELPERS ===

          def get_json(url_str, extra_accept=None):
              url = URL(url_str)
              conn = url.openConnection()
              conn.setRequestProperty("Authorization", "Bearer " + GITHUB_TOKEN)
              if extra_accept:
                  conn.setRequestProperty("Accept", extra_accept)
              else:
                  conn.setRequestProperty("Accept", "application/vnd.github+json")
              conn.setRequestMethod("GET")
              conn.connect()
              code = conn.getResponseCode()
              if code != 200:
                  raise Exception("GitHub API failed: {} -> {}".format(url_str, code))
              scanner = Scanner(conn.getInputStream()).useDelimiter("\\A")
              resp = scanner.hasNext() and scanner.next() or ""
              scanner.close()
              return json.loads(resp)

          def parse_iso_date(s):
              # Parse ISO 8601 date, ignore timezone for simplicity
              return time.strptime(s[:19], "%Y-%m-%dT%H:%M:%S")

          def safe_join_utf8(lines):
              encoded_lines = []
              for line in lines:
                  if isinstance(line, unicode):
                      encoded_lines.append(line.encode('utf-8'))
                  elif isinstance(line, str):
                      encoded_lines.append(line)
                  else:
                      encoded_lines.append(str(line).encode('utf-8'))
              return "\n".join(encoded_lines)


          def get_all_tags_paginated(api_url, repo):
              """Fetches all tags from a repository, handling pagination."""
              all_tags = []
              page = 1
              per_page = 50
              while True:
                  url = "{}/repos/{}/tags?page={}&per_page={}".format(api_url, repo, page, per_page)
                  print("Fetching tags from: {}".format(url))

                  page_of_tags = get_json(url)
                  if not page_of_tags:
                      break

                  all_tags.extend(page_of_tags)

                  if len(page_of_tags) < per_page:
                      break

                  page += 1
              return all_tags

          # --- Step 1: Get all tags and filter them ---
          all_repo_tags = get_all_tags_paginated(GITHUB_API_URL, REPO)

          if not all_repo_tags:
              raise Exception("No tags found at all in the repository '{}'.".format(REPO))

          print("Found {} total tags. Filtering for prefix '{}'...".format(len(all_repo_tags), RELEASE_PREFIX))

          matching_tag_names = []
          for tag in all_repo_tags:
              name = tag.get("name")
              if name and name.startswith(RELEASE_PREFIX + "-"):
                  matching_tag_names.append(name)

          if not matching_tag_names:
              raise Exception("No tags with prefix '{}' found.".format(RELEASE_PREFIX))

          print("Found {} matching tags: {}".format(len(matching_tag_names), matching_tag_names))

          sorted_tags = sorted(matching_tag_names, key=LooseVersion)

          ### MODIFIED LOGIC BLOCK START ###

          # --- Step 1b: Determine comparison range based on number of tags ---
          if len(sorted_tags) == 1:
              # --- SINGLE TAG LOGIC ---
              # Only one tag was found. Compare it against its parent commit to get its history.
              lastTag = sorted_tags[0]
              print("Only one matching tag found: '{}'. Comparing it against its parent commit.".format(lastTag))

              # Get the commit data for this tag to find its parent
              commit_url = "{}/repos/{}/commits/{}".format(GITHUB_API_URL, REPO, lastTag)
              print("Fetching commit data for tag from: {}".format(commit_url))
              commit_data = get_json(commit_url)

              parents = commit_data.get("parents")
              if not parents:
                  # This is the very first commit in the repository; it has no parent.
                  # We will compare it against a known "empty tree" SHA to get all commits.
                  initialTag = "4b825dc642cb6eb9a060e54bf8d69288fbee4904"
                  print("Tag points to the initial commit. Comparing against the empty tree.")
              else:
                  # Use the first parent's SHA as the base for comparison
                  initialTag = parents[0].get("sha")
                  if not initialTag:
                      raise Exception("Could not find the parent commit SHA for tag '{}'".format(lastTag))
                  print("Found parent commit SHA: '{}'. This will be the base for comparison.".format(initialTag))

          elif len(sorted_tags) > 1:
              # --- MULTI-TAG LOGIC (Original behavior) ---
              # More than one tag found, so compare the earliest and latest.
              initialTag = sorted_tags[0]
              lastTag = sorted_tags[-1]
              print("Multiple tags found. Comparing between '{}' and '{}'.".format(initialTag, lastTag))

          ### MODIFIED LOGIC BLOCK END ###


          # --- Step 2: Compare tags
          # This step now works for both single and multi-tag scenarios
          compare_url = GITHUB_API_URL + "/repos/{}/compare/{}...{}".format(REPO, initialTag, lastTag)
          print("Fetching comparison data from: {}".format(compare_url))
          compare = get_json(compare_url)

          # --- Step 3: Files changed
          filesChangedList = [f["filename"] for f in compare.get("files", [])]

          # --- Step 4: Commit logs
          commit_shas = []
          commitLogsList = []
          commitLogsFormattedList = []
          for c in compare.get("commits", []):
              sha = c["sha"]
              commit_shas.append(sha)
              msg = c["commit"]["message"]
              author = c["commit"]["author"]["name"]
              date = c["commit"]["author"]["date"]
              commitLogsList.append({
                  "commitID": sha,
                  "commitMessage": msg,
                  "author": author,
                  "date": date
              })
              commit_url = REPO_URL + "/commit/" + sha
              commitLogsFormattedList.append(u"[{}]({}) : {}".format(sha[:7], commit_url, msg.split("\n")[0]))

          # --- Step 5: PRs via commits
          prs_between_tags = []
          seen_pr_ids = set()
          pr_links_formatted = []
          pr_urls_only = []

          for sha in commit_shas:
              pr_url = GITHUB_API_URL + "/repos/{}/commits/{}/pulls".format(REPO, sha)
              try:
                  pr_objs = get_json(pr_url, extra_accept="application/vnd.github.groot-preview+json")
              except:
                  pr_objs = []
              for pr in pr_objs:
                  pr_id = pr.get("number")
                  if pr_id and pr.get("merged_at") and pr_id not in seen_pr_ids:
                      pr_link = REPO_URL + "/pull/" + str(pr_id)
                      title = pr.get("title", "")
                      entry = {
                          "number": pr_id,
                          "title": title,
                          "user": pr.get("user", {}).get("login"),
                          "merged_at": pr.get("merged_at"),
                          "url": pr_link
                      }
                      prs_between_tags.append(entry)
                      pr_links_formatted.append(u"[PR #{}]({}) : {}".format(pr_id, pr_link, title))
                      pr_urls_only.append(pr_link)
                      seen_pr_ids.add(pr_id)

          # --- Step 6: Build result dictionary
          result = {
              "initialTag": initialTag,
              "lastTag": lastTag,
              "filesChanged": filesChangedList,
              "commitLogs": commitLogsList,
              "pullRequests": prs_between_tags
          }

          # --- Step 7: Prepare safe UTF-8 joined strings for output and variables
          commitLogsFormattedJoined = safe_join_utf8(commitLogsFormattedList)
          prLinksFormattedJoined = safe_join_utf8(pr_links_formatted)
          prUrlsOnlyJoined = safe_join_utf8(pr_urls_only)

          # --- Step 8: Logging (print)
          print("Initial Tag: " + initialTag.encode('utf-8'))
          print("Last Tag: " + lastTag.encode('utf-8'))
          print("Files Changed:\n" + json.dumps(filesChangedList, indent=2).encode('utf-8'))
          print("Commit Logs:\n" + json.dumps(commitLogsList, indent=2).encode('utf-8'))
          print("Formatted Commit Logs:\n" + commitLogsFormattedJoined)
          print("Pull Requests:\n" + json.dumps(prs_between_tags, indent=2).encode('utf-8'))
          print("Formatted PRs:\n" + prLinksFormattedJoined)
          print("PR URLs:\n" + prUrlsOnlyJoined)

          # --- Step 9: Set release variables (assign UTF-8 encoded byte strings)
          releaseVariables["initialTag"] = initialTag.encode('utf-8')
          releaseVariables["lastTag"] = lastTag.encode('utf-8')
          releaseVariables["filesChanged"] = json.dumps(filesChangedList).encode('utf-8')
          releaseVariables["commitLogs"] = json.dumps(commitLogsList).encode('utf-8')
          releaseVariables["commitLogsFormatted"] = commitLogsFormattedJoined
          releaseVariables["pullRequests"] = json.dumps(prs_between_tags).encode('utf-8')
          releaseVariables["pullRequestLinksFormatted"] = prLinksFormattedJoined
          releaseVariables["pullRequestUrlsOnly"] = prUrlsOnlyJoined
          releaseVariables["githubCompareResult"] = json.dumps(result, indent=2).encode('utf-8')
      - name: Compare Release Version Tag
        type: xlrelease.UnknownType
        flagStatus: ATTENTION_NEEDED
        flagComment: Task 'Compare Release Version Tag' in Phase 'MY JIRA' has been
          replaced by an unknown task. The task of type 'github.CompareTag' could
          not be found because of a missing plugin.
        precondition: "False"
        variableMapping:
          pythonScript.initialTag: "${initialTag}"
          pythonScript.commitLogsFormatted: "${commitLogsFormatted}"
          pythonScript.lastTag: "${lastTag}"
          pythonScript.pullRequestLinksFormatted: "${pullRequestLinksFormatted}"
          pythonScript.pullRequestUrlsOnly: "${pullRequestUrlsOnly}"
          pythonScript.filesChanged: "${filesChanged}"
          pythonScript.commitLogs: "${commitLogs}"
      - name: My Jira Teams Notification
        type: msteams.Notification
        channel: "#${channel_name}"
        message: |-
          üì¢ **Jira Notification**

          A Release has been triggered and is associated with the following JIRA issues:

          ---

          üõ†Ô∏è **Application**: ${app_name} - ${Release_Version}

          üì¶ **Build Version**: ${build_version}

          ---

          üóÇÔ∏è **Related JIRA Tickets**:

          ---


          ${JiraTicketDetails1}


          ---

          ‚úÖ Please review the JIRA tickets for more details in this release.

          ---

          Thank you,
          **PCP Release Bot ü§ñ**

          ---
        variableMapping:
          pythonScript.server: "${teams_channel_ref}"
      - name: GitHub Tag PR Notification
        type: msteams.Notification
        channel: "#${channel_name}"
        message: |-
          üì¢ **Pull Request Notification**

          ---

          üõ†Ô∏è **Application**: ${app_name} - ${Release_Version}
          üì¶ **Build Version**: ${build_version}

          ---

          üóÇÔ∏è **Related PR Tickets**:

          ---


          ${pullRequestUrlsOnly}


          ---

          ‚úÖ Please review the PR tickets for more details in this release.

          ---

          Thank you,
          **PCP Release Bot ü§ñ**

          ---
        variableMapping:
          pythonScript.server: "${teams_channel_ref}"
      - name: Email Notification on Tag Comapre Info (copy)
        type: xlrelease.NotificationTask
        taskFailureHandlerEnabled: true
        taskRecoverOp: SKIP_TASK
        addresses:
        - "${ReleaseStakeHolders}"
        subject: "IR - ${app_name} - ${Release_Version} - Git Tag Log Notification"
        body: |-
          ![Walt Disney World](https://www.google.com/imgres?imgurl=https%3A%2F%2Fwww.netclipart.com%2Fpp%2Fm%2F141-1411824_clipart-disney-world-walt-disney-company-logo-png.png&imgrefurl=https%3A%2F%2Fwww.netclipart.com%2Fisee%2FxThwwh_clipart-disney-world-walt-disney-company-logo-png%2F&tbnid=eoZQ4k9ko5nHmM&vet=12ahUKEwi5x8D-mr7rAhXz2nMBHZxYCp0QMygTegUIARDdAQ..i&docid=mFNs5JDfmnH_GM&w=920&h=247&q=walt%20disney%20logo&hl=en-GB&client=ubuntu&ved=2ahUKEwi5x8D-mr7rAhXz2nMBHZxYCp0QMygTegUIARDdAQ)


          ***
          ## Please find the git tag comparision of ${Release_Version}
          ***
          ## Commit Info for ${Release_Version}
          ***
          ${commitLogsFormatted}
          ***
          ## Files changed  for ${Release_Version}
          ***
          ${filesChanged}
          ***
          ## PR's Merged  for ${Release_Version}
          ***
          ${pullRequestLinksFormatted}
          ***
          ## PR URL's  for ${Release_Version}
          ***
          ${pullRequestUrlsOnly}
    - name: Pull Jira Story Info Complete
      type: delivery.MarkTrackedItems
      stage: Pull JIRA Story
      delivery: "${delivery_id}"
      pattern: Cynthia/PCP Release
      flagStatus: ATTENTION_NEEDED
      flagComment: "Task 'Pull Jira Story Info Complete' in Phase 'MY JIRA' has properties\
        \ that do not match with the known type. Following properties do not match:\
        \ [configurationUri]."
      variableMapping:
        pythonScript.trackedItems: "${application}"
    color: "#0079BC"
  - phase: CHG - QA
    tasks:
    - name: SE Task Confirmation
      type: xlrelease.UserInputTask
      description: Please enter the required information below.
      owner: admin
      precondition: "${chg_qa_nimbus}"
      variables:
      - chg_qa_nimbus
      - nimbus_info_stage
      - nimbus_info_load
    - name: Set CRQ Variables
      type: xlrelease.ScriptTask
      owner: manoj.kumar.x.bijjala.-nd@disney.com
      script: |-
        from java.time import LocalDate

        qa_start_date = LocalDate.now()
        qa_end_date = qa_start_date.plusDays(30)

        releaseVariables['qa_start_date'] = qa_start_date
        releaseVariables['qa_end_date'] = qa_end_date
    - name: Create QA Change
      type: xlrelease.SequentialGroup
      precondition: "${skip_qa}"
      tasks:
      - name: Find Stage CI SysID
        type: servicenow.FindCIByName
        servicenowServer: Disney Prod
        tableName: cmdb_ci_service_discovered
        ciName: "${app_name} - AWS Staging"
        variableMapping:
          pythonScript.sysId: "${stage_sys_id}"
      - name: Find Load SysID
        type: servicenow.FindCIByName
        servicenowServer: Disney Prod
        tableName: cmdb_ci_service_discovered
        ciName: "${app_name} - AWS Load Test"
        variableMapping:
          pythonScript.sysId: "${load_sys_id}"
      - name: Create QA CRQ
        type: servicenow.CreateChangeRequest
        servicenowServer: Disney Prod
        shortDescription: "QA - [AWS Docker Application] - For Independent Release\
          \ - ${Release_Version} for ${app_name}"
        ^description: |-
          ******************************************************************************************************************
          Application Name: ${app_name}
          BAPP ID: ${app_bappid}
          GitHub Link: https://github.disney.com/${app_gitorg}/${app_gitrepo}
          Harness Link:  ${app_harness_base_url}
          Rundeck Link: ${app_rundeck_nonprodjob}
          ******************************************************************************************************************

          1. Description of change including business driver/justification.  [Please provide detailed information to process this CR]
          Answer:
          Business Justification: ${business_justification}

          JIRA Tickets:
          ${JiraTicketDetails2}

          2. What is the business  impact/ risk to Disney if this work is not performed?
          Answer: ${business_impact}

          3. What are the user groups affected by this change? (with one of the following Guest/Cast/Both/None). (If None, please explain.)
          Answer: Guest/Cast {Both}

          4. Provide all PR details for this particular release [Release will not be considered if any of the PR is missed in the point below].
          Answer:
          ${pullRequestUrlsOnly}

          5. Was this Release tested in Latest before promoting to Stage & Load? Provide evidence.
          Answer.  ${Latest Test Results}

          6. What is the importance of this release [High/Medium/Low] ?
          Answer: Medium

          ******** CHECK THE CONFLICTS TAB TO SEE IF YOUR CHANGE HAS A CONFLICT PERTAINING TO A WDPR OPERATIONAL BLACKOUT. IF IT DOES THEN PLEASE ANSWER THE APPROPRIATE QUESTIONS BELOW IN ORDER TO RECEIVE REQUIRED APPROVALS******** (FOR PRODUCTION CHANGES ONLY)

          1. Provide Business Justification for implementing this change during the identified Blackout.
          Answer: ${blackout_scope}

          2. Provide a detailed description of any potential impact to the business if the change is not implemented during the identified Blackout.
          Answer: ${blackout_scope}

          3. Describe potential impact to any Financial Production Systems (ex: Financial Interfaces, Payment Process Systems and any impact to systems or services related to Media)
          Answer: ${blackout_scope}
        ciSysId: "${stage_sys_id}"
        assignmentGroup: "${chg_ctaskassignment_group}"
        assignedTo: Mosisin Anwar Mohammed
        state: Draft
        additionalFields:
          end_date: "${qa_end_date}"
          requested_by: "${tech_lead}"
          test_plan: "1. Latest Env Validated as expected by App Team.\n2. Once deployment\
            \ done in STAGE/LOAD, GQE in STAGE and PE in LOAD will validate.\n3. Sustainment\
            \ will monitor and analyze if any issue occurs   "
          change_plan: "${folder.qa_planning_chg}"
          category: Business Application
          u_peer_approval_group: "${chg_peerapproval_group}"
          u_subcategory: "${chg_subcategory}"
          start_date: "${qa_start_date}"
          backout_plan: "If any deployments are failed or app is not stable, will\
            \ rollback to the successful running version.  "
          u_template: "${chg_template}"
        variableMapping:
          pythonScript.data: "${qa_crq_data}"
          pythonScript.sysId: "${qa_sys_id}"
          pythonScript.Ticket: "${qa_crq_number}"
      - name: Create Nimbus / Vault Stage CTask
        type: servicenow.CreateChangeTask
        servicenowServer: Disney Prod
        shortDescription: "QA | R - ${Release_Version} | Stage NIMBUS / Vault Updates\
          \ for ${app_name}"
        ^description: |-
          Application Name: ${app_name}
          BAPP ID: ${app_bappid}

          Hello SE Team,

          Before initiating this  update, please coordinate with  Application Tech Lead : ( ${tech_lead} )
          ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
          ${nimbus_info_stage}
          ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
        ciSysId: "${stage_sys_id}"
        assignmentGroup: "${chg_ctaskassignment_group}"
        assignedTo: Mosisin Anwar Mohammed
        additionalFields:
          work_end: "${qa_end_date}"
          work_start: "${qa_start_date}"
          state: Draft
          u_type: implementation
        changeRequest: "${qa_sys_id}"
        precondition: "${chg_qa_nimbus}"
        variableMapping:
          pythonScript.sysId: "${stage_nimbus_ctask_sysid}"
          pythonScript.Ticket: "${stage_nimbus_ctask_number}"
          pythonScript.data: "${stage_nimbus_ctask_data}"
      - name: Create Nimbus / Vault Load CTask
        type: servicenow.CreateChangeTask
        servicenowServer: Disney Prod
        shortDescription: "QA | R - ${Release_Version} | Load NIMBUS / Vault Updates\
          \ for ${app_name}"
        ^description: |-
          Application Name: ${app_name}
          BAPP ID: ${app_bappid}

          Hello SE Team,

          Before initiating this  update, please coordinate with  Application Tech Lead : ( ${tech_lead} )
          ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
          ${nimbus_info_load}
          ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
        ciSysId: "${load_sys_id}"
        assignmentGroup: "${chg_ctaskassignment_group}"
        assignedTo: Mosisin Anwar Mohammed
        additionalFields:
          work_end: "${qa_end_date}"
          work_start: "${qa_start_date}"
          state: Draft
          u_type: implementation
        changeRequest: "${qa_sys_id}"
        precondition: "${chg_qa_nimbus}"
        variableMapping:
          pythonScript.Ticket: "${load_nimbus_ctask_number}"
          pythonScript.data: "${load_nimbus_ctask_data}"
          pythonScript.sysId: "${load_nimbus_ctask_sysid}"
      - name: Update QA CRQ CHG Planning
        type: servicenow.UpdateChangeRequest
        servicenowServer: Disney Prod
        ciSysId: "${stage_sys_id}"
        assignmentGroup: "${chg_ctaskassignment_group}"
        assignedTo: Mosisin Anwar Mohammed
        additionalFields:
          change_plan: "${folder.qa_se_code_planning_chg}"
        sysId: "${qa_sys_id}"
        precondition: "${chg_qa_nimbus}"
        variableMapping:
          pythonScript.data: "${qa_crq_data}"
          pythonScript.Ticket: "${qa_crq_number}"
      - name: Release Channel Nimbus Notification
        type: msteams.Notification
        channel: "#${channel_name}"
        message: |-
          üì¢ **Release QA Change SE Task Notification**


          ---

          üõ†Ô∏è **Application**: ${app_name} - ${Release_Version}
          üì¶ **Build Version**: ${build_version}
          üîÅ **Environment**: Stage  & Load

          üìù **Change Request ID**: [${qa_crq_number}](https://disney.service-now.com/change_request.do?sys_id=${qa_sys_id})
          üìÑ **Change Request URL**: https://disney.service-now.com/change_request.do?sys_id=${qa_sys_id}
          üìÑ **Stage SE Task**: ${stage_nimbus_ctask_number}
          üìÑ **Load SE Task**: ${load_nimbus_ctask_number}

          üìÖ **Scheduled Start Date**: ${qa_start_date}
          üìÖ **Scheduled End Date**: ${qa_end_date}


          ‚úÖ Please take a look at the change task information and update instructions if needed.

          ---

          Thank you,
          **PCP Release Bot ü§ñ**

          ---
        owner: admin
        precondition: "${chg_qa_nimbus}"
        variableMapping:
          pythonScript.server: "${teams_channel_ref}"
      - name: Create Stage Deployment CTask
        type: servicenow.CreateChangeTask
        servicenowServer: Disney Prod
        shortDescription: "QA - Independent Release - ${app_name} ${Release_Version}\
          \ - Stage Deployment"
        ^description: |-
          QA - Independent Release - ${app_name} ${Release_Version}-${build_version} - Stage Deployment

          Application Team: ${app_name}
          ==========================================================
          Rundeck Project:  ${app_rundeck_nonprodjob}
          Build version: ${build_version}
          Environment: Stage
          ${rundeck_deploy_lambda_options}
          ====================================================================
        ciSysId: "${stage_sys_id}"
        assignmentGroup: chc-global-chcoo
        assignedTo: _SNAPI_f-pcsxebia
        additionalFields:
          work_end: "${qa_end_date}"
          work_start: "${qa_start_date}"
          state: Draft
          u_type: implementation
        changeRequest: "${qa_sys_id}"
        variableMapping:
          pythonScript.data: "${stage_ctask_data}"
          pythonScript.sysId: "${qa_crq_impl_ctask_sysid}"
          pythonScript.Ticket: "${stage_ctask_number}"
      - name: Create Load Deployment CTask
        type: servicenow.CreateChangeTask
        servicenowServer: Disney Prod
        shortDescription: "QA - Independent Release - ${app_name} ${Release_Version}\
          \ - Load Deployment"
        ^description: |-
          QA - Independent Release - ${app_name} ${Release_Version}-${build_version} - Load Deployment
          ==========================================================
          Rundeck Project:  ${app_rundeck_nonprodjob}
          Build version: ${build_version}
          Environment: Load
          ${rundeck_deploy_lambda_options}
          ====================================================================
        ciSysId: "${load_sys_id}"
        assignmentGroup: chc-global-chcoo
        assignedTo: _SNAPI_f-pcsxebia
        additionalFields:
          work_end: "${qa_end_date}"
          work_start: "${qa_start_date}"
          state: Draft
          u_type: implementation
        changeRequest: "${qa_sys_id}"
        variableMapping:
          pythonScript.sysId: "${load_ctask_sys_id}"
          pythonScript.Ticket: "${load_ctask_number}"
          pythonScript.data: "${load_ctask_data}"
      - name: Create Sustainment Team Validation CTask
        type: servicenow.CreateChangeTask
        servicenowServer: Disney Prod
        shortDescription: "QA - Independent Release - ${app_name} ${Release_Version}\
          \ - Sustainment Team Validation"
        ^description: |-
          Sustainment Team Validation for ${app_name}-${build_version}

          -  Delivery/Sustainment team to check the status endpoints to ensure correct version deployed in load
          - Delivery/Sustainment team to check that ec2 instances have come up and stabilized running correct version
          - Delivery/Sustainment - Delivery/Sustainment to check proper version of code was deployed
          - Delivery/Sustainmnet will run standard smoke tests that we execute after deployment. The smoke tests invoke endpoints and test the systems functionality after application is deployed. Additionally our smoke tests run on a schedule. Additionally will perform necessary post deploy validation coverage which allows us to to detect any issues (ART, Error rate increase, Eventing failures) soon after each deployment
        ciSysId: "${load_sys_id}"
        assignmentGroup: "${chg_ctaskassignment_group}"
        assignedTo: "${tech_lead}"
        additionalFields:
          u_type: validation
          work_end: "${qa_end_date}"
          work_start: "${qa_start_date}"
          state: Draft
        changeRequest: "${qa_sys_id}"
        variableMapping:
          pythonScript.sysId: "${loadvalidation_ctask_sys_id}"
          pythonScript.data: "${loadvalidation_ctask_data}"
          pythonScript.Ticket: "${loadvalidation_ctask_number}"
      - name: QA CHG Notification
        type: msteams.Notification
        channel: "${channel_name}"
        message: |-
          üì¢ **Release QA Change Creation Notification**

          ---

          üõ†Ô∏è **Application**: ${app_name} - ${Release_Version}

          üì¶ **Build Version**: ${build_version}

          üîÅ **Environment**: Stage  & Load

          üìù **Change Request ID**: [${qa_crq_number}](https://disney.service-now.com/change_request.do?sys_id=${qa_sys_id})
          üìÑ **Change Request URL**: https://disney.service-now.com/change_request.do?sys_id=${qa_sys_id}
          üìÑ **Change Summary**: ${business_justification}

          üìÖ **Scheduled Start Date**: ${qa_start_date}
          üìÖ **Scheduled End Date**: ${qa_end_date}

          ‚úÖ Please validate the change and Push for Peer Approval.

          ---

          Thank you,
          **PCP  Release Bot ü§ñ**

          ---
        variableMapping:
          pythonScript.server: "${teams_channel_ref}"
      - name: QA CRQ Link to Jira Issues
        type: jira.LinkToServiceNow
        jiraServer: MyJira
        serviceNowChangeRequest: "${qa_crq_number}"
        serviceNowUrl: https://disney.service-now.com
        variableMapping:
          pythonScript.jiraIssues: "${JiraIssueIds}"
      - name: "${release.title}"
        type: xlrelease.ScriptTask
        facets:
        - type: udm.DeploymentTaskFacet
          variableMapping:
            version: "${qa_crq_number}"
          application: ChangeRequest STAGE
          environment: STAGE
        script: "globalVariables['global.STAGE_CRQ'].append(releaseVariables['qa_crq_number'])"
      - name: QA CHG Email Notification
        type: xlrelease.NotificationTask
        precondition: "False"
        addresses:
        - "${ReleaseStakeHolders}"
        subject: "XL IR - ${app_name} - ${Release_Version} - QA CRQ Notification"
        body: |-
          **IR - ${app_name} - ${Release_Version} - ${qa_crq_number} QA Change is Created.**


          **Snow Link** : https://disney.service-now.com/change_request.do?sys_id=${qa_sys_id}
    color: "#0079BC"
  - phase: Manual -QA-ChangeManagement
    tasks:
    - name: Manual QA CHG Efforts
      type: xlrelease.SequentialGroup
      precondition: "${skip_qa}"
      tasks:
      - name: "CRQ ${qa_crq_number} Pending Peer Approval ?"
        type: servicenow.PollingCheckStatus
        servicenowServer: Disney Prod
        sysId: "${qa_sys_id}"
        statusField: approval
        checkForStatus: Pending Peer Approval
      - name: "Approve  ${qa_crq_number}"
        type: msteams.Notification
        server: Peer Approval
        channel: "#DigitalPeerApproval"
        message: |-
          @${service_owner}

          üì¢ **Release QA Change Peer Approval Notification**


          ---

          üõ†Ô∏è **Application**: ${app_name} - ${Release_Version}
          üì¶ **Build Version**: ${build_version}
          üîÅ **Environment**: Stage  & Load

          üìù **Change Request ID**: [${qa_crq_number}](https://disney.service-now.com/change_request.do?sys_id=${qa_sys_id})
          üìÑ **Change Request URL**: https://disney.service-now.com/change_request.do?sys_id=${qa_sys_id}
          üìÑ **Change Summary**: ${business_justification}

          üìÖ **Scheduled Start Date**: ${qa_start_date}
          üìÖ **Scheduled End Date**: ${qa_end_date}


          ‚úÖ Please Peer Review the change and Approve.

          ---

          Thank you,
          **PCP Release Bot ü§ñ**

          ---
        owner: admin
      - name: "CRQ ${qa_crq_number} Approved ?"
        type: servicenow.PollingCheckStatus
        servicenowServer: Disney Prod
        sysId: "${qa_sys_id}"
        statusField: approval
        checkForStatus: Approved
      - name: QA CHG Notification
        type: msteams.Notification
        channel: "${channel_name}"
        message: |-
          üì¢ **Release QA Change Approval Notification**

          ---

          üõ†Ô∏è **Application**: ${app_name} - ${Release_Version}

          üì¶ **Build Version**: ${build_version}
          üîÅ **Environment**: Stage  & Load

          üìù **Change Request ID**: [${qa_crq_number}](https://disney.service-now.com/change_request.do?sys_id=${qa_sys_id})
          üìÑ **Change Summary**: ${business_justification}

          üìÖ **Scheduled Start Date**: ${qa_start_date}
          üìÖ **Scheduled End Date**: ${qa_end_date}

          ‚úÖ QA Change is Approved.

          ---

          Thank you,
          **PCP Release Bot ü§ñ**

          ---
        owner: admin
        variableMapping:
          pythonScript.server: "${teams_channel_ref}"
      - name: QA CHG Approval Complete
        type: delivery.MarkTrackedItems
        stage: QA Change
        delivery: "${delivery_id}"
        pattern: Cynthia/PCP Release
        flagStatus: ATTENTION_NEEDED
        flagComment: "Task 'QA CHG Approval Complete' in Phase 'Manual -QA-ChangeManagement'\
          \ has properties that do not match with the known type. Following properties\
          \ do not match: [configurationUri]."
        variableMapping:
          pythonScript.trackedItems: "${application}"
      - name: SmartSheet QA Change Update#
        type: xlrelease.ScriptTask
        script: |-
          from java.net import URL
          from java.io import BufferedReader, InputStreamReader, DataOutputStream
          from java.text import SimpleDateFormat, ParseException
          from java.util import Locale, TimeZone, Date
          import com.xhaus.jyson.JysonCodec as json

          # --- Configuration & Inputs
          smartsheet_token = "Bearer " + releaseVariables['smart_api_token']
          sheet_id = releaseVariables['smartsheet_sheet_id']

          month_year_col_name = "Project/Studio"
          task_desc_col_name = "Task Description"
          release_version_col_name = "Release Version Link"
          added_by_col_name = "Added By"
          date_col_name = "Date"
          completed_row_value = "COMPLETED"

          release_type_col_name = "Type of Release"
          brand_col_name = "Brand"
          brand_value = releaseVariables['select_brand']

          # --- Dynamic Update Column from releaseVariables
          update_col_name = releaseVariables.get('target_qa_column', None)
          update_value = releaseVariables.get('qa_crq_number', None)

          app_name = releaseVariables['app_name']
          build_version = releaseVariables['build_version']
          added_by = releaseVariables['bot']

          due_date_obj = release.dueDate
          if not due_date_obj:
              raise Exception("Release dueDate is not set.")

          month_year_format = SimpleDateFormat("MMMM yyyy", Locale.US)
          date_format = SimpleDateFormat("MM/dd/yy")
          iso_format = SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss'Z'")
          iso_format.setTimeZone(TimeZone.getTimeZone("UTC"))
          due_date_obj_iso = iso_format.format(due_date_obj)
          month_year_str = month_year_format.format(due_date_obj)
          due_date_str = date_format.format(due_date_obj)

          def smartsheet_api(url, method="GET", payload=None):
              try:
                  conn = URL(url).openConnection()
                  conn.setRequestMethod(method)
                  conn.setRequestProperty("Authorization", smartsheet_token)
                  conn.setRequestProperty("Content-Type", "application/json")
                  if payload is not None:
                      conn.setDoOutput(True)
                      wr = DataOutputStream(conn.getOutputStream())
                      wr.writeBytes(payload)
                      wr.flush()
                      wr.close()
                  if conn.getResponseCode() >= 400:
                      err_stream = conn.getErrorStream()
                      reader = BufferedReader(InputStreamReader(err_stream))
                      err_msg = ""
                      line = reader.readLine()
                      while line:
                          err_msg += line
                          line = reader.readLine()
                      reader.close()
                      raise Exception("HTTP Error %s: %s" % (conn.getResponseCode(), err_msg))
                  in_stream = conn.getInputStream()
                  reader = BufferedReader(InputStreamReader(in_stream))
                  result = ""
                  line = reader.readLine()
                  while line:
                      result += line
                      line = reader.readLine()
                  reader.close()
                  return result
              except Exception as e:
                  print("API call failed: %s" % e)
                  raise

          sheet_url = "https://api.smartsheet.com/2.0/sheets/%s" % sheet_id
          update_url = "https://api.smartsheet.com/2.0/sheets/%s/rows" % sheet_id

          sheet_json = json.loads(smartsheet_api(sheet_url))
          columns = sheet_json['columns']
          rows = sheet_json['rows']

          # Map column title -> id and id -> title
          col_map = {c['title']: c['id'] for c in columns}
          id_to_title = {c['id']: c['title'] for c in columns}

          for col in [month_year_col_name, task_desc_col_name, release_version_col_name,
                      added_by_col_name, date_col_name, release_type_col_name, brand_col_name]:
              if col not in col_map:
                  raise Exception("Column '%s' not found in sheet." % col)

          # --- Dynamic QA column check
          if not update_col_name or update_col_name not in col_map:
              raise Exception("Required dynamic column ('%s') not found in sheet." % update_col_name)

          month_year_col_id = col_map[month_year_col_name]
          task_desc_col_id = col_map[task_desc_col_name]
          release_version_col_id = col_map[release_version_col_name]
          added_by_col_id = col_map[added_by_col_name]
          date_col_id = col_map[date_col_name]
          release_type_col_id = col_map[release_type_col_name]
          brand_col_id = col_map[brand_col_name]
          update_col_id = col_map[update_col_name]

          # Date parsers
          iso_with_ms_z = SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss.SSS'Z'")
          iso_with_ms_z.setTimeZone(TimeZone.getTimeZone("UTC"))
          iso_with_z = SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss'Z'")
          iso_with_z.setTimeZone(TimeZone.getTimeZone("UTC"))
          iso_date_only = SimpleDateFormat("yyyy-MM-dd")
          parsers = [iso_with_ms_z, iso_with_z, iso_date_only, date_format]

          def robust_parse_date(date_val):
              if isinstance(date_val, Date):
                  return date_val
              s = str(date_val).strip()
              for parser in parsers:
                  try:
                      return parser.parse(s)
                  except:
                      pass
              return None

          # Helper to pretty-print a whole row (all columns/values)
          def print_full_row(row):
              print("  --- Full row dump (rowId=%s) ---" % row.get('id'))
              cells = row.get('cells', [])
              for cell in cells:
                  col_id = cell.get('columnId')
                  col_title = id_to_title.get(col_id, "UNKNOWN_COLUMN_%s" % col_id)
                  # Prefer displayValue when present, fall back to value
                  if 'displayValue' in cell and cell['displayValue'] is not None:
                      val = cell['displayValue']
                  else:
                      val = cell.get('value')
                  print("    %s: %s" % (col_title, val))
              print("  --- End of row dump ---")

          # Search for Month YYYY in all rows (skip COMPLETED)
          month_year_rows = []
          for row in rows:
              for cell in row.get('cells', []):
                  if cell['columnId'] == month_year_col_id:
                      val = str(cell.get('value', '')).strip()
                      if val.upper() == completed_row_value:
                          break
                      if val == month_year_str:
                          month_year_rows.append(row)
                      break

          if not month_year_rows:
              print("No matching Month YYYY rows found for '%s'." % month_year_str)

          any_match_found = False

          for parent_row in month_year_rows:
              parent_row_id = parent_row['id']
              print("\nFound Month YYYY row: ID=%s" % parent_row_id)

              # Gather children, skip COMPLETED
              child_rows = []
              for row in rows:
                  if row.get('parentId') == parent_row_id:
                      skip = False
                      for cell in row.get('cells', []):
                          if cell['columnId'] == month_year_col_id:
                              if str(cell.get('value', '')).strip().upper() == completed_row_value:
                                  skip = True
                                  break
                      if not skip:
                          child_rows.append(row)

              # Check for matching child by App/Build/Date
              matched_row = None
              for child_row in child_rows:
                  tdesc_val = None
                  rver_val = None
                  due_date_val_str = None
                  for cell in child_row.get('cells', []):
                      if cell['columnId'] == task_desc_col_id:
                          tdesc_val = cell.get('value')
                      elif cell['columnId'] == release_version_col_id:
                          rver_val = cell.get('value')
                      elif cell['columnId'] == date_col_id:
                          val = cell.get('value')
                          parsed_date = robust_parse_date(val)
                          if parsed_date:
                              due_date_val_str = date_format.format(parsed_date)
                  if tdesc_val == app_name and rver_val == build_version and due_date_val_str == due_date_str:
                      matched_row = child_row
                      break

              if matched_row:
                  any_match_found = True
                  print("  MATCH FOUND for App=%s, Build=%s, Date=%s at row ID=%s"
                        % (app_name, build_version, due_date_str, matched_row['id']))

                  # Print the entire row with columns
                  print_full_row(matched_row)

                  # Update the dynamic QA column
                  update_cells = [
                      {"columnId": update_col_id, "value": update_value}
                  ]
                  update_payload = [{
                      "id": matched_row['id'],
                      "cells": update_cells
                  }]
                  result = smartsheet_api(update_url, "PUT", json.dumps(update_payload))
                  print("  ‚úÖ Updated column '%s' for child row ID %s. API Response: %s"
                        % (update_col_name, matched_row['id'], result))
              else:
                  print("  No matching child row (App=%s, Build=%s, Date=%s) found under Month YYYY row ID=%s."
                        % (app_name, build_version, due_date_str, parent_row_id))

          # If nothing matched anywhere, fail the task
          if not any_match_found:
              msg = ("No matching child row found for App=%s, Build=%s, Date=%s under any '%s' "
                     "Month YYYY row. Failing task."
                     % (app_name, build_version, due_date_str, month_year_str))
              print(msg)
              raise Exception(msg)

          print("\nScript finished successfully (at least one match found, printed, and updated).")
    - name: QA CHG Skipped
      type: delivery.MarkTrackedItems
      stage: QA Change
      ^status: SKIPPED
      delivery: "${delivery_id}"
      pattern: Cynthia/PCP Release
      flagStatus: ATTENTION_NEEDED
      flagComment: "Task 'QA CHG Skipped' in Phase 'Manual -QA-ChangeManagement' has\
        \ properties that do not match with the known type. Following properties do\
        \ not match: [configurationUri]."
      precondition: "${skip_qa} == False"
      variableMapping:
        pythonScript.trackedItems: "${application}"
    color: "#0079BC"
  - phase: Stage/Load deployment
    tasks:
    - name: Stage And Load Deployments
      type: xlrelease.SequentialGroup
      precondition: "${skip_qa}"
      tasks:
      - name: Deploy to Stage and Load
        type: xlrelease.ParallelGroup
        tasks:
        - name: Deploy to Stage
          type: xlrelease.SequentialGroup
          tasks:
          - name: Close Nimbus CTask - Stage
            type: servicenow.PollingCheckStatus
            servicenowServer: Disney Prod
            tableName: change_task
            sysId: "${stage_nimbus_ctask_sysid}"
            checkForStatus: Closed Complete
            precondition: "${chg_nimbus}"
            variableMapping:
              pythonScript.ticket: "${stage_nimbus_ctask_number}"
          - name: Deploy
            type: xlrelease.SequentialGroup
            precondition: "${bypass_build_stage}"
            tasks:
            - name: Stage Deploy Rundeck API Call
              type: xlrelease.ScriptTask
              taskFailureHandlerEnabled: true
              taskRecoverOp: SKIP_TASK
              ignoreScriptVariableInterpolation: true
              script: |-
                from java.net import URL
                from java.io import BufferedReader, InputStreamReader, OutputStreamWriter
                import json
                import time

                # === CONFIGURATION ===
                RUNDECK_API_URL = "https://rundeck.wdprapps.disney.com/api/52"
                JOB_ID = releaseVariables['app_rundeck_uuid']
                POLL_INTERVAL = 60  # seconds between polling

                API_TOKEN = releaseVariables['rundeckApiToken']

                # === STATIC ENVIRONMENT ===
                target_env = "stage"  # Static value - change as needed ("stage", "load", "prod", etc.)

                # === DYNAMIC JOB OPTIONS FROM LIST VARIABLE ===
                app_name = releaseVariables.get('app_name', '').lower()
                lambda_apps_list = releaseVariables.get('lambdaAppsList', [])

                # Check if current app is in lambda apps list (Jython 2.7 compatible)
                is_lambda_app = False
                for lambda_app in lambda_apps_list:
                    if lambda_app.lower() in app_name:
                        is_lambda_app = True
                        break

                if is_lambda_app:
                    job_options = {
                        "environment": target_env,
                        "version": releaseVariables['build_version'],
                        "function": "all"
                    }
                    print("üêë Lambda app (%s) in %s: using Lambda-specific job options" % (app_name, target_env))
                else:
                    job_options = {
                        "environment": target_env,
                        "version": releaseVariables['build_version']
                    }
                    print("üì± Standard app (%s) in %s: using default job options" % (app_name, target_env))

                # === Helper Functions ===
                def http_post(url_str, payload, headers):
                    url = URL(url_str)
                    conn = url.openConnection()
                    conn.setDoOutput(True)
                    conn.setRequestMethod("POST")
                    for key, value in headers.items():
                        conn.setRequestProperty(key, value)

                    writer = OutputStreamWriter(conn.getOutputStream())
                    writer.write(payload)
                    writer.flush()
                    writer.close()

                    response_code = conn.getResponseCode()
                    stream = conn.getInputStream() if response_code == 200 else conn.getErrorStream()
                    reader = BufferedReader(InputStreamReader(stream))
                    response = ""
                    line = reader.readLine()
                    while line is not None:
                        response += line + "\n"
                        line = reader.readLine()
                    reader.close()

                    if response_code != 200:
                        raise Exception("HTTP {} Error: {}".format(response_code, response))
                    return json.loads(response)

                def http_get(url_str, headers):
                    url = URL(url_str)
                    conn = url.openConnection()
                    conn.setRequestMethod("GET")
                    for key, value in headers.items():
                        conn.setRequestProperty(key, value)

                    response_code = conn.getResponseCode()
                    stream = conn.getInputStream() if response_code == 200 else conn.getErrorStream()
                    reader = BufferedReader(InputStreamReader(stream))
                    response = ""
                    line = reader.readLine()
                    while line is not None:
                        response += line + "\n"
                        line = reader.readLine()
                    reader.close()

                    if response_code != 200:
                        raise Exception("HTTP {} Error: {}".format(response_code, response))
                    return json.loads(response)

                # === Trigger Rundeck Job ===
                headers = {
                    "Accept": "application/json",
                    "Content-Type": "application/json",
                    "X-Rundeck-Auth-Token": API_TOKEN
                }

                run_url = RUNDECK_API_URL + "/job/" + JOB_ID + "/run"
                payload = json.dumps({"options": job_options})
                response = http_post(run_url, payload, headers)

                execution_id = response.get("id")
                execution_url = RUNDECK_API_URL.replace("/api/52", "") + "/execution/show/" + str(execution_id)

                print "‚úÖ Rundeck job triggered successfully in %s" % target_env
                print "Execution ID: {}".format(execution_id)
                print "Execution URL: {}".format(execution_url)
                print "Job options: {}".format(json.dumps(job_options))

                # === Poll for Job Status ===
                status = "running"
                status_url = RUNDECK_API_URL + "/execution/" + str(execution_id)

                while status == "running":
                    print "Polling Rundeck execution status in %s..." % target_env
                    time.sleep(POLL_INTERVAL)
                    status_response = http_get(status_url, headers)
                    status = status_response.get("status")
                    print "Current Rundeck job status: {}".format(status)

                # === Set Release Variables (Environment-specific) ===
                env_prefix = "rundeck%s" % target_env.title()
                releaseVariables["%sExecutionStatus" % env_prefix] = status
                releaseVariables["%sExecutionUrl" % env_prefix] = execution_url
                releaseVariables["%sJobSucceeded" % env_prefix] = (status == "succeeded")
                releaseVariables["%sJobFailed" % env_prefix] = (status != "succeeded")

                print "Set %sJobSucceeded = {}".format(env_prefix, status == "succeeded")
                print "Set %sJobFailed = {}".format(env_prefix, status != "succeeded")

                # === Result Handling ===
                if status == "succeeded":
                    print "üéâ Rundeck job completed successfully in %s." % target_env
                else:
                    print "‚ùå Rundeck job failed with status: {} in %s".format(status, target_env)
                    raise Exception("Rundeck job failed in %s: {}".format(target_env, status))
            - name: INC Effort & Notification
              type: xlrelease.SequentialGroup
              precondition: "${rundeckStageJobFailed}"
              tasks:
              - name: If Deploy Failure - INC
                type: servicenow.CreateIncident
                servicenowServer: Disney Prod
                shortDescription: "IR- QA - ${app_name}-${Release_Version} - Stage\
                  \ Deploy Failed"
                ^description: |-
                  Please take a look at deploy failure

                  Rundeck URL: ${rundeckStageExecutionUrl}
                ciSysId: "${app_name} - AWS Staging"
                assignmentGroup: "${chg_ctaskassignment_group}"
                additionalFields:
                  urgency: "4"
                  caller_id: _SNAPI_f-pcsxebia
                  impact: "4"
                  subcategory: application
                  category: repair
                variableMapping:
                  pythonScript.Ticket: "${stage_inc_deploy_failure}"
              - name: "Deploy Failure INC - ${stage_inc_deploy_failure} Notification"
                type: msteams.Notification
                channel: "#${channel_name}"
                message: |-
                  *QA - Stage - ${app_name} - ${Release_Version}:
                  Stage Deploy Failed and ${stage_inc_deploy_failure} is opened. Please Follow Up.
                  Rundeck Execution URL : ${rundeckStageExecutionUrl}
                watchers:
                - ""
                variableMapping:
                  pythonScript.server: "${teams_channel_ref}"
              - name: Is Stage Deploy Issue Fixed?
                type: xlrelease.UserInputTask
                description: If the deploy issue is fixed please check box and proceed
                  further
                variables:
                - deploy_fixed
          - name: "Validate ${Release_Version}-${build_version}"
            type: xlrelease.ScriptTask
            owner: admin
            precondition: "False"
            taskFailureHandlerEnabled: true
            taskRecoverOp: SKIP_TASK
            script: |-
              import json
              from urlparse import urlparse
              endpoint = releaseVariables['app_stagevalidateendpoint']
              domain = urlparse(endpoint).scheme + "://" + urlparse(endpoint).netloc
              request = HttpRequest({'url': domain})
              headers = {'Accept': '*'}
              response = request.get(urlparse(endpoint).path,headers=headers)
              content = response.getResponse()
              mydict = json.loads(content)
              if '${Release_Version}-${build_version}' not in str(mydict):
                  print( "BuildVersion: " + '${Release_Version}-${build_version}' + "doesn't exist in URL response : " + str(mydict))
                  sys.exit(1)
              releaseVariables['app_stageOutput'] = str(mydict)
              print("Response recieved from server is :"+ str(mydict))
          - name: Close Deployment CTask
            type: servicenow.UpdateChangeTask
            servicenowServer: Disney Prod
            state: Closed Complete
            additionalFields:
              u_close_code: successful
            shortDescription: ""
            sysId: "${qa_crq_impl_ctask_sysid}"
            changeRequest: "${qa_sys_id}"
            closeNotes: "Successfully Deployed - ${rundeckStageExecutionUrl}"
          - name: Stage Deploy Notify
            type: msteams.Notification
            channel: "#${channel_name}"
            message: |-
              üì¢ **Stage Deployment Notification**

              Stage deployment has been triggered and completed.

              ---

              üõ†Ô∏è **Application**: ${app_name} - ${Release_Version}
              üì¶ **Build Version**: ${build_version}
              üîÅ **Environment**: Stage

              üìù **Change Request ID**: [${qa_crq_number}](https://disney.service-now.com/change_request.do?sys_id=${qa_sys_id})
              üìÑ **Change Summary**: ${business_justification}

              üìÑ **Stage Change Task**: ${stage_ctask_number}
              üìÖ **Scheduled Date**: ${qa_start_date} - ${qa_end_date}

              ‚úÖ Please validate the deployment.

              ---

              Thank you,
              **PCP Release Bot ü§ñ**

              ---
            owner: admin
            precondition: "${bypass_build_stage}"
            variableMapping:
              pythonScript.server: "${teams_channel_ref}"
        - name: Deploy to Load
          type: xlrelease.SequentialGroup
          tasks:
          - name: Close Nimbus CTask - Load
            type: servicenow.PollingCheckStatus
            servicenowServer: Disney Prod
            tableName: change_task
            sysId: "${load_nimbus_ctask_sysid}"
            checkForStatus: Closed Complete
            precondition: "${chg_nimbus}"
            variableMapping:
              pythonScript.ticket: "${load_nimbus_ctask_number}"
          - name: Deploy
            type: xlrelease.SequentialGroup
            precondition: "${bypass_build_load}"
            tasks:
            - name: Load Deploy Rundeck POST API Call
              type: xlrelease.ScriptTask
              taskFailureHandlerEnabled: true
              taskRecoverOp: SKIP_TASK
              ignoreScriptVariableInterpolation: true
              script: |-
                from java.net import URL
                from java.io import BufferedReader, InputStreamReader, OutputStreamWriter
                import json
                import time

                # === CONFIGURATION ===
                RUNDECK_API_URL = "https://rundeck.wdprapps.disney.com/api/52"
                JOB_ID = releaseVariables['app_rundeck_uuid']
                POLL_INTERVAL = 60  # seconds between polling

                API_TOKEN = releaseVariables['rundeckApiToken']

                # === STATIC ENVIRONMENT ===
                target_env = "load"  # Static value - change as needed ("stage", "load", "prod", etc.)

                # === DYNAMIC JOB OPTIONS FROM LIST VARIABLE ===
                app_name = releaseVariables.get('app_name', '').lower()
                lambda_apps_list = releaseVariables.get('lambdaAppsList', [])

                # Check if current app is in lambda apps list (Jython 2.7 compatible)
                is_lambda_app = False
                for lambda_app in lambda_apps_list:
                    if lambda_app.lower() in app_name:
                        is_lambda_app = True
                        break

                if is_lambda_app:
                    job_options = {
                        "environment": target_env,
                        "version": releaseVariables['build_version'],
                        "function": "all"
                    }
                    print("üêë Lambda app (%s) in %s: using Lambda-specific job options" % (app_name, target_env))
                else:
                    job_options = {
                        "environment": target_env,
                        "version": releaseVariables['build_version']
                    }
                    print("üì± Standard app (%s) in %s: using default job options" % (app_name, target_env))

                # === Helper Functions ===
                def http_post(url_str, payload, headers):
                    url = URL(url_str)
                    conn = url.openConnection()
                    conn.setDoOutput(True)
                    conn.setRequestMethod("POST")
                    for key, value in headers.items():
                        conn.setRequestProperty(key, value)

                    writer = OutputStreamWriter(conn.getOutputStream())
                    writer.write(payload)
                    writer.flush()
                    writer.close()

                    response_code = conn.getResponseCode()
                    stream = conn.getInputStream() if response_code == 200 else conn.getErrorStream()
                    reader = BufferedReader(InputStreamReader(stream))
                    response = ""
                    line = reader.readLine()
                    while line is not None:
                        response += line + "\n"
                        line = reader.readLine()
                    reader.close()

                    if response_code != 200:
                        raise Exception("HTTP {} Error: {}".format(response_code, response))
                    return json.loads(response)

                def http_get(url_str, headers):
                    url = URL(url_str)
                    conn = url.openConnection()
                    conn.setRequestMethod("GET")
                    for key, value in headers.items():
                        conn.setRequestProperty(key, value)

                    response_code = conn.getResponseCode()
                    stream = conn.getInputStream() if response_code == 200 else conn.getErrorStream()
                    reader = BufferedReader(InputStreamReader(stream))
                    response = ""
                    line = reader.readLine()
                    while line is not None:
                        response += line + "\n"
                        line = reader.readLine()
                    reader.close()

                    if response_code != 200:
                        raise Exception("HTTP {} Error: {}".format(response_code, response))
                    return json.loads(response)

                # === Trigger Rundeck Job ===
                headers = {
                    "Accept": "application/json",
                    "Content-Type": "application/json",
                    "X-Rundeck-Auth-Token": API_TOKEN
                }

                run_url = RUNDECK_API_URL + "/job/" + JOB_ID + "/run"
                payload = json.dumps({"options": job_options})
                response = http_post(run_url, payload, headers)

                execution_id = response.get("id")
                execution_url = RUNDECK_API_URL.replace("/api/52", "") + "/execution/show/" + str(execution_id)

                print "‚úÖ Rundeck job triggered successfully in %s" % target_env
                print "Execution ID: {}".format(execution_id)
                print "Execution URL: {}".format(execution_url)
                print "Job options: {}".format(json.dumps(job_options))

                # === Poll for Job Status ===
                status = "running"
                status_url = RUNDECK_API_URL + "/execution/" + str(execution_id)

                while status == "running":
                    print "Polling Rundeck execution status in %s..." % target_env
                    time.sleep(POLL_INTERVAL)
                    status_response = http_get(status_url, headers)
                    status = status_response.get("status")
                    print "Current Rundeck job status: {}".format(status)

                # === Set Release Variables (Environment-specific) ===
                env_prefix = "rundeck%s" % target_env.title()
                releaseVariables["%sExecutionStatus" % env_prefix] = status
                releaseVariables["%sExecutionUrl" % env_prefix] = execution_url
                releaseVariables["%sJobSucceeded" % env_prefix] = (status == "succeeded")
                releaseVariables["%sJobFailed" % env_prefix] = (status != "succeeded")

                print "Set %sJobSucceeded = {}".format(env_prefix, status == "succeeded")
                print "Set %sJobFailed = {}".format(env_prefix, status != "succeeded")

                # === Result Handling ===
                if status == "succeeded":
                    print "üéâ Rundeck job completed successfully in %s." % target_env
                else:
                    print "‚ùå Rundeck job failed with status: {} in %s".format(status, target_env)
                    raise Exception("Rundeck job failed in %s: {}".format(target_env, status))
            - name: INC Effort & Notification
              type: xlrelease.SequentialGroup
              precondition: "${rundeckLoadJobFailed}"
              tasks:
              - name: If Deploy Failure - INC
                type: servicenow.CreateIncident
                servicenowServer: Disney Prod
                shortDescription: "IR- QA - ${app_name}-${Release_Version} - Load\
                  \ Deploy Failed"
                ^description: |-
                  Please take a look at deploy failure

                  Rundeck URL: ${rundeckLoadExecutionUrl}
                ciSysId: "${app_name} - AWS Load Test"
                assignmentGroup: "${chg_ctaskassignment_group}"
                additionalFields:
                  urgency: "4"
                  caller_id: _SNAPI_f-pcsxebia
                  impact: "4"
                  subcategory: application
                  category: repair
                dueDate: 2020-06-29T08:49:00Z
                variableMapping:
                  pythonScript.Ticket: "${load_inc_deploy_failure}"
              - name: "Deploy Failure INC - ${load_inc_deploy_failure} Notification"
                type: msteams.Notification
                channel: "#${channel_name}"
                message: |-
                  *QA - Load - ${app_name} - ${Release_Version}:
                  Load Deploy Failed and ${load_inc_deploy_failure} is opened. Please Follow Up.
                  Rundeck Execution URL: ${rundeckLoadExecutionUrl}
                variableMapping:
                  pythonScript.server: "${teams_channel_ref}"
              - name: Is Load Deploy Issue Fixed?
                type: xlrelease.UserInputTask
                description: If the deploy issue is fixed please check box and proceed
                  further
                variables:
                - deploy_fixed
          - name: "Validate ${Release_Version}-${build_version}"
            type: xlrelease.ScriptTask
            owner: admin
            precondition: "False"
            taskFailureHandlerEnabled: true
            taskRecoverOp: SKIP_TASK
            script: |-
              import json
              from urlparse import urlparse
              endpoint = releaseVariables['app_loadvalidateendpoint']
              domain = urlparse(endpoint).scheme + "://" + urlparse(endpoint).netloc
              request = HttpRequest({'url': domain})
              headers = {'Accept': '*'}
              response = request.get(urlparse(endpoint).path,headers=headers)
              content = response.getResponse()
              mydict = json.loads(content)
              if '${Release_Version}-${build_version}' not in str(mydict):
                  print( "BuildVersion: " + '${Release_Version}-${build_version}' + "doesn't exist in URL response : " + str(mydict))
                  sys.exit(1)
              releaseVariables['app_loadOutput'] = str(mydict)
              print("Response recieved from server is :"+ str(mydict))
          - name: Close Deployment CTask
            type: servicenow.UpdateChangeTask
            servicenowServer: Disney Prod
            state: Closed Complete
            additionalFields:
              u_close_code: successful
            shortDescription: "QA - Independent Release - ${app_name} ${Release_Version}\
              \ - Load Deployment"
            sysId: "${load_ctask_sys_id}"
            changeRequest: "${qa_sys_id}"
            closeNotes: "Successfully Deployed - ${rundeckLoadExecutionUrl}"
          - name: "Notify ${Release_Version}-${build_version} (copy)"
            type: msteams.Notification
            channel: "#${channel_name}"
            message: |-
              üì¢ **Load Deployment Notification**

              Load deployment has been triggered and completed.

              ---

              üõ†Ô∏è **Application**: ${app_name} - ${Release_Version}
              üì¶ **Build Version**: ${build_version}
              üîÅ **Environment**: Load

              üìù **Change Request ID**: [${qa_crq_number}](https://disney.service-now.com/change_request.do?sys_id=${qa_sys_id})
              üìÑ **Change Summary**: ${business_justification}

              üìÑ **Load Change Task**: ${load_ctask_number}
              üìÖ **Scheduled Date**: ${qa_start_date} - ${qa_end_date}


              ---

              ‚úÖ Please validate the deployment.

              ---

              Thank you,
              **PCP Release Bot ü§ñ**

              ---
            precondition: "${bypass_build_load}"
            variableMapping:
              pythonScript.server: "${teams_channel_ref}"
        - name: SonarQube Metrics
          type: xlrelease.SequentialGroup
          tasks:
          - name: Metrics
            type: sonarqube.GetMetrics
            sonarServer: SonarQube
            resource: "${project_key}"
            metricsKeys: "code_smells,bugs,coverage,vulnerabilities,software_quality_blocker_issues,software_quality_high_issues,software_quality_medium_issues"
            variableMapping:
              pythonScript.coverage: "${overall_coverage}"
              pythonScript.vulnerabilities: "${vuln}"
              pythonScript.code_smells: "${code_smell}"
              pythonScript.metricsData: "${metrics_data}"
              pythonScript.security_hotspots: "${sec_hotspot}"
          - name: Sonar Data Format
            type: xlrelease.ScriptTask
            script: |-
              # Sample input (replace this line with releaseVariables.get(...) in actual usage)
              metrics = releaseVariables['metrics_data']

              # Safety check
              if not metrics:
                  raise Exception("SonarQubeMetrics variable is missing or empty.")

              # If the value is a JSON string, parse it
              if isinstance(metrics, basestring):
                  import json
                  metrics = json.loads(metrics)

              # Prepare formatted lines
              formatted_lines = []
              for key, value in metrics.items():
                  line = "<b>{}</b>: {}".format(key, value)
                  formatted_lines.append(line)

              # Join with <br/> and store back in release variable
              releaseVariables['FormattedSonarQubeMetrics'] = ''.join(formatted_lines)

              # Debug print
              print(releaseVariables['FormattedSonarQubeMetrics'])
          - name: Sonar Project Analysis
            type: sonar.getProjectAnalyses
            sonarServer: SonarQube
            resource: "${project_key}"
            precondition: "False"
            variableMapping:
              pythonScript.data: "${FormattedSonarQubeMetrics}"
          - name: Sonar Metric Info Notification
            type: msteams.Notification
            channel: "#${channel_name}"
            message: |-
              üì¢ **Sonar Notification**

              Please find the Sonar Code Quality Metrics:

              ---

              üõ†Ô∏è **Application**: ${app_name} - ${Release_Version}
              üì¶ **Build Version**: ${build_version}

              ---

              üóÇÔ∏è **SONAR CodeQuality Info**:

              ---

              **Code Smells**: ${code_smell}
              **Coverage**: ${overall_coverage}
              **Metrics data**:
              ${FormattedSonarQubeMetrics}

              ---

              Thank you,
              **PCP Release Bot ü§ñ**

              ---
            owner: admin
            variableMapping:
              pythonScript.server: "${teams_channel_ref}"
      - name: SmartSheet Merged Stage/Load Update#
        type: xlrelease.ScriptTask
        script: |-
          from java.net import URL
          from java.io import BufferedReader, InputStreamReader, DataOutputStream
          from java.text import SimpleDateFormat, ParseException
          from java.util import Locale, TimeZone, Date
          import com.xhaus.jyson.JysonCodec as json

          # --- Configuration & Inputs ---
          smartsheet_token = "Bearer " + releaseVariables['smart_api_token']
          sheet_id = releaseVariables['smartsheet_sheet_id']

          month_year_col_name = "Project/Studio"
          task_desc_col_name = "Task Description"
          release_version_col_name = "Release Version Link"
          added_by_col_name = "Added By"
          date_col_name = "Date"
          completed_row_value = "COMPLETED"

          release_type_col_name = "Type of Release"
          brand_col_name = "Brand"
          brand_value = releaseVariables['select_brand']

          # Dynamic update column (checkbox or other)
          update_col_name = releaseVariables.get('target_deploy_column', None)
          raw_update_value = releaseVariables.get('target_deploy_value', None)

          app_name = releaseVariables['app_name']
          build_version = releaseVariables['build_version']
          added_by = releaseVariables['bot']

          due_date_obj = release.dueDate
          if not due_date_obj:
              raise Exception("Release dueDate is not set.")

          month_year_format = SimpleDateFormat("MMMM yyyy", Locale.US)
          date_format = SimpleDateFormat("MM/dd/yy")
          iso_format = SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss'Z'")
          iso_format.setTimeZone(TimeZone.getTimeZone("UTC"))

          due_date_obj_iso = iso_format.format(due_date_obj)
          month_year_str = month_year_format.format(due_date_obj)
          due_date_str = date_format.format(due_date_obj)

          print("Searching Month YYYY='%s', App='%s', Build='%s', Date='%s' (skipping COMPLETED rows)..." %
                (month_year_str, app_name, build_version, due_date_str))

          def smartsheet_api(url, method="GET", payload=None):
              try:
                  conn = URL(url).openConnection()
                  conn.setRequestMethod(method)
                  conn.setRequestProperty("Authorization", smartsheet_token)
                  conn.setRequestProperty("Content-Type", "application/json")
                  if payload is not None:
                      conn.setDoOutput(True)
                      wr = DataOutputStream(conn.getOutputStream())
                      wr.writeBytes(payload)
                      wr.flush()
                      wr.close()
                  if conn.getResponseCode() >= 400:
                      err_stream = conn.getErrorStream()
                      reader = BufferedReader(InputStreamReader(err_stream))
                      err_msg = ""
                      line = reader.readLine()
                      while line:
                          err_msg += line
                          line = reader.readLine()
                      reader.close()
                      raise Exception("HTTP Error %s: %s" % (conn.getResponseCode(), err_msg))
                  in_stream = conn.getInputStream()
                  reader = BufferedReader(InputStreamReader(in_stream))
                  result = ""
                  line = reader.readLine()
                  while line:
                      result += line
                      line = reader.readLine()
                  reader.close()
                  return result
              except Exception as e:
                  print("API call failed: %s" % e)
                  raise

          sheet_url = "https://api.smartsheet.com/2.0/sheets/%s" % sheet_id
          update_url = "https://api.smartsheet.com/2.0/sheets/%s/rows" % sheet_id

          sheet_json = json.loads(smartsheet_api(sheet_url))
          columns = sheet_json['columns']
          rows = sheet_json['rows']

          # Build column maps
          col_map = {}
          id_to_title = {}
          for c in columns:
              col_map[c['title']] = c['id']
              id_to_title[c['id']] = c['title']

          required_cols = [month_year_col_name, task_desc_col_name, release_version_col_name,
                           added_by_col_name, date_col_name, release_type_col_name, brand_col_name]
          for col in required_cols:
              if col not in col_map:
                  raise Exception("Column '%s' not found in sheet." % col)

          if not update_col_name or update_col_name not in col_map:
              raise Exception("Required dynamic column '%s' not found in sheet." % update_col_name)

          month_year_col_id = col_map[month_year_col_name]
          task_desc_col_id = col_map[task_desc_col_name]
          release_version_col_id = col_map[release_version_col_name]
          added_by_col_id = col_map[added_by_col_name]
          date_col_id = col_map[date_col_name]
          release_type_col_id = col_map[release_type_col_name]
          brand_col_id = col_map[brand_col_name]
          update_col_id = col_map[update_col_name]

          # Normalize the checkbox (or flag) value for Smartsheet
          def normalize_checkbox_value(val):
              if val is None:
                  return False
              if isinstance(val, bool):
                  return val
              s = str(val).strip().lower()
              if s in ["true", "1", "yes", "y"]:
                  return True
              if s in ["false", "0", "no", "n", ""]:
                  return False
              return False

          update_value = normalize_checkbox_value(raw_update_value)

          # Date parsers for robust handling of Smartsheet date formats
          iso_with_ms_z = SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss.SSS'Z'")
          iso_with_ms_z.setTimeZone(TimeZone.getTimeZone("UTC"))
          iso_with_z = SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss'Z'")
          iso_with_z.setTimeZone(TimeZone.getTimeZone("UTC"))
          iso_date_only = SimpleDateFormat("yyyy-MM-dd")
          parsers = [iso_with_ms_z, iso_with_z, iso_date_only, date_format]

          def robust_parse_date(date_val):
              if isinstance(date_val, Date):
                  return date_val
              if date_val is None:
                  return None
              s = str(date_val).strip()
              if s == "":
                  return None
              for parser in parsers:
                  try:
                      return parser.parse(s)
                  except:
                      pass
              return None

          # Find all Month YYYY rows, skipping COMPLETED
          month_year_rows = []
          for row in rows:
              for cell in row.get('cells', []):
                  if cell.get('columnId') == month_year_col_id:
                      val = str(cell.get('value', '')).strip()
                      if val.upper() == completed_row_value:
                          break
                      if val == month_year_str:
                          month_year_rows.append(row)
                      break

          if not month_year_rows:
              msg = "No matching Month YYYY rows found for '%s'." % month_year_str
              print(msg)
              raise Exception(msg)

          any_match_found = False

          for parent_row in month_year_rows:
              parent_row_id = parent_row['id']
              print("\nFound Month YYYY row: ID=%s" % parent_row_id)

              # Collect immediate children, skipping COMPLETED children
              child_rows = []
              for r in rows:
                  if r.get('parentId') == parent_row_id:
                      skip_child = False
                      for c in r.get('cells', []):
                          if c.get('columnId') == month_year_col_id:
                              v = c.get('value')
                              if v and str(v).strip().upper() == completed_row_value:
                                  skip_child = True
                                  break
                      if not skip_child:
                          child_rows.append(r)

              # Search for matching child: App, Build, Date
              matched_row = None
              for child_row in child_rows:
                  tdesc_val = None
                  rver_val = None
                  due_date_val_str = None
                  for c in child_row.get('cells', []):
                      col_id = c.get('columnId')
                      if col_id == task_desc_col_id:
                          tdesc_val = c.get('value')
                      elif col_id == release_version_col_id:
                          rver_val = c.get('value')
                      elif col_id == date_col_id:
                          val = c.get('value')
                          parsed = robust_parse_date(val)
                          if parsed:
                              due_date_val_str = date_format.format(parsed)
                  if tdesc_val == app_name and rver_val == build_version and due_date_val_str == due_date_str:
                      matched_row = child_row
                      break

              if matched_row:
                  any_match_found = True
                  print("  MATCH FOUND for App=%s, Build=%s, Date=%s at row ID=%s" %
                        (app_name, build_version, due_date_str, matched_row['id']))

                  # Print full row: each column title and value
                  print("  Full row values:")
                  for c in matched_row.get('cells', []):
                      col_id = c.get('columnId')
                      col_title = id_to_title.get(col_id, "Unknown")
                      val = c.get('displayValue')
                      if val is None:
                          val = c.get('value')
                      if val is None:
                          val = ""
                      print("    %s: %s" % (col_title, val))

                  # Update the dynamic checkbox (or other) column
                  update_cells = [
                      {"columnId": update_col_id, "value": update_value}
                  ]
                  update_payload = [{
                      "id": matched_row['id'],
                      "cells": update_cells
                  }]
                  result = smartsheet_api(update_url, "PUT", json.dumps(update_payload))
                  print("  Updated column '%s' for child row ID %s. API Response: %s" %
                        (update_col_name, matched_row['id'], result))
              else:
                  print("  No matching child row (App=%s, Build=%s, Date=%s) found under Month YYYY row ID=%s." %
                        (app_name, build_version, due_date_str, parent_row_id))

          if not any_match_found:
              msg = ("No matching child row found for App=%s, Build=%s, Date=%s under any "
                     "'%s' Month YYYY row. Failing task." % (app_name, build_version, due_date_str, month_year_str))
              print(msg)
              raise Exception(msg)

          print("\nScript finished successfully (at least one match found, printed, and updated).")
      - name: Stage and Load Deployment Completion
        type: delivery.MarkTrackedItems
        stage: STAGE & LOAD Deployment
        delivery: "${delivery_id}"
        pattern: Cynthia/PCP Release
        flagStatus: ATTENTION_NEEDED
        flagComment: "Task 'Stage and Load Deployment Completion' in Phase 'Stage/Load\
          \ deployment' has properties that do not match with the known type. Following\
          \ properties do not match: [configurationUri]."
        variableMapping:
          pythonScript.trackedItems: "${application}"
    - name: Stage and Load Deploy Skipped
      type: delivery.MarkTrackedItems
      stage: STAGE & LOAD Deployment
      ^status: SKIPPED
      delivery: "${delivery_id}"
      pattern: Cynthia/PCP Release
      flagStatus: ATTENTION_NEEDED
      flagComment: "Task 'Stage and Load Deploy Skipped' in Phase 'Stage/Load deployment'\
        \ has properties that do not match with the known type. Following properties\
        \ do not match: [configurationUri]."
      precondition: "${skip_qa} == False"
      variableMapping:
        pythonScript.trackedItems: "${application}"
    color: "#0079BC"
  - phase: GQE & PE & PROD CRQ
    tasks:
    - name: SIGN OFF & PROD CRQ CREATION
      type: xlrelease.ParallelGroup
      tasks:
      - name: PROD CRQ Creation
        type: xlrelease.SequentialGroup
        precondition: "${skip_prod}"
        tasks:
        - name: Find Parent CI SysID
          type: servicenow.FindCIByName
          servicenowServer: Disney Prod
          tableName: cmdb_ci_business_app
          ciName: "${app_name}"
          variableMapping:
            pythonScript.sysId: "${app_sys_id}"
        - name: Find Child CI SysID
          type: servicenow.FindCIByName
          servicenowServer: Disney Prod
          tableName: cmdb_ci_service_discovered
          ciName: "${app_name} - AWS Production"
          variableMapping:
            pythonScript.sysId: "${prod_child_ci_sys_id}"
        - name: "PROD ${prod_crq_number} Creation"
          type: xlrelease.SequentialGroup
          tasks:
          - name: Create Production CRQ
            type: servicenow.CreateChangeRequest
            servicenowServer: Disney Prod
            shortDescription: "PR -  {AWS Docker Application Deployment}  For Independent\
              \ Release - ${Release_Version} -  for ${app_name}"
            ^description: "${folder.changedesc}"
            ciSysId: "${app_sys_id}"
            assignmentGroup: "${chg_ctaskassignment_group}"
            assignedTo: Mosisin Anwar Mohammed
            state: Draft
            additionalFields:
              test_plan: "${folder.planning_test}"
              requested_by: "${tech_lead}"
              category: Business Application
              u_peer_approval_group: "${chg_peerapproval_group}"
              backout_plan: "${folder.planning_backout}"
              u_subcategory: "${chg_subcategory}"
              end_date: "${end_date} ${end}"
              change_plan: "${folder.code_planning_chg}"
              u_template: "${chg_template}"
              start_date: "${start_date} ${start}"
            variableMapping:
              pythonScript.data: "${prod_crq_data}"
              pythonScript.sysId: "${prod_crq_sys_id}"
              pythonScript.Ticket: "${prod_crq_number}"
          - name: Create Nimbus / Vault CTask
            type: servicenow.CreateChangeTask
            servicenowServer: Disney Prod
            shortDescription: "Step 1.1: PR - NIMBUS / Vault  Updates"
            ^description: |-
              Application Name: ${app_name}
              BAPP ID: ${app_bappid}

              Hello SE Team,

              Before initiating this  update, please coordinate with  Application Tech Lead ${tech_lead}
              ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
              ${nimbus_info}
              ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
            ciSysId: "${prod_child_ci_sys_id}"
            assignmentGroup: "${folder.se_chg_ctaskassignment_group}"
            additionalFields:
              u_task_backout_plan: "${rollback_info}"
              work_start: "${start_date} ${start}"
              work_end: "${end_date} ${end}"
              state: Draft
              u_type: implementation
            changeRequest: "${prod_crq_sys_id}"
            dueDate: 2020-06-29T08:56:00Z
            precondition: "${chg_nimbus}"
            variableMapping:
              pythonScript.Ticket: "${prod_nimbus_ctask_number}"
              pythonScript.data: "${prod_nimbus_ctask_data}"
              pythonScript.sysId: "${prod_nimbus_ctask_sysid}"
          - name: Update CHange Plan- Production CRQ
            type: servicenow.UpdateChangeRequest
            servicenowServer: Disney Prod
            additionalFields:
              change_plan: "${folder.code_se_planning_chg}"
            sysId: "${prod_crq_sys_id}"
            precondition: "${chg_nimbus}"
          - name: EE SE Channel Nimbus Notification
            type: msteams.Notification
            server: Core-SE
            channel: "#${se_channel_name}"
            message: |-
              @core-se

              üì¢ **Release PROD Change SE Task Assignee Notification**

              IR - ${app_name} - ${Release_Version} - ${prod_crq_number} PROD - Change task needs to be assigned.

              ---

              üõ†Ô∏è **Application**: ${app_name} - ${Release_Version}
              üì¶ **Build Version**: ${build_version}
              üîÅ **Environment**: Production

              üìù **Change Request ID**: [${prod_crq_number}](https://disney.service-now.com/change_request.do?sys_id=${prod_crq_sys_id})
              üìÑ **Service Now URL**: https://disney.service-now.com/change_request.do?sys_id=${prod_crq_sys_id}

              üìÑ **SE Team Task**: ${prod_nimbus_ctask_number}

              ---

              üìÖ **Scheduled Date**: ${start_date} ${start} - ${end_date} ${end}

              ‚úÖ Please assign a resource for above change task.

              ---

              Thank you,
              **PCP Release Bot ü§ñ**

              ---
            precondition: "${chg_nimbus}"
          - name: Create Prod Deploy CTask
            type: servicenow.CreateChangeTask
            servicenowServer: Disney Prod
            shortDescription: "Step 1.2:  PR - ADS Team Deployment to Prod"
            ^description: |-
              NOTE: PLEASE WAIT FOR Confirmation to deploy.

              Application Team: ${app_name}
              BAPP ID: ${app_bappid}
              Harness Link:  ${app_harness_base_url}
              Rundeck Link: ${app_rundeck_nonprodjob}
              ==========================================================
              Application Team: ${app_name}
              ==========================================================
              Rundeck Project: ${app_rundeck_nonprodjob}
              Build version: ${build_version}
              Environment: prod
              ${rundeck_deploy_lambda_options}
              ====================================================================
            ciSysId: "${prod_child_ci_sys_id}"
            assignmentGroup: ops-global-ApplicationDeploymentServices
            assignedTo: Ashok Sonawane
            additionalFields:
              work_start: "${start_date} ${start}"
              u_type: Implementation
              work_end: "${end_date} ${end}"
              state: Draft
              u_task_backout_plan: "${code_planning_chg_deploy_backout_info}"
            changeRequest: "${prod_crq_sys_id}"
            variableMapping:
              pythonScript.data: "${prod_build_deploy_ctask_data}"
              pythonScript.Ticket: "${prod_build_deploy_ctask_number}"
              pythonScript.sysId: "${prod_build_deploy_ctask_sys_id}"
          - name: ADS Channel Deploy Assignee Notification
            type: msteams.Notification
            message: |-
              @ADS-Team

              üì¢ **Release PROD Change ADS Task Assignee Notification**

              IR - ${app_name} - ${Release_Version} - ${prod_crq_number} PROD - Change task needs to be assigned.

              ---

              üõ†Ô∏è **Application**: ${app_name} - ${Release_Version}
              üì¶ **Build Version**: ${build_version}
              üîÅ **Environment**: Production

              üìù **Change Request ID**: [${prod_crq_number}](https://disney.service-now.com/change_request.do?sys_id=${prod_crq_sys_id})
              üìÑ **Service Now URL**: https://disney.service-now.com/change_request.do?sys_id=${prod_crq_sys_id}

              üìÑ **ADS Team Deploy**: ${prod_build_deploy_ctask_number}

              ---

              üìÖ **Scheduled Date**: ${start_date} ${start} - ${end_date} ${end}

              ‚úÖ Please assign a resource for above change task.

              ---

              Thank you,
              **PCP Release Bot ü§ñ**

              ---
            waitForScheduledStartDate: false
            precondition: "False"
          - name: Create Prod GQE Validation CTask
            type: servicenow.CreateChangeTask
            servicenowServer: Disney Prod
            shortDescription: "Step 2:  PR - GQE validation"
            ^description: |-
              *****************************************************************************************
              Change Coordination Team is requesting to attach all validation evidences to this CTASK for audit purposes ; escalation to respective managers will be imminent if evidences are not attached
              After validation is successful, please close this CTASK with closed notes.
              ******************************************************************************************
              Please validate:
              -  Delivery/Sustainment team to check the status endpoints to ensure correct version deployed in prod
              - Delivery/Sustainment team to check that ec2 instances have come up and stabilized running correct version
              - Delivery/Sustainment - Delivery/Sustainment to check proper version of code was deployed
              - Delivery/Sustainmnet will run standard smoke tests that we execute after deployment. The smoke tests invoke endpoints and test the systems functionality after application is deployed. Additionally our smoke tests run on a schedule. Additionally will perform necessary post deploy validation coverage which allows us to to detect any issues (ART, Error rate increase, Eventing failures) soon after each deployment
              -  AOE to peform appD monitoring
            ciSysId: "${prod_child_ci_sys_id}"
            assignmentGroup: "${chg_ctaskassignment_group}"
            assignedTo: "${tech_lead}"
            additionalFields:
              work_start: "${start_date} ${start}"
              u_type: validation
              work_end: "${end_date} ${end}"
              state: Draft
            changeRequest: "${prod_crq_sys_id}"
            variableMapping:
              pythonScript.sysId: "${prod_gqe_validation_ctask_sys_id}"
              pythonScript.Ticket: "${prod_gqe_validation_ctask_number}"
              pythonScript.data: "${prod_gqe_validation_ctask_data}"
          - name: Create Prod Sustainment Validation CTask
            type: servicenow.CreateChangeTask
            servicenowServer: Disney Prod
            shortDescription: "Step 3:  PR - Sustainment Validation"
            ^description: |-
              *****************************************************************************************
              Change Coordination Team is requesting to attach all validation evidences to this CTASK for audit purposes ; escalation to respective managers will be imminent if evidences are not attached
              After validation is successful, please close this CTASK with closed notes.
              Harness Link:  ${app_harness_base_url}
              Rundeck Link: ${app_rundeck_nonprodjob}
              ******************************************************************************************
              Please validate:
              -  Delivery/Sustainment team to check the status endpoints to ensure correct version deployed in prod
              -  Delivery/Sustainment team to check that ec2 instances have come up and stabilized running correct version
              -  Delivery/Sustainment - Delivery/Sustainment to check proper version of code was deployed
              -  Delivery/Sustainment will run standard smoke tests that we execute after deployment. The smoke tests invoke endpoints and test the systems functionality after application is deployed. Additionally our smoke tests run on a schedule. Additionally will perform necessary
                  post deploy validation coverage which allows us to to detect any issues (ART, Error rate increase, Eventing failures) soon after each deployment
              -  AOE to perform appD monitoring
            ciSysId: "${prod_child_ci_sys_id}"
            assignmentGroup: "${chg_ctaskassignment_group}"
            assignedTo: "${tech_lead}"
            additionalFields:
              work_start: "${start_date} ${start}"
              u_type: validation
              work_end: "${end_date} ${end}"
              state: Draft
            changeRequest: "${prod_crq_sys_id}"
            variableMapping:
              pythonScript.Ticket: "${prod_vision_validation_ctask_number}"
              pythonScript.data: "${prod_vision_validation_ctask_data}"
              pythonScript.sysId: "${prod_vision_validation_ctask_sys_id}"
          - name: Relate QA Change
            type: servicenow.RelateItem
            servicenowServer: Disney Prod
            tableName: task_rel_task
            parentSysId: "${prod_crq_sys_id}"
            childSysId: "${qa_sys_id}"
            typeSysId: d80d5ec20a25810200be8bc5e2f64710
          - name: PROD CHG Notification
            type: msteams.Notification
            channel: "${channel}"
            message: |-
              üì¢ **Release PROD Draft Change Notification**

              IR - ${app_name} - ${Release_Version} - ${prod_crq_number} PROD - Change is Created and please find below ctasks.

              ---

              üõ†Ô∏è **Application**: ${app_name} - ${Release_Version}
              üì¶ **Build Version**: ${build_version}
              üîÅ **Environment**: Production

              üìù **Change Request ID**: [${prod_crq_number}](https://disney.service-now.com/change_request.do?sys_id=${prod_crq_sys_id})
              üìÑ **Service Now URL**: https://disney.service-now.com/change_request.do?sys_id=${prod_crq_sys_id}
              üìÑ **Change Summary**: ${business_justification}

              ---

              üìÑ **ADS Team Deploy**: ${prod_build_deploy_ctask_number}

              üìÑ **GQE Team Validation**: ${prod_gqe_validation_ctask_number}

              üìÑ **Application Team Validation**: ${prod_vision_validation_ctask_number}

              ---

              üìÖ **Scheduled Date**: ${start_date} ${start} and ${end_date} ${end}

              ‚úÖ Please Review and validate the change request.

              ---

              Thank you,
              **PCP Release Bot ü§ñ**

              ---
            variableMapping:
              pythonScript.server: "${teams_channel_ref}"
          - name: SmartSheet PROD Change Update#
            type: xlrelease.ScriptTask
            script: |-
              from java.net import URL
              from java.io import BufferedReader, InputStreamReader, DataOutputStream
              from java.text import SimpleDateFormat, ParseException
              from java.util import Locale, TimeZone, Date
              import com.xhaus.jyson.JysonCodec as json

              # --- Configuration & Inputs
              smartsheet_token = "Bearer " + releaseVariables['smart_api_token']
              sheet_id = releaseVariables['smartsheet_sheet_id']

              month_year_col_name = "Project/Studio"
              task_desc_col_name = "Task Description"
              release_version_col_name = "Release Version Link"
              added_by_col_name = "Added By"
              date_col_name = "Date"
              completed_row_value = "COMPLETED"

              release_type_col_name = "Type of Release"
              brand_col_name = "Brand"
              brand_value = releaseVariables['select_brand']

              # --- Dynamic Update Column from releaseVariables
              update_col_name = releaseVariables.get('target_prod_column', None)
              update_value = releaseVariables.get('prod_crq_number', None)

              app_name = releaseVariables['app_name']
              build_version = releaseVariables['build_version']
              added_by = releaseVariables['bot']

              due_date_obj = release.dueDate
              if not due_date_obj:
                  raise Exception("Release dueDate is not set.")

              month_year_format = SimpleDateFormat("MMMM yyyy", Locale.US)
              date_format = SimpleDateFormat("MM/dd/yy")
              iso_format = SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss'Z'")
              iso_format.setTimeZone(TimeZone.getTimeZone("UTC"))
              due_date_obj_iso = iso_format.format(due_date_obj)
              month_year_str = month_year_format.format(due_date_obj)
              due_date_str = date_format.format(due_date_obj)

              def smartsheet_api(url, method="GET", payload=None):
                  try:
                      conn = URL(url).openConnection()
                      conn.setRequestMethod(method)
                      conn.setRequestProperty("Authorization", smartsheet_token)
                      conn.setRequestProperty("Content-Type", "application/json")
                      if payload is not None:
                          conn.setDoOutput(True)
                          wr = DataOutputStream(conn.getOutputStream())
                          wr.writeBytes(payload)
                          wr.flush()
                          wr.close()
                      if conn.getResponseCode() >= 400:
                          err_stream = conn.getErrorStream()
                          reader = BufferedReader(InputStreamReader(err_stream))
                          err_msg = ""
                          line = reader.readLine()
                          while line:
                              err_msg += line
                              line = reader.readLine()
                          reader.close()
                          raise Exception("HTTP Error %s: %s" % (conn.getResponseCode(), err_msg))
                      in_stream = conn.getInputStream()
                      reader = BufferedReader(InputStreamReader(in_stream))
                      result = ""
                      line = reader.readLine()
                      while line:
                          result += line
                          line = reader.readLine()
                      reader.close()
                      return result
                  except Exception as e:
                      print("API call failed: %s" % e)
                      raise

              sheet_url = "https://api.smartsheet.com/2.0/sheets/%s" % sheet_id
              update_url = "https://api.smartsheet.com/2.0/sheets/%s/rows" % sheet_id

              sheet_json = json.loads(smartsheet_api(sheet_url))
              columns = sheet_json['columns']
              rows = sheet_json['rows']

              # Map column title -> id and id -> title
              col_map = {c['title']: c['id'] for c in columns}
              id_to_title = {c['id']: c['title'] for c in columns}

              for col in [month_year_col_name, task_desc_col_name, release_version_col_name,
                          added_by_col_name, date_col_name, release_type_col_name, brand_col_name]:
                  if col not in col_map:
                      raise Exception("Column '%s' not found in sheet." % col)

              # --- Dynamic QA column check
              if not update_col_name or update_col_name not in col_map:
                  raise Exception("Required dynamic column ('%s') not found in sheet." % update_col_name)

              month_year_col_id = col_map[month_year_col_name]
              task_desc_col_id = col_map[task_desc_col_name]
              release_version_col_id = col_map[release_version_col_name]
              added_by_col_id = col_map[added_by_col_name]
              date_col_id = col_map[date_col_name]
              release_type_col_id = col_map[release_type_col_name]
              brand_col_id = col_map[brand_col_name]
              update_col_id = col_map[update_col_name]

              # Date parsers
              iso_with_ms_z = SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss.SSS'Z'")
              iso_with_ms_z.setTimeZone(TimeZone.getTimeZone("UTC"))
              iso_with_z = SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss'Z'")
              iso_with_z.setTimeZone(TimeZone.getTimeZone("UTC"))
              iso_date_only = SimpleDateFormat("yyyy-MM-dd")
              parsers = [iso_with_ms_z, iso_with_z, iso_date_only, date_format]

              def robust_parse_date(date_val):
                  if isinstance(date_val, Date):
                      return date_val
                  s = str(date_val).strip()
                  for parser in parsers:
                      try:
                          return parser.parse(s)
                      except:
                          pass
                  return None

              # Helper to pretty-print a whole row (all columns/values)
              def print_full_row(row):
                  print("  --- Full row dump (rowId=%s) ---" % row.get('id'))
                  cells = row.get('cells', [])
                  for cell in cells:
                      col_id = cell.get('columnId')
                      col_title = id_to_title.get(col_id, "UNKNOWN_COLUMN_%s" % col_id)
                      # Prefer displayValue when present, fall back to value
                      if 'displayValue' in cell and cell['displayValue'] is not None:
                          val = cell['displayValue']
                      else:
                          val = cell.get('value')
                      print("    %s: %s" % (col_title, val))
                  print("  --- End of row dump ---")

              # Search for Month YYYY in all rows (skip COMPLETED)
              month_year_rows = []
              for row in rows:
                  for cell in row.get('cells', []):
                      if cell['columnId'] == month_year_col_id:
                          val = str(cell.get('value', '')).strip()
                          if val.upper() == completed_row_value:
                              break
                          if val == month_year_str:
                              month_year_rows.append(row)
                          break

              if not month_year_rows:
                  print("No matching Month YYYY rows found for '%s'." % month_year_str)

              any_match_found = False

              for parent_row in month_year_rows:
                  parent_row_id = parent_row['id']
                  print("\nFound Month YYYY row: ID=%s" % parent_row_id)

                  # Gather children, skip COMPLETED
                  child_rows = []
                  for row in rows:
                      if row.get('parentId') == parent_row_id:
                          skip = False
                          for cell in row.get('cells', []):
                              if cell['columnId'] == month_year_col_id:
                                  if str(cell.get('value', '')).strip().upper() == completed_row_value:
                                      skip = True
                                      break
                          if not skip:
                              child_rows.append(row)

                  # Check for matching child by App/Build/Date
                  matched_row = None
                  for child_row in child_rows:
                      tdesc_val = None
                      rver_val = None
                      due_date_val_str = None
                      for cell in child_row.get('cells', []):
                          if cell['columnId'] == task_desc_col_id:
                              tdesc_val = cell.get('value')
                          elif cell['columnId'] == release_version_col_id:
                              rver_val = cell.get('value')
                          elif cell['columnId'] == date_col_id:
                              val = cell.get('value')
                              parsed_date = robust_parse_date(val)
                              if parsed_date:
                                  due_date_val_str = date_format.format(parsed_date)
                      if tdesc_val == app_name and rver_val == build_version and due_date_val_str == due_date_str:
                          matched_row = child_row
                          break

                  if matched_row:
                      any_match_found = True
                      print("  MATCH FOUND for App=%s, Build=%s, Date=%s at row ID=%s"
                            % (app_name, build_version, due_date_str, matched_row['id']))

                      # Print the entire row with columns
                      print_full_row(matched_row)

                      # Update the dynamic QA column
                      update_cells = [
                          {"columnId": update_col_id, "value": update_value}
                      ]
                      update_payload = [{
                          "id": matched_row['id'],
                          "cells": update_cells
                      }]
                      result = smartsheet_api(update_url, "PUT", json.dumps(update_payload))
                      print("  ‚úÖ Updated column '%s' for child row ID %s. API Response: %s"
                            % (update_col_name, matched_row['id'], result))
                  else:
                      print("  No matching child row (App=%s, Build=%s, Date=%s) found under Month YYYY row ID=%s."
                            % (app_name, build_version, due_date_str, parent_row_id))

              # If nothing matched anywhere, fail the task
              if not any_match_found:
                  msg = ("No matching child row found for App=%s, Build=%s, Date=%s under any '%s' "
                         "Month YYYY row. Failing task."
                         % (app_name, build_version, due_date_str, month_year_str))
                  print(msg)
                  raise Exception(msg)

              print("\nScript finished successfully (at least one match found, printed, and updated).")
          - name: PROD CRQ Link to Jira Issues
            type: jira.LinkToServiceNow
            jiraServer: MyJira
            serviceNowChangeRequest: "${prod_crq_number}"
            serviceNowUrl: https://disney.service-now.com
            variableMapping:
              pythonScript.jiraIssues: "${JiraIssueIds}"
        - name: PROD Change Draft Completion
          type: delivery.MarkTrackedItems
          stage: Production Change Draft
          delivery: "${delivery_id}"
          pattern: Cynthia/PCP Release
          flagStatus: ATTENTION_NEEDED
          flagComment: "Task 'PROD Change Draft Completion' in Phase 'GQE & PE & PROD\
            \ CRQ' has properties that do not match with the known type. Following\
            \ properties do not match: [configurationUri]."
          variableMapping:
            pythonScript.trackedItems: "${application}"
    - name: PROD Change Draft Skip
      type: delivery.MarkTrackedItems
      stage: Production Change Draft
      ^status: SKIPPED
      delivery: "${delivery_id}"
      pattern: Cynthia/PCP Release
      flagStatus: ATTENTION_NEEDED
      flagComment: "Task 'PROD Change Draft Skip' in Phase 'GQE & PE & PROD CRQ' has\
        \ properties that do not match with the known type. Following properties do\
        \ not match: [configurationUri]."
      precondition: "${skip_prod} == False"
      variableMapping:
        pythonScript.trackedItems: "${application}"
    color: "#0079BC"
  - phase: CCB
    tasks:
    - name: CCB & Invite
      type: xlrelease.ParallelGroup
      precondition: "${skip_qa}"
      tasks:
      - name: CCB Defect fixes
        type: xlrelease.SequentialGroup
        precondition: "${skip_qa} == True"
        tasks:
        - name: Any Defects Found
          type: xlrelease.UserInputTask
          description: Please enable checkbox if you have any defects raised and ccb
            tasks need to be executed. IF YOU DONT WANT THEN PLEASE LEAVE ALL OPTION
            UNCHECKED AND CLICK ON COMPLETE AND PROVIDE SOME STATEMENT AND CLICK ON
            OK.
          owner: admin
          variables:
          - any_gqe_pe_defects
          - build_version
        - name: Create New QA Change
          type: xlrelease.SequentialGroup
          precondition: "${any_gqe_pe_defects}"
          tasks:
          - name: Compare Date
            type: xlrelease.ScriptTask
            script: |-
              from java.text import SimpleDateFormat
              from java.util import Date, TimeZone

              # Inputs
              qa_end_date_str     = releaseVariables.get('qa_end_date')
              qa_new_end_date_str = releaseVariables.get('qa_new_end_date')
              pattern             = "yyyy-MM-dd"

              if qa_end_date_str is None or qa_end_date_str.strip() == "":
                  raise Exception("qa_end_date release variable is not set or empty")

              sdf = SimpleDateFormat(pattern)
              sdf.setTimeZone(TimeZone.getDefault())

              qa_end_date     = sdf.parse(qa_end_date_str)
              qa_new_end_date = None
              if qa_new_end_date_str and qa_new_end_date_str.strip() != "":
                  try:
                      qa_new_end_date = sdf.parse(qa_new_end_date_str)
                  except Exception, e:
                      pass

              current_date = Date()

              print("Original qa_end_date: %s" % sdf.format(qa_end_date))
              print("New qa_end_date    : %s" % (sdf.format(qa_new_end_date) if qa_new_end_date else "None"))
              print("Current date       : %s" % sdf.format(current_date))

              # Reset ALL flags to False first
              flags = ['createNewQaChange', 'createNewQaCtasks', 'createoldQaCtasks', 'createNewQaunplannedCtasks']
              for flag in flags:
                  releaseVariables[flag] = False

              # **STATE 1: FIRST RUN** (no qa_new_end_date OR empty string)
              if qa_new_end_date is None:
                  if current_date.compareTo(qa_end_date) <= 0:
                      # Date valid ‚Üí OLD CR unplanned tasks only
                      releaseVariables['createoldQaCtasks'] = True
                      print("FIRST RUN: qa_end_date valid ‚Üí createoldQaCtasks=True")
                  else:
                      # Date expired ‚Üí NEW CR + implementation tasks
                      releaseVariables['createNewQaChange'] = True
                      releaseVariables['createNewQaCtasks'] = True
                      print("FIRST RUN: qa_end_date expired ‚Üí createNewQaChange=True, createNewQaCtasks=True")

              # **STATE 2+: LATER RUNS** (qa_new_end_date exists AND has valid date)
              else:
                  if current_date.compareTo(qa_new_end_date) > 0:
                      # Newest date expired ‚Üí create NEWEST CR
                      releaseVariables['createNewQaChange'] = True
                      releaseVariables['createNewQaCtasks'] = True
                      print("LATER RUN: qa_new_end_date expired ‚Üí createNewQaChange=True, createNewQaCtasks=True")
                  else:
                      # Newest date valid ‚Üí NEW CR unplanned tasks only
                      releaseVariables['createNewQaunplannedCtasks'] = True
                      print("LATER RUN: qa_new_end_date valid ‚Üí createNewQaunplannedCtasks=True")
          - name: Create QA Change
            type: xlrelease.SequentialGroup
            precondition: "${createNewQaChange}"
            tasks:
            - name: Set CRQ Variables
              type: xlrelease.ScriptTask
              owner: manoj.kumar.x.bijjala.-nd@disney.com
              script: |-
                from java.time import LocalDate

                qa_start_date = LocalDate.now()
                qa_end_date = qa_start_date.plusDays(60)

                releaseVariables['qa_new_start_date'] = qa_start_date
                releaseVariables['qa_new_end_date'] = qa_end_date
            - name: Find Stage CI SysID
              type: servicenow.FindCIByName
              servicenowServer: Disney Prod
              tableName: cmdb_ci_service_discovered
              ciName: "${app_name} - AWS Staging"
              variableMapping:
                pythonScript.sysId: "${stage_sys_id}"
            - name: Find Load SysID
              type: servicenow.FindCIByName
              servicenowServer: Disney Prod
              tableName: cmdb_ci_service_discovered
              ciName: "${app_name} - AWS Load Test"
              variableMapping:
                pythonScript.sysId: "${load_sys_id}"
            - name: Create QA CRQ
              type: servicenow.CreateChangeRequest
              servicenowServer: Disney Prod
              shortDescription: "QA - [AWS Docker Application] - For Independent Release\
                \ - ${Release_Version} for ${app_name}"
              ^description: |-
                ******************************************************************************************************************
                Application Name: ${app_name}
                BAPP ID: ${app_bappid}
                GitHub Link: https://github.disney.com/${app_gitorg}/${app_gitrepo}
                Harness Link:  ${app_harness_base_url}
                Rundeck Link: ${app_rundeck_nonprodjob}
                ******************************************************************************************************************

                1. Description of change including business driver/justification.  [Please provide detailed information to process this CR]
                Answer:
                Business Justification: ${business_justification}

                JIRA Tickets:
                ${JiraTicketDetails2}

                2. What is the business  impact/ risk to Disney if this work is not performed?
                Answer: ${business_impact}

                3. What are the user groups affected by this change? (with one of the following Guest/Cast/Both/None). (If None, please explain.)
                Answer: Guest/Cast {Both}

                4. Provide all PR details for this particular release [Release will not be considered if any of the PR is missed in the point below].
                Answer:
                ${pullRequestUrlsOnly}

                5. Was this Release tested in Latest before promoting to Stage & Load? Provide evidence.
                Answer.  ${Latest Test Results}

                6. What is the importance of this release [High/Medium/Low] ?
                Answer: Medium

                ******** CHECK THE CONFLICTS TAB TO SEE IF YOUR CHANGE HAS A CONFLICT PERTAINING TO A WDPR OPERATIONAL BLACKOUT. IF IT DOES THEN PLEASE ANSWER THE APPROPRIATE QUESTIONS BELOW IN ORDER TO RECEIVE REQUIRED APPROVALS******** (FOR PRODUCTION CHANGES ONLY)

                1. Provide Business Justification for implementing this change during the identified Blackout.
                Answer: ${blackout_scope}

                2. Provide a detailed description of any potential impact to the business if the change is not implemented during the identified Blackout.
                Answer: ${blackout_scope}

                3. Describe potential impact to any Financial Production Systems (ex: Financial Interfaces, Payment Process Systems and any impact to systems or services related to Media)
                Answer: ${blackout_scope}
              ciSysId: "${stage_sys_id}"
              assignmentGroup: "${chg_ctaskassignment_group}"
              assignedTo: Mosisin Anwar Mohammed
              state: Draft
              additionalFields:
                end_date: "${qa_new_end_date}"
                start_date: "${qa_new_start_date}"
                requested_by: "${tech_lead}"
                test_plan: "1. Latest Env Validated as expected by App Team.\n2. Once\
                  \ deployment done in STAGE/LOAD, GQE in STAGE and PE in LOAD will\
                  \ validate.\n3. Sustainment will monitor and analyze if any issue\
                  \ occurs   "
                category: Business Application
                u_peer_approval_group: "${chg_peerapproval_group}"
                change_plan: "***NOTHING ON THIS TEMPLATE IS TO BE DELETED***\nTechnical\
                  \ details provided here explain how to implement this change. The\
                  \ intent of information captured within the change plan should be\
                  \ sufficient for any operation or engineer to pick up & implement\
                  \ ‚Äì specifically calling out all steps, scripts + versions, files,\
                  \ commands, etc. Step by step. Include script names, etc. Information\
                  \ may also be referred to and included the Implementation task.\n\
                  \n***Please DO NOT provide a link to the technical details.*** \
                  \ \n\nStep 1: IR Team will deploy in STAGE environment\nStep 2:\
                  \ IR Team will deploy in LOAD environment\nStep 3: Validation by\
                  \ Studio Kylo [SDET Validation] in STAGE environment\nStep 4: Validation\
                  \ by Application Lead\nStep 5: Sustainment Team Studio Vision Validation\n\
                  Step 6: GQE Certification  \nStep 7: PE Certification [Performance\
                  \ Engineering Team]  \n\n"
                u_subcategory: "${chg_subcategory}"
                backout_plan: "If any deployments are failed or app is not stable,\
                  \ will rollback to the successful running version.  "
                u_template: "${chg_template}"
              variableMapping:
                pythonScript.sysId: "${qa_new_sys_id}"
                pythonScript.Ticket: "${qa_new_crq_number}"
            - name: Create Deploy CTask - Stage
              type: servicenow.CreateChangeTask
              servicenowServer: Disney Prod
              shortDescription: "QA - CCB -Stage Deployment for ${app_name}- ${Release_Version}\
                \ - ${build_version}"
              ^description: |-
                CCB - Stage Deployment for ${app_name} - ${Release_Version} - ${build_version}



                Application Team: ${app_name}
                ==========================================================
                Rundeck Project:  ${app_rundeck_nonprodjob}
                Build version: ${build_version}
                Environment: Stage
                ${rundeck_deploy_lambda_options}
                ====================================================================
              ciSysId: "${app_name} - AWS Staging"
              assignmentGroup: "${chg_assignment_group}"
              assignedTo: _SNAPI_f-pcsxebia
              state: Draft
              additionalFields:
                work_end: "${qa_new_end_date}"
                u_type: implementation
                work_start: "${qa_new_start_date}"
              changeRequest: "${qa_new_sys_id}"
              precondition: "${createNewQaCtasks2}"
              variableMapping:
                pythonScript.sysId: "${stage_ccb_new_deploy_ctask_sys_id}"
                pythonScript.Ticket: "${stage_ccb_new_deploy_ctask_number}"
            - name: Create CCB CTask - Load
              type: servicenow.CreateChangeTask
              servicenowServer: Disney Prod
              shortDescription: "QA - CCB - Load Deployment for ${app_name} -  ${Release_Version}-${build_version}"
              ^description: |-
                CCB - Load Deployment for ${app_name} - ${Release_Version} - ${build_version}



                Application Team: ${app_name}
                ==========================================================
                Rundeck Project:  ${app_rundeck_nonprodjob}
                Build version: ${build_version}
                Environment: load
                ${rundeck_deploy_lambda_options}
                ====================================================================
              ciSysId: "${app_name} - AWS Load Test"
              assignmentGroup: "${chg_assignment_group}"
              assignedTo: _SNAPI_f-pcsxebia
              state: Draft
              additionalFields:
                work_end: "${qa_new_end_date}"
                u_type: implementation
                work_start: "${qa_new_start_date}"
              changeRequest: "${qa_new_sys_id}"
              precondition: "${createNewQaCtasks2}"
              variableMapping:
                pythonScript.Ticket: "${load_ccb_new_deploy_ctask_number}"
                pythonScript.sysId: "${load_ccb_new_deploy_ctask_sys_id}"
            - name: Create Sustainment Team Validation CTask
              type: servicenow.CreateChangeTask
              servicenowServer: Disney Prod
              shortDescription: "QA - Independent Release - ${app_name} ${Release_Version}\
                \ - Sustainment Team Validation"
              ^description: |-
                Sustainment Team Validation for ${app_name}-${build_version}

                -  Delivery/Sustainment team to check the status endpoints to ensure correct version deployed in load
                - Delivery/Sustainment team to check that ec2 instances have come up and stabilized running correct version
                - Delivery/Sustainment - Delivery/Sustainment to check proper version of code was deployed
                - Delivery/Sustainmnet will run standard smoke tests that we execute after deployment. The smoke tests invoke endpoints and test the systems functionality after application is deployed. Additionally our smoke tests run on a schedule. Additionally will perform necessary post deploy validation coverage which allows us to to detect any issues (ART, Error rate increase, Eventing failures) soon after each deployment
              ciSysId: "${load_sys_id}"
              assignmentGroup: "${chg_ctaskassignment_group}"
              assignedTo: "${tech_lead}"
              additionalFields:
                u_type: validation
                work_end: "${qa_new_end_date}"
                state: Draft
                work_start: "${qa_new_start_date}"
              changeRequest: "${qa_new_sys_id}"
              precondition: "${createNewQaCtasks2}"
              variableMapping:
                pythonScript.sysId: "${loadvalidation_new_ctask_sys_id}"
                pythonScript.Ticket: "${loadvalidation_new_ctask_number}"
            - name: QA CHG Notification
              type: msteams.Notification
              channel: "${channel_name}"
              message: |-
                üì¢ **Release QA Change Creation Notification**

                ---

                üõ†Ô∏è **Application**: ${app_name} - ${Release_Version}

                üì¶ **Build Version**: ${build_version}

                üîÅ **Environment**: Stage  & Load

                üìù **Change Request ID**: [${qa_new_crq_number}](https://disney.service-now.com/change_request.do?sys_id=${qa_new_sys_id})
                üìÑ **Change Request URL**: https://disney.service-now.com/change_request.do?sys_id=${qa_new_sys_id}
                üìÑ **Change Summary**: ${business_justification}

                üìÖ **Scheduled Start Date**: ${qa_new_start_date}
                üìÖ **Scheduled End Date**: ${qa_new_end_date}

                ‚úÖ Please validate the change and Push for Peer Approval.

                ---

                Thank you,
                **PCP  Release Bot ü§ñ**

                ---
              variableMapping:
                pythonScript.server: "${teams_channel_ref}"
            - name: QA CRQ Link to Jira Issues
              type: jira.LinkToServiceNow
              jiraServer: MyJira
              serviceNowChangeRequest: "${qa_new_crq_number}"
              serviceNowUrl: https://disney.service-now.com
              variableMapping:
                pythonScript.jiraIssues: "${JiraIssueIds}"
            - name: Manual QA CHG Efforts
              type: xlrelease.SequentialGroup
              tasks:
              - name: "CRQ ${qa_crq_number} Pending Peer Approval ?"
                type: servicenow.PollingCheckStatus
                servicenowServer: Disney Prod
                sysId: "${qa_new_sys_id}"
                statusField: approval
                checkForStatus: Pending Peer Approval
              - name: "Approve  ${qa_crq_number}"
                type: msteams.Notification
                server: Peer Approval
                channel: "#DigitalPeerApproval"
                message: |-
                  @${service_owner}

                  üì¢ **Release QA Change Peer Approval Notification**


                  ---

                  üõ†Ô∏è **Application**: ${app_name} - ${Release_Version}
                  üì¶ **Build Version**: ${build_version}
                  üîÅ **Environment**: Stage  & Load

                  üìù **Change Request ID**: [${qa_new_crq_number}](https://disney.service-now.com/change_request.do?sys_id=${qa_new_sys_id})
                  üìÑ **Change Request URL**: https://disney.service-now.com/change_request.do?sys_id=${qa_new_sys_id}
                  üìÑ **Change Summary**: ${business_justification}

                  üìÖ **Scheduled Start Date**: ${qa_new_start_date}
                  üìÖ **Scheduled End Date**: ${qa_new_end_date}


                  ‚úÖ Please Peer Review the change and Approve.

                  ---

                  Thank you,
                  **PCP Release Bot ü§ñ**

                  ---
                owner: admin
              - name: "CRQ ${qa_crq_number} Approved ?"
                type: servicenow.PollingCheckStatus
                servicenowServer: Disney Prod
                sysId: "${qa_new_sys_id}"
                statusField: approval
                checkForStatus: Approved
              - name: QA CHG Notification
                type: msteams.Notification
                channel: "${channel_name}"
                message: |-
                  üì¢ **Release QA Change Approval Notification**

                  ---

                  üõ†Ô∏è **Application**: ${app_name} - ${Release_Version}

                  üì¶ **Build Version**: ${build_version}
                  üîÅ **Environment**: Stage  & Load

                  üìù **Change Request ID**: [${qa_new_crq_number}](https://disney.service-now.com/change_request.do?sys_id=${qa_new_sys_id})
                  üìÑ **Change Summary**: ${business_justification}

                  üìÖ **Scheduled Start Date**: ${qa_new_start_date}
                  üìÖ **Scheduled End Date**: ${qa_new_end_date}

                  ‚úÖ QA Change is Approved.

                  ---

                  Thank you,
                  **PCP Release Bot ü§ñ**

                  ---
                owner: admin
                variableMapping:
                  pythonScript.server: "${teams_channel_ref}"
              - name: Relate QA New Change WIth PROD CHANGE
                type: servicenow.RelateItem
                servicenowServer: Disney Prod
                tableName: task_rel_task
                parentSysId: "${prod_crq_sys_id}"
                childSysId: "${qa_new_sys_id}"
                typeSysId: d80d5ec20a25810200be8bc5e2f64710
        - name: CCB Defect Fixes Deployment
          type: xlrelease.SequentialGroup
          precondition: "${any_gqe_pe_defects}"
          tasks:
          - name: CCB QA Deployment
            type: xlrelease.ParallelGroup
            tasks:
            - name: CCB Deploy to Stage
              type: xlrelease.SequentialGroup
              tasks:
              - name: Create Old QA Deploy CTask - Stage
                type: servicenow.CreateChangeTask
                servicenowServer: Disney Prod
                shortDescription: "QA - CCB -Stage Deployment for ${app_name}- ${Release_Version}\
                  \ - ${build_version}"
                ^description: |-
                  CCB - Stage Deployment for ${app_name} - ${Release_Version} - ${build_version}



                  Application Team: ${app_name}
                  ==========================================================
                  Rundeck Project:  ${app_rundeck_nonprodjob}
                  Build version: ${build_version}
                  Environment: Stage
                  ${rundeck_deploy_lambda_options}
                  ====================================================================
                ciSysId: "${app_name} - AWS Staging"
                assignmentGroup: "${chg_assignment_group}"
                assignedTo: _SNAPI_f-pcsxebia
                state: In Progress
                additionalFields:
                  u_type: unplanned
                  work_end: "${qa_end_date}"
                  work_start: "${qa_start_date}"
                changeRequest: "${qa_sys_id}"
                precondition: "${createoldQaCtasks}"
                variableMapping:
                  pythonScript.Ticket: "${stage_ccb_deploy_ctask_number}"
                  pythonScript.sysId: "${stage_ccb_deploy_ctask_sys_id}"
              - name: Create Deploy CTask for New Change  - Stage
                type: servicenow.CreateChangeTask
                servicenowServer: Disney Prod
                shortDescription: "QA - CCB -Stage Deployment for ${app_name}- ${Release_Version}\
                  \ - ${build_version}"
                ^description: |-
                  CCB - Stage Deployment for ${app_name} - ${Release_Version} - ${build_version}



                  Application Team: ${app_name}
                  ==========================================================
                  Rundeck Project:  ${app_rundeck_nonprodjob}
                  Build version: ${build_version}
                  Environment: Stage
                  ${rundeck_deploy_lambda_options}
                  ====================================================================
                ciSysId: "${app_name} - AWS Staging"
                assignmentGroup: "${chg_assignment_group}"
                assignedTo: _SNAPI_f-pcsxebia
                state: In Progress
                additionalFields:
                  u_type: unplanned
                  work_end: "${qa_new_end_date}"
                  work_start: "${qa_new_start_date}"
                changeRequest: "${qa_new_sys_id}"
                precondition: "${createNewQaunplannedCtasks}"
                variableMapping:
                  pythonScript.sysId: "${stage_ccb_new_deploy_ctask_sys_id}"
                  pythonScript.Ticket: "${stage_ccb_new_deploy_ctask_number}"
              - name: Deploy Stage
                type: xlrelease.SequentialGroup
                tasks:
                - name: Stage Deploy Rundeck API Call
                  type: xlrelease.ScriptTask
                  taskFailureHandlerEnabled: true
                  taskRecoverOp: SKIP_TASK
                  ignoreScriptVariableInterpolation: true
                  script: |-
                    from java.net import URL
                    from java.io import BufferedReader, InputStreamReader, OutputStreamWriter
                    import json
                    import time

                    # === CONFIGURATION ===
                    RUNDECK_API_URL = "https://rundeck.wdprapps.disney.com/api/52"
                    JOB_ID = releaseVariables['app_rundeck_uuid']
                    POLL_INTERVAL = 60  # seconds between polling

                    API_TOKEN = releaseVariables['rundeckApiToken']

                    # === STATIC ENVIRONMENT ===
                    target_env = "stage"  # Static value - change as needed ("stage", "load", "prod", etc.)

                    # === DYNAMIC JOB OPTIONS FROM LIST VARIABLE ===
                    app_name = releaseVariables.get('app_name', '').lower()
                    lambda_apps_list = releaseVariables.get('lambdaAppsList', [])

                    # Check if current app is in lambda apps list (Jython 2.7 compatible)
                    is_lambda_app = False
                    for lambda_app in lambda_apps_list:
                        if lambda_app.lower() in app_name:
                            is_lambda_app = True
                            break

                    if is_lambda_app:
                        job_options = {
                            "environment": target_env,
                            "version": releaseVariables['build_version'],
                            "function": "all"
                        }
                        print("üêë Lambda app (%s) in %s: using Lambda-specific job options" % (app_name, target_env))
                    else:
                        job_options = {
                            "environment": target_env,
                            "version": releaseVariables['build_version']
                        }
                        print("üì± Standard app (%s) in %s: using default job options" % (app_name, target_env))

                    # === Helper Functions ===
                    def http_post(url_str, payload, headers):
                        url = URL(url_str)
                        conn = url.openConnection()
                        conn.setDoOutput(True)
                        conn.setRequestMethod("POST")
                        for key, value in headers.items():
                            conn.setRequestProperty(key, value)

                        writer = OutputStreamWriter(conn.getOutputStream())
                        writer.write(payload)
                        writer.flush()
                        writer.close()

                        response_code = conn.getResponseCode()
                        stream = conn.getInputStream() if response_code == 200 else conn.getErrorStream()
                        reader = BufferedReader(InputStreamReader(stream))
                        response = ""
                        line = reader.readLine()
                        while line is not None:
                            response += line + "\n"
                            line = reader.readLine()
                        reader.close()

                        if response_code != 200:
                            raise Exception("HTTP {} Error: {}".format(response_code, response))
                        return json.loads(response)

                    def http_get(url_str, headers):
                        url = URL(url_str)
                        conn = url.openConnection()
                        conn.setRequestMethod("GET")
                        for key, value in headers.items():
                            conn.setRequestProperty(key, value)

                        response_code = conn.getResponseCode()
                        stream = conn.getInputStream() if response_code == 200 else conn.getErrorStream()
                        reader = BufferedReader(InputStreamReader(stream))
                        response = ""
                        line = reader.readLine()
                        while line is not None:
                            response += line + "\n"
                            line = reader.readLine()
                        reader.close()

                        if response_code != 200:
                            raise Exception("HTTP {} Error: {}".format(response_code, response))
                        return json.loads(response)

                    # === Trigger Rundeck Job ===
                    headers = {
                        "Accept": "application/json",
                        "Content-Type": "application/json",
                        "X-Rundeck-Auth-Token": API_TOKEN
                    }

                    run_url = RUNDECK_API_URL + "/job/" + JOB_ID + "/run"
                    payload = json.dumps({"options": job_options})
                    response = http_post(run_url, payload, headers)

                    execution_id = response.get("id")
                    execution_url = RUNDECK_API_URL.replace("/api/52", "") + "/execution/show/" + str(execution_id)

                    print "‚úÖ Rundeck job triggered successfully in %s" % target_env
                    print "Execution ID: {}".format(execution_id)
                    print "Execution URL: {}".format(execution_url)
                    print "Job options: {}".format(json.dumps(job_options))

                    # === Poll for Job Status ===
                    status = "running"
                    status_url = RUNDECK_API_URL + "/execution/" + str(execution_id)

                    while status == "running":
                        print "Polling Rundeck execution status in %s..." % target_env
                        time.sleep(POLL_INTERVAL)
                        status_response = http_get(status_url, headers)
                        status = status_response.get("status")
                        print "Current Rundeck job status: {}".format(status)

                    # === Set Release Variables (Environment-specific) ===
                    env_prefix = "rundeck%s" % target_env.title()
                    releaseVariables["%sExecutionStatus" % env_prefix] = status
                    releaseVariables["%sExecutionUrl" % env_prefix] = execution_url
                    releaseVariables["%sJobSucceeded" % env_prefix] = (status == "succeeded")
                    releaseVariables["%sJobFailed" % env_prefix] = (status != "succeeded")

                    print "Set %sJobSucceeded = {}".format(env_prefix, status == "succeeded")
                    print "Set %sJobFailed = {}".format(env_prefix, status != "succeeded")

                    # === Result Handling ===
                    if status == "succeeded":
                        print "üéâ Rundeck job completed successfully in %s." % target_env
                    else:
                        print "‚ùå Rundeck job failed with status: {} in %s".format(status, target_env)
                        raise Exception("Rundeck job failed in %s: {}".format(target_env, status))
                - name: INC Effort & Notification
                  type: xlrelease.SequentialGroup
                  precondition: "${rundeckStageJobFailed}"
                  tasks:
                  - name: If Deploy Failure - INC
                    type: servicenow.CreateIncident
                    servicenowServer: Disney Prod
                    shortDescription: "IR- QA - ${app_name}-${Release_Version} - Stage\
                      \ Deploy Failed"
                    ^description: |-
                      Please take a look at deploy failure

                      Rundeck URL: ${rundeckStageExecutionUrl}
                    ciSysId: "${app_name} - AWS Staging"
                    assignmentGroup: ops-global-parks-se
                    additionalFields:
                      urgency: "4"
                      caller_id: _SNAPI_f-pcsxebia
                      impact: "4"
                      subcategory: application
                      category: repair
                    variableMapping:
                      pythonScript.Ticket: "${stage_inc_deploy_failure}"
                  - name: "Deploy Failure INC - ${stage_inc_deploy_failure} Notification"
                    type: msteams.Notification
                    channel: "#${channel_name}"
                    message: |-
                      *QA - Stage - ${app_name} - ${Release_Version}:
                      Stage Deploy Failed and ${stage_inc_deploy_failure} is opened. Please Follow Up.
                      Rundeck Execution URL : ${rundeckStageExecutionUrl}
                    watchers:
                    - ""
                    variableMapping:
                      pythonScript.server: "${teams_channel_ref}"
                  - name: Is Stage Deploy Issue Fixed?
                    type: xlrelease.UserInputTask
                    description: If the deploy issue is fixed please check box and
                      proceed further
                    variables:
                    - deploy_fixed
              - name: Close Old QA Deployment CTask
                type: servicenow.UpdateChangeTask
                servicenowServer: Disney Prod
                state: Closed Complete
                additionalFields:
                  u_close_code: successful
                shortDescription: "QA - CCB - Stage Deployment for ${app_name}- ${Release_Version}\
                  \ -${build_version}"
                sysId: "${stage_ccb_deploy_ctask_sys_id}"
                changeRequest: "${qa_sys_id}"
                closeNotes: Successfully Deployed
                precondition: "${createoldQaCtasks}"
              - name: Close Deployment CTask for New Change
                type: servicenow.UpdateChangeTask
                servicenowServer: Disney Prod
                state: Closed Complete
                additionalFields:
                  u_close_code: successful
                shortDescription: "QA - CCB - Stage Deployment for ${app_name}- ${Release_Version}\
                  \ -${build_version}"
                sysId: "${stage_ccb_new_deploy_ctask_sys_id}"
                changeRequest: "${qa_new_sys_id}"
                closeNotes: Successfully Deployed
                precondition: "${createNewQaCtasks} or ${createNewQaunplannedCtasks}"
              - name: Old QA CR Stage Deploy Notify
                type: msteams.Notification
                channel: "#${channel}"
                message: |-
                  üì¢ **CCB Stage Deployment Notification**

                  Stage deployment has been triggered and completed.

                  ---

                  üõ†Ô∏è **Application**: ${app_name} - ${Release_Version}
                  üì¶ **Build Version**: ${build_version}
                  üîÅ **Environment**: Stage

                  üìù **Change Request ID**: [${qa_crq_number}](https://disney.service-now.com/change_request.do?sys_id=${qa_sys_id})
                  üìÑ **Change Summary**: ${business_justification}

                  üìÑ **Stage Change Task**: ${stage_ccb_deploy_ctask_number}
                  üìÖ **Scheduled Date**: ${qa_start_date} - ${qa_end_date}

                  ‚úÖ Please validate the deployment.

                  ---

                  Thank you,
                  **PCP Release Bot ü§ñ**

                  ---
                owner: admin
                precondition: "${createoldQaCtasks}"
                variableMapping:
                  pythonScript.server: "${teams_channel_ref}"
              - name: New QA CR Stage Deploy Notify
                type: msteams.Notification
                channel: "#${channel}"
                message: |-
                  üì¢ **CCB Stage Deployment Notification**

                  Stage deployment has been triggered and completed.

                  ---

                  üõ†Ô∏è **Application**: ${app_name} - ${Release_Version}
                  üì¶ **Build Version**: ${build_version}
                  üîÅ **Environment**: Stage

                  üìù **Change Request ID**: [${qa_new_crq_number}](https://disney.service-now.com/change_request.do?sys_id=${qa_new_sys_id})
                  üìÑ **Change Summary**: ${business_justification}

                  üìÑ **Stage Change Task**: ${stage_ccb_new_deploy_ctask_number}
                  üìÖ **Scheduled Date**: ${qa_new_start_date} - ${qa_new_end_date}

                  ‚úÖ Please validate the deployment.

                  ---

                  Thank you,
                  **PCP Release Bot ü§ñ**

                  ---
                owner: admin
                precondition: "${createNewQaCtasks} or ${createNewQaunplannedCtasks}"
                variableMapping:
                  pythonScript.server: "${teams_channel_ref}"
            - name: CCB Deploy to Load
              type: xlrelease.SequentialGroup
              tasks:
              - name: Create Old QA CCB CTask - Load
                type: servicenow.CreateChangeTask
                servicenowServer: Disney Prod
                shortDescription: "QA - CCB - Load Deployment for ${app_name} -  ${Release_Version}-${build_version}"
                ^description: |-
                  CCB - Load Deployment for ${app_name} - ${Release_Version} - ${build_version}



                  Application Team: ${app_name}
                  ==========================================================
                  Rundeck Project:  ${app_rundeck_nonprodjob}
                  Build version: ${build_version}
                  Environment: load
                  ${rundeck_deploy_lambda_options}
                  ====================================================================
                ciSysId: "${app_name} - AWS Load Test"
                assignmentGroup: "${chg_assignment_group}"
                assignedTo: _SNAPI_f-pcsxebia
                state: In Progress
                additionalFields:
                  work_end: "${qa_end_date}"
                  work_start: "${qa_start_date}"
                  u_type: "${ccb_ctask_type}"
                changeRequest: "${qa_sys_id}"
                precondition: "${createoldQaCtasks}"
                variableMapping:
                  pythonScript.sysId: "${load_ccb_deploy_ctask_sys_id}"
                  pythonScript.Ticket: "${load_ccb_deploy_ctask_number}"
              - name: Create CCB New CTask - Load
                type: servicenow.CreateChangeTask
                servicenowServer: Disney Prod
                shortDescription: "QA - CCB - Load Deployment for ${app_name} -  ${Release_Version}-${build_version}"
                ^description: |-
                  CCB - Load Deployment for ${app_name} - ${Release_Version} - ${build_version}



                  Application Team: ${app_name}
                  ==========================================================
                  Rundeck Project:  ${app_rundeck_nonprodjob}
                  Build version: ${build_version}
                  Environment: load
                  ${rundeck_deploy_lambda_options}
                  ====================================================================
                ciSysId: "${app_name} - AWS Load Test"
                assignmentGroup: "${chg_assignment_group}"
                assignedTo: _SNAPI_f-pcsxebia
                state: In Progress
                additionalFields:
                  work_end: "${qa_new_end_date}"
                  u_type: "${ccb_ctask_type}"
                  work_start: "${qa_new_start_date}"
                changeRequest: "${qa_new_sys_id}"
                precondition: "${createNewQaunplannedCtasks}"
                variableMapping:
                  pythonScript.Ticket: "${load_ccb_new_deploy_ctask_number}"
                  pythonScript.sysId: "${load_ccb_new_deploy_ctask_sys_id}"
              - name: Deploy Load
                type: xlrelease.SequentialGroup
                tasks:
                - name: Load Deploy Rundeck POST API Call
                  type: xlrelease.ScriptTask
                  taskFailureHandlerEnabled: true
                  taskRecoverOp: SKIP_TASK
                  ignoreScriptVariableInterpolation: true
                  script: |-
                    from java.net import URL
                    from java.io import BufferedReader, InputStreamReader, OutputStreamWriter
                    import json
                    import time

                    # === CONFIGURATION ===
                    RUNDECK_API_URL = "https://rundeck.wdprapps.disney.com/api/52"
                    JOB_ID = releaseVariables['app_rundeck_uuid']
                    POLL_INTERVAL = 60  # seconds between polling

                    API_TOKEN = releaseVariables['rundeckApiToken']

                    # === STATIC ENVIRONMENT ===
                    target_env = "load"  # Static value - change as needed ("stage", "load", "prod", etc.)

                    # === DYNAMIC JOB OPTIONS FROM LIST VARIABLE ===
                    app_name = releaseVariables.get('app_name', '').lower()
                    lambda_apps_list = releaseVariables.get('lambdaAppsList', [])

                    # Check if current app is in lambda apps list (Jython 2.7 compatible)
                    is_lambda_app = False
                    for lambda_app in lambda_apps_list:
                        if lambda_app.lower() in app_name:
                            is_lambda_app = True
                            break

                    if is_lambda_app:
                        job_options = {
                            "environment": target_env,
                            "version": releaseVariables['build_version'],
                            "function": "all",
                            "stage": "live"
                        }
                        print("üêë Lambda app (%s) in %s: using Lambda-specific job options" % (app_name, target_env))
                    else:
                        job_options = {
                            "environment": target_env,
                            "version": releaseVariables['build_version']
                        }
                        print("üì± Standard app (%s) in %s: using default job options" % (app_name, target_env))

                    # === Helper Functions ===
                    def http_post(url_str, payload, headers):
                        url = URL(url_str)
                        conn = url.openConnection()
                        conn.setDoOutput(True)
                        conn.setRequestMethod("POST")
                        for key, value in headers.items():
                            conn.setRequestProperty(key, value)

                        writer = OutputStreamWriter(conn.getOutputStream())
                        writer.write(payload)
                        writer.flush()
                        writer.close()

                        response_code = conn.getResponseCode()
                        stream = conn.getInputStream() if response_code == 200 else conn.getErrorStream()
                        reader = BufferedReader(InputStreamReader(stream))
                        response = ""
                        line = reader.readLine()
                        while line is not None:
                            response += line + "\n"
                            line = reader.readLine()
                        reader.close()

                        if response_code != 200:
                            raise Exception("HTTP {} Error: {}".format(response_code, response))
                        return json.loads(response)

                    def http_get(url_str, headers):
                        url = URL(url_str)
                        conn = url.openConnection()
                        conn.setRequestMethod("GET")
                        for key, value in headers.items():
                            conn.setRequestProperty(key, value)

                        response_code = conn.getResponseCode()
                        stream = conn.getInputStream() if response_code == 200 else conn.getErrorStream()
                        reader = BufferedReader(InputStreamReader(stream))
                        response = ""
                        line = reader.readLine()
                        while line is not None:
                            response += line + "\n"
                            line = reader.readLine()
                        reader.close()

                        if response_code != 200:
                            raise Exception("HTTP {} Error: {}".format(response_code, response))
                        return json.loads(response)

                    # === Trigger Rundeck Job ===
                    headers = {
                        "Accept": "application/json",
                        "Content-Type": "application/json",
                        "X-Rundeck-Auth-Token": API_TOKEN
                    }

                    run_url = RUNDECK_API_URL + "/job/" + JOB_ID + "/run"
                    payload = json.dumps({"options": job_options})
                    response = http_post(run_url, payload, headers)

                    execution_id = response.get("id")
                    execution_url = RUNDECK_API_URL.replace("/api/52", "") + "/execution/show/" + str(execution_id)

                    print "‚úÖ Rundeck job triggered successfully in %s" % target_env
                    print "Execution ID: {}".format(execution_id)
                    print "Execution URL: {}".format(execution_url)
                    print "Job options: {}".format(json.dumps(job_options))

                    # === Poll for Job Status ===
                    status = "running"
                    status_url = RUNDECK_API_URL + "/execution/" + str(execution_id)

                    while status == "running":
                        print "Polling Rundeck execution status in %s..." % target_env
                        time.sleep(POLL_INTERVAL)
                        status_response = http_get(status_url, headers)
                        status = status_response.get("status")
                        print "Current Rundeck job status: {}".format(status)

                    # === Set Release Variables (Environment-specific) ===
                    env_prefix = "rundeck%s" % target_env.title()
                    releaseVariables["%sExecutionStatus" % env_prefix] = status
                    releaseVariables["%sExecutionUrl" % env_prefix] = execution_url
                    releaseVariables["%sJobSucceeded" % env_prefix] = (status == "succeeded")
                    releaseVariables["%sJobFailed" % env_prefix] = (status != "succeeded")

                    print "Set %sJobSucceeded = {}".format(env_prefix, status == "succeeded")
                    print "Set %sJobFailed = {}".format(env_prefix, status != "succeeded")

                    # === Result Handling ===
                    if status == "succeeded":
                        print "üéâ Rundeck job completed successfully in %s." % target_env
                    else:
                        print "‚ùå Rundeck job failed with status: {} in %s".format(status, target_env)
                        raise Exception("Rundeck job failed in %s: {}".format(target_env, status))
                - name: INC Effort & Notification
                  type: xlrelease.SequentialGroup
                  precondition: "${rundeckLoadJobFailed}"
                  tasks:
                  - name: If Deploy Failure - INC
                    type: servicenow.CreateIncident
                    servicenowServer: Disney Prod
                    shortDescription: "IR- QA - ${app_name}-${Release_Version} - Load\
                      \ Deploy Failed"
                    ^description: |-
                      Please take a look at deploy failure

                      Rundeck URL: ${rundeckLoadExecutionUrl}
                    ciSysId: "${app_name} - AWS Load Test"
                    assignmentGroup: "${chg_ctaskassignment_group}"
                    additionalFields:
                      urgency: "4"
                      caller_id: _SNAPI_f-pcsxebia
                      impact: "4"
                      subcategory: application
                      category: repair
                    dueDate: 2020-06-29T08:49:00Z
                    variableMapping:
                      pythonScript.Ticket: "${load_inc_deploy_failure}"
                  - name: "Deploy Failure INC - ${load_inc_deploy_failure} Notification"
                    type: msteams.Notification
                    channel: "#${channel_name}"
                    message: |-
                      *QA - Load - ${app_name} - ${Release_Version}:
                      Load Deploy Failed and ${load_inc_deploy_failure} is opened. Please Follow Up.
                      Rundeck Execution URL: ${rundeckLoadExecutionUrl}
                    variableMapping:
                      pythonScript.server: "${teams_channel_ref}"
                  - name: Is Load Deploy Issue Fixed?
                    type: xlrelease.UserInputTask
                    description: If the deploy issue is fixed please check box and
                      proceed further
                    variables:
                    - deploy_fixed
              - name: Close Old QA CR CCB Deployment CTask
                type: servicenow.UpdateChangeTask
                servicenowServer: Disney Prod
                state: Closed Complete
                additionalFields:
                  u_close_code: successful
                shortDescription: "QA - CCB - Load Deployment for ${app_name}-${Release_Version}\
                  \ -${build_version}"
                sysId: "${load_ccb_deploy_ctask_sys_id}"
                changeRequest: "${qa_sys_id}"
                closeNotes: Deployed Successfully
                precondition: "${createoldQaCtasks}"
              - name: Close New QA CR CCB Deployment CTask
                type: servicenow.UpdateChangeTask
                servicenowServer: Disney Prod
                state: Closed Complete
                additionalFields:
                  u_close_code: successful
                shortDescription: "QA - CCB - Load Deployment for ${app_name}-${Release_Version}\
                  \ -${build_version}"
                sysId: "${load_ccb_new_deploy_ctask_sys_id}"
                changeRequest: "${qa_new_sys_id}"
                closeNotes: Deployed Successfully
                precondition: "${createNewQaCtasks} or ${createNewQaunplannedCtasks}"
              - name: "Notify ${Release_Version}-${build_version} Old QA CCB Load"
                type: msteams.Notification
                channel: "#${channel_name}"
                message: |-
                  üì¢ **Load CCB Deployment Notification**

                  Load deployment has been triggered and completed.

                  ---

                  üõ†Ô∏è **Application**: ${app_name} - ${Release_Version}
                  üì¶ **Build Version**: ${build_version}
                  üîÅ **Environment**: Load

                  üìù **Change Request ID**: [${qa_crq_number}](https://disney.service-now.com/change_request.do?sys_id=${qa_sys_id})
                  üìÑ **Change Summary**: ${business_justification}

                  üìÑ **Load CCB Change Task**: ${load_ccb_deploy_ctask_number}
                  üìÖ **Scheduled Date**: ${qa_start_date} - ${qa_end_date}


                  ---

                  ‚úÖ Please validate the deployment.

                  ---

                  Thank you,
                  **PCP Release Bot ü§ñ**

                  ---
                precondition: "${createoldQaCtasks}"
                variableMapping:
                  pythonScript.server: "${teams_channel_ref}"
              - name: "Notify New QA CR CCB Load - ${build_version}"
                type: msteams.Notification
                channel: "#${channel_name}"
                message: |-
                  üì¢ **Load CCB Deployment Notification**

                  Load deployment has been triggered and completed.

                  ---

                  üõ†Ô∏è **Application**: ${app_name} - ${Release_Version}
                  üì¶ **Build Version**: ${build_version}
                  üîÅ **Environment**: Load

                  üìù **Change Request ID**: [${qa_new_crq_number}](https://disney.service-now.com/change_request.do?sys_id=${qa_new_sys_id})
                  üìÑ **Change Summary**: ${business_justification}

                  üìÑ **Load CCB Change Task**: ${load_ccb_new_deploy_ctask_number}
                  üìÖ **Scheduled Date**: ${qa_new_start_date} - ${qa_new_end_date}


                  ---

                  ‚úÖ Please validate the deployment.

                  ---

                  Thank you,
                  **PCP Release Bot ü§ñ**

                  ---
                precondition: "${createNewQaCtasks} or ${createNewQaunplannedCtasks}"
                variableMapping:
                  pythonScript.server: "${teams_channel_ref}"
          - name: SmartSheet Update CCB Version
            type: xlrelease.ScriptTask
            script: |-
              from java.net import URL
              from java.io import BufferedReader, InputStreamReader, DataOutputStream
              from java.text import SimpleDateFormat, ParseException
              from java.util import Locale, TimeZone, Date
              import com.xhaus.jyson.JysonCodec as json

              # --- Configuration & Inputs
              smartsheet_token = "Bearer " + releaseVariables['smart_api_token']
              sheet_id = releaseVariables['smartsheet_sheet_id']

              month_year_col_name      = "Project/Studio"
              task_desc_col_name       = "Task Description"
              release_version_col_name = "Release Version Link"
              added_by_col_name        = "Added By"
              date_col_name            = "Date"
              completed_row_value      = "COMPLETED"

              release_type_col_name = "Type of Release"
              brand_col_name        = "Brand"
              brand_value           = releaseVariables['select_brand']

              app_name      = releaseVariables['app_name']
              build_version = releaseVariables['build_version']
              added_by      = releaseVariables['bot']

              due_date_obj = release.dueDate
              if not due_date_obj:
                  raise Exception("Release dueDate is not set.")

              month_year_format = SimpleDateFormat("MMMM yyyy", Locale.US)
              date_format       = SimpleDateFormat("MM/dd/yy")
              iso_format        = SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss'Z'")
              iso_format.setTimeZone(TimeZone.getTimeZone("UTC"))

              due_date_obj_iso = iso_format.format(due_date_obj)
              month_year_str   = month_year_format.format(due_date_obj)
              due_date_str     = date_format.format(due_date_obj)

              def smartsheet_api(url, method="GET", payload=None):
                  try:
                      conn = URL(url).openConnection()
                      conn.setRequestMethod(method)
                      conn.setRequestProperty("Authorization", smartsheet_token)
                      conn.setRequestProperty("Content-Type", "application/json")
                      if payload is not None:
                          conn.setDoOutput(True)
                          wr = DataOutputStream(conn.getOutputStream())
                          wr.writeBytes(payload)
                          wr.flush()
                          wr.close()
                      if conn.getResponseCode() >= 400:
                          err_stream = conn.getErrorStream()
                          reader = BufferedReader(InputStreamReader(err_stream))
                          err_msg = ""
                          line = reader.readLine()
                          while line:
                              err_msg += line
                              line = reader.readLine()
                          reader.close()
                          raise Exception("HTTP Error %s: %s" % (conn.getResponseCode(), err_msg))
                      in_stream = conn.getInputStream()
                      reader = BufferedReader(InputStreamReader(in_stream))
                      result = ""
                      line = reader.readLine()
                      while line:
                          result += line
                          line = reader.readLine()
                      reader.close()
                      return result
                  except Exception as e:
                      print("API call failed: %s" % e)
                      raise

              sheet_url  = "https://api.smartsheet.com/2.0/sheets/%s" % sheet_id
              update_url = "https://api.smartsheet.com/2.0/sheets/%s/rows" % sheet_id

              sheet_json = json.loads(smartsheet_api(sheet_url))
              columns    = sheet_json['columns']
              rows       = sheet_json['rows']

              # Map column title -> id and id -> title
              col_map     = {c['title']: c['id'] for c in columns}
              id_to_title = {c['id']: c['title'] for c in columns}

              for col in [month_year_col_name, task_desc_col_name, release_version_col_name,
                          added_by_col_name, date_col_name, release_type_col_name, brand_col_name]:
                  if col not in col_map:
                      raise Exception("Column '%s' not found in sheet." % col)

              month_year_col_id      = col_map[month_year_col_name]
              task_desc_col_id       = col_map[task_desc_col_name]
              release_version_col_id = col_map[release_version_col_name]
              added_by_col_id        = col_map[added_by_col_name]
              date_col_id            = col_map[date_col_name]
              release_type_col_id    = col_map[release_type_col_name]
              brand_col_id           = col_map[brand_col_name]

              # Date parsers
              iso_with_ms_z = SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss.SSS'Z'")
              iso_with_ms_z.setTimeZone(TimeZone.getTimeZone("UTC"))
              iso_with_z = SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss'Z'")
              iso_with_z.setTimeZone(TimeZone.getTimeZone("UTC"))
              iso_date_only = SimpleDateFormat("yyyy-MM-dd")
              parsers = [iso_with_ms_z, iso_with_z, iso_date_only, date_format]

              def robust_parse_date(date_val):
                  if isinstance(date_val, Date):
                      return date_val
                  s = str(date_val).strip()
                  for parser in parsers:
                      try:
                          return parser.parse(s)
                      except:
                          pass
                  return None

              def print_full_row(row):
                  print("  --- Full row dump (rowId=%s) ---" % row.get('id'))
                  for cell in row.get('cells', []):
                      col_id    = cell.get('columnId')
                      col_title = id_to_title.get(col_id, "UNKNOWN_COLUMN_%s" % col_id)
                      if 'displayValue' in cell and cell['displayValue'] is not None:
                          val = cell['displayValue']
                      else:
                          val = cell.get('value')
                      print("    %s: %s" % (col_title, val))
                  print("  --- End of row dump ---")

              # Find Month YYYY parent rows
              month_year_rows = []
              for row in rows:
                  for cell in row.get('cells', []):
                      if cell['columnId'] == month_year_col_id:
                          val = str(cell.get('value', '')).strip()
                          if val.upper() == completed_row_value:
                              break
                          if val == month_year_str:
                              month_year_rows.append(row)
                          break

              if not month_year_rows:
                  print("No matching Month YYYY rows found for '%s'." % month_year_str)

              any_match_found = False

              for parent_row in month_year_rows:
                  parent_row_id = parent_row['id']
                  print("\nFound Month YYYY row: ID=%s" % parent_row_id)

                  # Gather children
                  child_rows = []
                  for row in rows:
                      if row.get('parentId') == parent_row_id:
                          skip = False
                          for cell in row.get('cells', []):
                              if cell['columnId'] == month_year_col_id:
                                  if str(cell.get('value', '')).strip().upper() == completed_row_value:
                                      skip = True
                                      break
                          if not skip:
                              child_rows.append(row)

                  # Match by App + Date ONLY
                  matched_row = None
                  for child_row in child_rows:
                      tdesc_val        = None
                      due_date_val_str = None
                      for cell in child_row.get('cells', []):
                          if cell['columnId'] == task_desc_col_id:
                              tdesc_val = cell.get('value')
                          elif cell['columnId'] == date_col_id:
                              val = cell.get('value')
                              parsed_date = robust_parse_date(val)
                              if parsed_date:
                                  due_date_val_str = date_format.format(parsed_date)
                      if tdesc_val == app_name and due_date_val_str == due_date_str:
                          matched_row = child_row
                          break

                  if matched_row:
                      any_match_found = True
                      row_id = matched_row['id']
                      print("  MATCH FOUND for App=%s, Date=%s at row ID=%s"
                            % (app_name, due_date_str, row_id))
                      print_full_row(matched_row)

                      # Detect if Release Version cell has a hyperlink
                      has_link = False
                      for cell in matched_row.get('cells', []):
                          if cell.get('columnId') == release_version_col_id:
                              obj_val = cell.get('objectValue')
                              if obj_val and obj_val.get('link'):
                                  has_link = True
                              break

                      # For hyperlinks, just set value/display text; URL remains
                      # For plain text, value is set normally
                      update_cells = [
                          {
                              "columnId": release_version_col_id,
                              "value": build_version
                          }
                      ]

                      update_payload = [{
                          "id": row_id,
                          "cells": update_cells
                      }]
                      result = smartsheet_api(update_url, "PUT", json.dumps(update_payload))
                      print("  ‚úÖ Updated Release Version Link display text to '%s' for row ID %s. API Response: %s"
                            % (build_version, row_id, result))
                  else:
                      print("  No matching child row (App=%s, Date=%s) found under Month YYYY row ID=%s."
                            % (app_name, due_date_str, parent_row_id))

              if not any_match_found:
                  msg = ("No matching child row found for App=%s, Date=%s under any '%s' Month YYYY row. Failing task."
                         % (app_name, due_date_str, month_year_str))
                  print(msg)
                  raise Exception(msg)

              print("\nScript finished successfully (at least one match found and Release Version Link text updated).")
          - name: Smart Sheet Update with New QA Chg
            type: xlrelease.ScriptTask
            precondition: "${createNewQaChange}"
            script: |-
              from java.net import URL
              from java.io import BufferedReader, InputStreamReader, DataOutputStream
              from java.text import SimpleDateFormat, ParseException
              from java.util import Locale, TimeZone, Date
              import com.xhaus.jyson.JysonCodec as json

              # --- Configuration & Inputs
              smartsheet_token = "Bearer " + releaseVariables['smart_api_token']
              sheet_id = releaseVariables['smartsheet_sheet_id']

              month_year_col_name = "Project/Studio"
              task_desc_col_name = "Task Description"
              release_version_col_name = "Release Version Link"
              added_by_col_name = "Added By"
              date_col_name = "Date"
              completed_row_value = "COMPLETED"

              release_type_col_name = "Type of Release"
              brand_col_name = "Brand"
              brand_value = releaseVariables['select_brand']

              # --- Dynamic Update Column from releaseVariables
              update_col_name  = releaseVariables.get('target_new_qa_column', None)
              update_value_new = releaseVariables.get('qa_new_crq_number', None)

              app_name      = releaseVariables['app_name']
              build_version = releaseVariables['build_version']
              added_by      = releaseVariables['bot']

              due_date_obj = release.dueDate
              if not due_date_obj:
                  raise Exception("Release dueDate is not set.")

              month_year_format = SimpleDateFormat("MMMM yyyy", Locale.US)
              date_format       = SimpleDateFormat("MM/dd/yy")
              iso_format        = SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss'Z'")
              iso_format.setTimeZone(TimeZone.getTimeZone("UTC"))
              due_date_obj_iso = iso_format.format(due_date_obj)
              month_year_str   = month_year_format.format(due_date_obj)
              due_date_str     = date_format.format(due_date_obj)

              def smartsheet_api(url, method="GET", payload=None):
                  try:
                      conn = URL(url).openConnection()
                      conn.setRequestMethod(method)
                      conn.setRequestProperty("Authorization", smartsheet_token)
                      conn.setRequestProperty("Content-Type", "application/json")
                      if payload is not None:
                          conn.setDoOutput(True)
                          wr = DataOutputStream(conn.getOutputStream())
                          wr.writeBytes(payload)
                          wr.flush()
                          wr.close()
                      if conn.getResponseCode() >= 400:
                          err_stream = conn.getErrorStream()
                          reader = BufferedReader(InputStreamReader(err_stream))
                          err_msg = ""
                          line = reader.readLine()
                          while line:
                              err_msg += line
                              line = reader.readLine()
                          reader.close()
                          raise Exception("HTTP Error %s: %s" % (conn.getResponseCode(), err_msg))
                      in_stream = conn.getInputStream()
                      reader = BufferedReader(InputStreamReader(in_stream))
                      result = ""
                      line = reader.readLine()
                      while line:
                          result += line
                          line = reader.readLine()
                      reader.close()
                      return result
                  except Exception as e:
                      print("API call failed: %s" % e)
                      raise

              sheet_url  = "https://api.smartsheet.com/2.0/sheets/%s" % sheet_id
              update_url = "https://api.smartsheet.com/2.0/sheets/%s/rows" % sheet_id

              sheet_json = json.loads(smartsheet_api(sheet_url))
              columns    = sheet_json['columns']
              rows       = sheet_json['rows']

              # Map column title -> id and id -> title
              col_map     = {c['title']: c['id'] for c in columns}
              id_to_title = {c['id']: c['title'] for c in columns}

              for col in [month_year_col_name, task_desc_col_name, release_version_col_name,
                          added_by_col_name, date_col_name, release_type_col_name, brand_col_name]:
                  if col not in col_map:
                      raise Exception("Column '%s' not found in sheet." % col)

              # --- Dynamic QA column check
              if not update_col_name or update_col_name not in col_map:
                  raise Exception("Required dynamic column ('%s') not found in sheet." % update_col_name)

              month_year_col_id      = col_map[month_year_col_name]
              task_desc_col_id       = col_map[task_desc_col_name]
              release_version_col_id = col_map[release_version_col_name]
              added_by_col_id        = col_map[added_by_col_name]
              date_col_id            = col_map[date_col_name]
              release_type_col_id    = col_map[release_type_col_name]
              brand_col_id           = col_map[brand_col_name]
              update_col_id          = col_map[update_col_name]

              # Date parsers
              iso_with_ms_z = SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss.SSS'Z'")
              iso_with_ms_z.setTimeZone(TimeZone.getTimeZone("UTC"))
              iso_with_z = SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss'Z'")
              iso_with_z.setTimeZone(TimeZone.getTimeZone("UTC"))
              iso_date_only = SimpleDateFormat("yyyy-MM-dd")
              parsers = [iso_with_ms_z, iso_with_z, iso_date_only, date_format]

              def robust_parse_date(date_val):
                  if isinstance(date_val, Date):
                      return date_val
                  s = str(date_val).strip()
                  for parser in parsers:
                      try:
                          return parser.parse(s)
                      except:
                          pass
                  return None

              def print_full_row(row):
                  print("  --- Full row dump (rowId=%s) ---" % row.get('id'))
                  for cell in row.get('cells', []):
                      col_id    = cell.get('columnId')
                      col_title = id_to_title.get(col_id, "UNKNOWN_COLUMN_%s" % col_id)
                      if 'displayValue' in cell and cell['displayValue'] is not None:
                          val = cell['displayValue']
                      else:
                          val = cell.get('value')
                      print("    %s: %s" % (col_title, val))
                  print("  --- End of row dump ---")

              # Search for Month YYYY in all rows (skip COMPLETED)
              month_year_rows = []
              for row in rows:
                  for cell in row.get('cells', []):
                      if cell['columnId'] == month_year_col_id:
                          val = str(cell.get('value', '')).strip()
                          if val.upper() == completed_row_value:
                              break
                          if val == month_year_str:
                              month_year_rows.append(row)
                          break

              if not month_year_rows:
                  print("No matching Month YYYY rows found for '%s'." % month_year_str)

              any_match_found = False

              for parent_row in month_year_rows:
                  parent_row_id = parent_row['id']
                  print("\nFound Month YYYY row: ID=%s" % parent_row_id)

                  # Gather children, skip COMPLETED
                  child_rows = []
                  for row in rows:
                      if row.get('parentId') == parent_row_id:
                          skip = False
                          for cell in row.get('cells', []):
                              if cell['columnId'] == month_year_col_id:
                                  if str(cell.get('value', '')).strip().upper() == completed_row_value:
                                      skip = True
                                      break
                          if not skip:
                              child_rows.append(row)

                  # Check for matching child by App/Build/Date
                  matched_row = None
                  for child_row in child_rows:
                      tdesc_val        = None
                      rver_val         = None
                      due_date_val_str = None
                      for cell in child_row.get('cells', []):
                          if cell['columnId'] == task_desc_col_id:
                              tdesc_val = cell.get('value')
                          elif cell['columnId'] == release_version_col_id:
                              rver_val = cell.get('value')
                          elif cell['columnId'] == date_col_id:
                              val = cell.get('value')
                              parsed_date = robust_parse_date(val)
                              if parsed_date:
                                  due_date_val_str = date_format.format(parsed_date)
                      if tdesc_val == app_name and rver_val == build_version and due_date_val_str == due_date_str:
                          matched_row = child_row
                          break

                  if matched_row:
                      any_match_found = True
                      row_id = matched_row['id']
                      print("  MATCH FOUND for App=%s, Build=%s, Date=%s at row ID=%s"
                            % (app_name, build_version, due_date_str, row_id))

                      print_full_row(matched_row)

                      # Get existing value in the dynamic QA column
                      existing_val = ''
                      for cell in matched_row.get('cells', []):
                          if cell.get('columnId') == update_col_id:
                              if 'displayValue' in cell and cell['displayValue'] is not None:
                                  existing_val = str(cell['displayValue'])
                              else:
                                  existing_val = str(cell.get('value') or '')
                              break

                      # Append new value (e.g. "old; new") ‚Äì adjust separator as needed
                      if existing_val.strip():
                          new_val = existing_val + '; ' + str(update_value_new)
                      else:
                          new_val = str(update_value_new)

                      update_cells = [
                          {"columnId": update_col_id, "value": new_val}
                      ]
                      update_payload = [{
                          "id": row_id,
                          "cells": update_cells
                      }]
                      result = smartsheet_api(update_url, "PUT", json.dumps(update_payload))
                      print("  ‚úÖ Appended '%s' to column '%s' for child row ID %s. API Response: %s"
                            % (update_value_new, update_col_name, row_id, result))
                  else:
                      print("  No matching child row (App=%s, Build=%s, Date=%s) found under Month YYYY row ID=%s."
                            % (app_name, build_version, due_date_str, parent_row_id))

              # If nothing matched anywhere, fail the task
              if not any_match_found:
                  msg = ("No matching child row found for App=%s, Build=%s, Date=%s under any '%s' "
                         "Month YYYY row. Failing task."
                         % (app_name, build_version, due_date_str, month_year_str))
                  print(msg)
                  raise Exception(msg)

              print("\nScript finished successfully (at least one match found, printed, and updated).")
          - name: Do You Want To Restart CCB Phase
            type: xlrelease.UserInputTask
            description: Please enter the required information below.
            variables:
            - restart_ccb
          - name: Restart CCB Phase?
            type: xlrelease.ScriptTask
            precondition: "${restart_ccb}"
            script: |-
              from com.xebialabs.xlrelease.repository import PhaseVersion
              ccbPhase = phaseApi.searchPhasesByTitle('CCB', release.id)
              print (ccbPhase)
              phaseName= ccbPhase[-1]
              print (phaseName)
              releaseApi.restartPhase(getCurrentRelease(), phaseName, PhaseVersion.LATEST)
        - name: CCB
          type: delivery.MarkTrackedItems
          stage: CCB Phase & QE SignOff
          delivery: "${delivery_id}"
          pattern: Cynthia/PCP Release
          flagStatus: ATTENTION_NEEDED
          flagComment: "Task 'CCB' in Phase 'CCB' has properties that do not match\
            \ with the known type. Following properties do not match: [configurationUri]."
          variableMapping:
            pythonScript.trackedItems: "${application}"
      - name: Do you need Adhoc CTASKS ?
        type: xlrelease.SequentialGroup
        tasks:
        - name: Do you need AdHoc Ctasks ?
          type: xlrelease.UserInputTask
          description: Please enter the required information below.
          owner: admin
        - name: Adhoc
          type: xlrelease.SequentialGroup
          precondition: "${adhoc_ctask}"
          tasks:
          - name: Compare Date
            type: xlrelease.ScriptTask
            script: |-
              from java.text import SimpleDateFormat
              from java.util import Date, TimeZone

              # Inputs
              qa_end_date_str     = releaseVariables.get('qa_end_date')
              qa_new_end_date_str = releaseVariables.get('qa_new_end_date')
              pattern             = "yyyy-MM-dd"

              if qa_end_date_str is None or qa_end_date_str.strip() == "":
                  raise Exception("qa_end_date release variable is not set or empty")

              sdf = SimpleDateFormat(pattern)
              sdf.setTimeZone(TimeZone.getDefault())

              qa_end_date     = sdf.parse(qa_end_date_str)
              qa_new_end_date = None
              if qa_new_end_date_str and qa_new_end_date_str.strip() != "":
                  try:
                      qa_new_end_date = sdf.parse(qa_new_end_date_str)
                  except Exception, e:
                      pass

              current_date = Date()

              print("Original qa_end_date: %s" % sdf.format(qa_end_date))
              print("New qa_end_date    : %s" % (sdf.format(qa_new_end_date) if qa_new_end_date else "None"))
              print("Current date       : %s" % sdf.format(current_date))

              # Reset ALL flags to False first
              flags = ['createNewQaChange', 'createNewQaCtasks', 'createoldQaCtasks', 'createNewQaunplannedCtasks']
              for flag in flags:
                  releaseVariables[flag] = False

              # **STATE 1: FIRST RUN** (no qa_new_end_date OR empty string)
              if qa_new_end_date is None:
                  if current_date.compareTo(qa_end_date) <= 0:
                      # Date valid ‚Üí OLD CR unplanned tasks only
                      releaseVariables['createoldQaCtasks'] = True
                      print("FIRST RUN: qa_end_date valid ‚Üí createoldQaCtasks=True")
                  else:
                      # Date expired ‚Üí NEW CR + implementation tasks
                      releaseVariables['createNewQaChange'] = True
                      releaseVariables['createNewQaCtasks'] = True
                      print("FIRST RUN: qa_end_date expired ‚Üí createNewQaChange=True, createNewQaCtasks=True")

              # **STATE 2+: LATER RUNS** (qa_new_end_date exists AND has valid date)
              else:
                  if current_date.compareTo(qa_new_end_date) > 0:
                      # Newest date expired ‚Üí create NEWEST CR
                      releaseVariables['createNewQaChange'] = True
                      releaseVariables['createNewQaCtasks'] = True
                      print("LATER RUN: qa_new_end_date expired ‚Üí createNewQaChange=True, createNewQaCtasks=True")
                  else:
                      # Newest date valid ‚Üí NEW CR unplanned tasks only
                      releaseVariables['createNewQaunplannedCtasks'] = True
                      print("LATER RUN: qa_new_end_date valid ‚Üí createNewQaunplannedCtasks=True")
          - name: Create New QA Change
            type: xlrelease.SequentialGroup
            precondition: "${createNewQaChange}"
            tasks:
            - name: Set CRQ Variables
              type: xlrelease.ScriptTask
              owner: manoj.kumar.x.bijjala.-nd@disney.com
              script: |-
                from java.time import LocalDate

                qa_start_date = LocalDate.now()
                qa_end_date = qa_start_date.plusDays(60)

                releaseVariables['qa_new_start_date'] = qa_start_date
                releaseVariables['qa_new_end_date'] = qa_end_date
            - name: Find Stage CI SysID
              type: servicenow.FindCIByName
              servicenowServer: Disney Prod
              tableName: cmdb_ci_service_discovered
              ciName: "${app_name} - AWS Staging"
              variableMapping:
                pythonScript.sysId: "${stage_sys_id}"
            - name: Find Load SysID
              type: servicenow.FindCIByName
              servicenowServer: Disney Prod
              tableName: cmdb_ci_service_discovered
              ciName: "${app_name} - AWS Load Test"
              variableMapping:
                pythonScript.sysId: "${load_sys_id}"
            - name: Create QA CRQ
              type: servicenow.CreateChangeRequest
              servicenowServer: Disney Prod
              shortDescription: "QA - [AWS Docker Application] - For Independent Release\
                \ - ${Release_Version} for ${app_name}"
              ^description: |-
                ******************************************************************************************************************
                Application Name: ${app_name}
                BAPP ID: ${app_bappid}
                GitHub Link: https://github.disney.com/${app_gitorg}/${app_gitrepo}
                Harness Link:  ${app_harness_base_url}
                Rundeck Link: ${app_rundeck_nonprodjob}
                ******************************************************************************************************************

                1. Description of change including business driver/justification.  [Please provide detailed information to process this CR]
                Answer:
                Business Justification: ${business_justification}

                JIRA Tickets:
                ${JiraTicketDetails2}

                2. What is the business  impact/ risk to Disney if this work is not performed?
                Answer: ${business_impact}

                3. What are the user groups affected by this change? (with one of the following Guest/Cast/Both/None). (If None, please explain.)
                Answer: Guest/Cast {Both}

                4. Provide all PR details for this particular release [Release will not be considered if any of the PR is missed in the point below].
                Answer:
                ${pullRequestUrlsOnly}

                5. Was this Release tested in Latest before promoting to Stage & Load? Provide evidence.
                Answer.  ${Latest Test Results}

                6. What is the importance of this release [High/Medium/Low] ?
                Answer: Medium

                ******** CHECK THE CONFLICTS TAB TO SEE IF YOUR CHANGE HAS A CONFLICT PERTAINING TO A WDPR OPERATIONAL BLACKOUT. IF IT DOES THEN PLEASE ANSWER THE APPROPRIATE QUESTIONS BELOW IN ORDER TO RECEIVE REQUIRED APPROVALS******** (FOR PRODUCTION CHANGES ONLY)

                1. Provide Business Justification for implementing this change during the identified Blackout.
                Answer: ${blackout_scope}

                2. Provide a detailed description of any potential impact to the business if the change is not implemented during the identified Blackout.
                Answer: ${blackout_scope}

                3. Describe potential impact to any Financial Production Systems (ex: Financial Interfaces, Payment Process Systems and any impact to systems or services related to Media)
                Answer: ${blackout_scope}
              ciSysId: "${stage_sys_id}"
              assignmentGroup: "${chg_ctaskassignment_group}"
              assignedTo: Mosisin Anwar Mohammed
              state: Draft
              additionalFields:
                end_date: "${qa_new_end_date}"
                start_date: "${qa_new_start_date}"
                requested_by: "${tech_lead}"
                test_plan: "1. Latest Env Validated as expected by App Team.\n2. Once\
                  \ deployment done in STAGE/LOAD, GQE in STAGE and PE in LOAD will\
                  \ validate.\n3. Sustainment will monitor and analyze if any issue\
                  \ occurs   "
                category: Business Application
                u_peer_approval_group: "${chg_peerapproval_group}"
                change_plan: "***NOTHING ON THIS TEMPLATE IS TO BE DELETED***\nTechnical\
                  \ details provided here explain how to implement this change. The\
                  \ intent of information captured within the change plan should be\
                  \ sufficient for any operation or engineer to pick up & implement\
                  \ ‚Äì specifically calling out all steps, scripts + versions, files,\
                  \ commands, etc. Step by step. Include script names, etc. Information\
                  \ may also be referred to and included the Implementation task.\n\
                  \n***Please DO NOT provide a link to the technical details.*** \
                  \ \n\nStep 1: IR Team will deploy in STAGE environment\nStep 2:\
                  \ IR Team will deploy in LOAD environment\nStep 3: Validation by\
                  \ Studio Kylo [SDET Validation] in STAGE environment\nStep 4: Validation\
                  \ by Application Lead\nStep 5: Sustainment Team Studio Vision Validation\n\
                  Step 6: GQE Certification  \nStep 7: PE Certification [Performance\
                  \ Engineering Team]  \n\n"
                u_subcategory: "${chg_subcategory}"
                backout_plan: "If any deployments are failed or app is not stable,\
                  \ will rollback to the successful running version.  "
                u_template: "${chg_template}"
              variableMapping:
                pythonScript.sysId: "${qa_new_sys_id}"
                pythonScript.Ticket: "${qa_new_crq_number}"
            - name: New QA CHG Adhoc Ctasks copy
              type: xlrelease.SequentialGroup
              precondition: "${createNewQaCtasks}"
              tasks:
              - name: Create Stage AdHoc CTask
                type: servicenow.CreateChangeTask
                servicenowServer: Disney Prod
                shortDescription: "IR - QA - Independent Release - ${app_name} ${Release_Version}\
                  \ - STAGE - ${ctask_purpose}"
                ^description: |-
                  Application Name: ${app_name}
                  BAPP ID: ${app_bappid}

                  IR - QA - Independent Release - ${app_name} ${Release_Version}-${build_version}
                  ==========================================================
                  ${ctask_purpose_info}
                  ====================================================================
                ciSysId: "${stage_sys_id}"
                assignmentGroup: "${ctask_assignmentgroup}"
                additionalFields:
                  work_end: "${qa_new_end_date}"
                  u_type: implementation
                  work_start: "${qa_new_start_date}"
                changeRequest: "${qa_new_sys_id}"
                variableMapping:
                  pythonScript.Ticket: "${stage_new_adhoc_ctask_number}"
                  pythonScript.data: "${stage_adhoc_ctask_data}"
                  pythonScript.sysId: "${stage_new_adhoc_ctask_sys_id}"
              - name: Create Load AdHoc CTask
                type: servicenow.CreateChangeTask
                servicenowServer: Disney Prod
                shortDescription: "IR - QA - Independent Release - ${app_name} ${Release_Version}\
                  \ - LOAD - ${ctask_purpose}"
                ^description: |-
                  Application Name: ${app_name}
                  BAPP ID: ${app_bappid}

                  IR - QA - Independent Release - ${app_name} ${Release_Version}-${build_version}
                  ==========================================================
                  ${ctask_purpose_info}
                  ====================================================================
                ciSysId: "${load_sys_id}"
                assignmentGroup: "${ctask_assignmentgroup}"
                additionalFields:
                  work_end: "${qa_new_end_date}"
                  u_type: implementation
                  work_start: "${qa_new_start_date}"
                changeRequest: "${qa_new_sys_id}"
                variableMapping:
                  pythonScript.Ticket: "${load_new_adhoc_ctask_number}"
                  pythonScript.data: "${load_new_adhoc_ctask_data}"
                  pythonScript.sysId: "${load_new_adhoc_ctask_sys_id}"
              - name: QA  Adhoc ctask Notification
                type: msteams.Notification
                channel: "#${channel_name}"
                message: |-
                  üì¢ **Release QA Change Adhoc Change Task Creation Notification**

                  ---

                  üõ†Ô∏è **Application**: ${app_name} - ${Release_Version}
                  üì¶ **Build Version**: ${build_version}
                  üîÅ **Environment**: Stage  & Load

                  üìù **Change Request ID**: [${qa_new_crq_number}](https://disney.service-now.com/change_request.do?sys_id=${qa_new_sys_id})
                  üìÑ **Change Request URL**: https://disney.service-now.com/change_request.do?sys_id=${qa_new_sys_id}
                  üìÑ **Change Summary**: ${business_justification}
                  üìÑ **Stage Adhoc Ctask**: ${stage_new_adhoc_ctask_number}
                  üìÑ **Load Adhoc Ctask**: ${load_new_adhoc_ctask_number}


                  üìÖ **Scheduled Start Date**: ${qa_new_start_date}
                  üìÖ **Scheduled End Date**: ${qa_new_end_date}

                  ‚úÖ Please validate the change tasks.

                  ---

                  Thank you,
                  **PCP  Release Bot ü§ñ**

                  ---
                owner: admin
                variableMapping:
                  pythonScript.server: "${teams_channel_ref}"
            - name: Create Sustainment Team Validation CTask
              type: servicenow.CreateChangeTask
              servicenowServer: Disney Prod
              shortDescription: "QA - Independent Release - ${app_name} ${Release_Version}\
                \ - Sustainment Team Validation"
              ^description: |-
                Sustainment Team Validation for ${app_name}-${build_version}

                -  Delivery/Sustainment team to check the status endpoints to ensure correct version deployed in load
                - Delivery/Sustainment team to check that ec2 instances have come up and stabilized running correct version
                - Delivery/Sustainment - Delivery/Sustainment to check proper version of code was deployed
                - Delivery/Sustainmnet will run standard smoke tests that we execute after deployment. The smoke tests invoke endpoints and test the systems functionality after application is deployed. Additionally our smoke tests run on a schedule. Additionally will perform necessary post deploy validation coverage which allows us to to detect any issues (ART, Error rate increase, Eventing failures) soon after each deployment
              ciSysId: "${load_sys_id}"
              assignmentGroup: "${chg_ctaskassignment_group}"
              assignedTo: "${tech_lead}"
              additionalFields:
                u_type: validation
                work_end: "${qa_new_end_date}"
                state: Draft
                work_start: "${qa_new_start_date}"
              changeRequest: "${qa_new_sys_id}"
              precondition: "${createNewQaCtasks}"
              variableMapping:
                pythonScript.sysId: "${loadvalidation_new_ctask_sys_id}"
                pythonScript.Ticket: "${loadvalidation_new_ctask_number}"
            - name: QA CHG Notification
              type: msteams.Notification
              channel: "${channel_name}"
              message: |-
                üì¢ **Release QA Change Creation for Adhoc Tasks Notification**

                ---

                üõ†Ô∏è **Application**: ${app_name} - ${Release_Version}

                üì¶ **Build Version**: ${build_version}

                üîÅ **Environment**: Stage  & Load

                üìù **Change Request ID**: [${qa_new_crq_number}](https://disney.service-now.com/change_request.do?sys_id=${qa_new_sys_id})
                üìÑ **Change Request URL**: https://disney.service-now.com/change_request.do?sys_id=${qa_new_sys_id}
                üìÑ **Change Summary**: ${business_justification}

                üìÖ **Scheduled Start Date**: ${qa_new_start_date}
                üìÖ **Scheduled End Date**: ${qa_new_end_date}

                ‚úÖ Please validate the change and Push for Peer Approval.

                ---

                Thank you,
                **PCP  Release Bot ü§ñ**

                ---
              variableMapping:
                pythonScript.server: "${teams_channel_ref}"
            - name: Manual QA CHG Efforts
              type: xlrelease.SequentialGroup
              tasks:
              - name: "CRQ ${qa_crq_number} Pending Peer Approval ?"
                type: servicenow.PollingCheckStatus
                servicenowServer: Disney Prod
                sysId: "${qa_new_sys_id}"
                statusField: approval
                checkForStatus: Pending Peer Approval
              - name: "Approve  ${qa_crq_number}"
                type: msteams.Notification
                server: Peer Approval
                channel: "#DigitalPeerApproval"
                message: |-
                  @${service_owner}

                  üì¢ **Release QA Change Peer Approval Notification**


                  ---

                  üõ†Ô∏è **Application**: ${app_name} - ${Release_Version}

                  üîÅ **Environment**: Stage  & Load

                  üìù **Change Request ID**: [${qa_new_crq_number}](https://disney.service-now.com/change_request.do?sys_id=${qa_new_sys_id})
                  üìÑ **Change Request URL**: https://disney.service-now.com/change_request.do?sys_id=${qa_new_sys_id}
                  üìÑ **Change Summary**: ${business_justification}

                  üìÖ **Scheduled Start Date**: ${qa_new_start_date}
                  üìÖ **Scheduled End Date**: ${qa_new_end_date}


                  ‚úÖ Please Peer Review the change and Approve.

                  ---

                  Thank you,
                  **PCP Release Bot ü§ñ**

                  ---
                owner: admin
              - name: "CRQ ${qa_crq_number} Approved ?"
                type: servicenow.PollingCheckStatus
                servicenowServer: Disney Prod
                sysId: "${qa_new_sys_id}"
                statusField: approval
                checkForStatus: Approved
              - name: QA CHG Notification
                type: msteams.Notification
                channel: "${channel_name}"
                message: |-
                  üì¢ **Release QA Change Approval Notification For Adhoc Tasks**

                  ---

                  üõ†Ô∏è **Application**: ${app_name} - ${Release_Version}

                  üì¶ **Build Version**: ${build_version}
                  üîÅ **Environment**: Stage  & Load

                  üìù **Change Request ID**: [${qa_new_crq_number}](https://disney.service-now.com/change_request.do?sys_id=${qa_new_sys_id})
                  üìÑ **Change Summary**: ${ctask_purpose}

                  üìÖ **Scheduled Start Date**: ${qa_new_start_date}
                  üìÖ **Scheduled End Date**: ${qa_new_end_date}

                  ‚úÖ QA Change is Approved.

                  ---

                  Thank you,
                  **PCP Release Bot ü§ñ**

                  ---
                owner: admin
                variableMapping:
                  pythonScript.server: "${teams_channel_ref}"
              - name: Relate QA New Change WIth PROD CHANGE
                type: servicenow.RelateItem
                servicenowServer: Disney Prod
                tableName: task_rel_task
                parentSysId: "${prod_crq_sys_id}"
                childSysId: "${qa_new_sys_id}"
                typeSysId: d80d5ec20a25810200be8bc5e2f64710
          - name: Adhoc Ctasks
            type: xlrelease.ParallelGroup
            tasks:
            - name: Old QA CHG Adhoc Ctasks
              type: xlrelease.SequentialGroup
              precondition: "${createoldQaCtasks}"
              tasks:
              - name: Create Stage AdHoc CTask
                type: servicenow.CreateChangeTask
                servicenowServer: Disney Prod
                shortDescription: "IR - QA - Independent Release - ${app_name} ${Release_Version}\
                  \ - STAGE - ${ctask_purpose}"
                ^description: |-
                  Application Name: ${app_name}
                  BAPP ID: ${app_bappid}

                  IR - QA - Independent Release - ${app_name} ${Release_Version}-${build_version}
                  ==========================================================
                  ${ctask_purpose_info}
                  ====================================================================
                ciSysId: "${app_name} - AWS Staging"
                assignmentGroup: "${ctask_assignmentgroup}"
                additionalFields:
                  u_type: unplanned
                  work_end: "${qa_end_date}"
                  work_start: "${qa_start_date}"
                changeRequest: "${qa_sys_id}"
                variableMapping:
                  pythonScript.data: "${stage_adhoc_ctask_data}"
                  pythonScript.Ticket: "${stage_adhoc_ctask_number}"
                  pythonScript.sysId: "${stage_adhoc_ctask_sys_id}"
              - name: Create Load AdHoc CTask
                type: servicenow.CreateChangeTask
                servicenowServer: Disney Prod
                shortDescription: "IR - QA - Independent Release - ${app_name} ${Release_Version}\
                  \ - LOAD - ${ctask_purpose}"
                ^description: |-
                  Application Name: ${app_name}
                  BAPP ID: ${app_bappid}

                  IR - QA - Independent Release - ${app_name} ${Release_Version}-${build_version}
                  ==========================================================
                  ${ctask_purpose_info}
                  ====================================================================
                ciSysId: "${app_name} - AWS Load Test"
                assignmentGroup: "${ctask_assignmentgroup}"
                additionalFields:
                  u_type: unplanned
                  work_end: "${qa_end_date}"
                  work_start: "${qa_start_date}"
                changeRequest: "${qa_sys_id}"
                variableMapping:
                  pythonScript.data: "${load_adhoc_ctask_data}"
                  pythonScript.Ticket: "${load_adhoc_ctask_number}"
                  pythonScript.sysId: "${load_adhoc_ctask_sys_id}"
              - name: QA  Adhoc ctask Notification
                type: msteams.Notification
                channel: "#${channel_name}"
                message: |-
                  üì¢ **Release QA Change Adhoc Change Task Creation Notification**

                  ---

                  üõ†Ô∏è **Application**: ${app_name} - ${Release_Version}
                  üì¶ **Build Version**: ${build_version}
                  üîÅ **Environment**: Stage  & Load

                  üìù **Change Request ID**: [${qa_crq_number}](https://disney.service-now.com/change_request.do?sys_id=${qa_sys_id})
                  üìÑ **Change Request URL**: https://disney.service-now.com/change_request.do?sys_id=${qa_sys_id}
                  üìÑ **Change Summary**: ${business_justification}
                  üìÑ **Stage Adhoc Ctask**: ${stage_adhoc_ctask_number}
                  üìÑ **Load Adhoc Ctask**: ${load_adhoc_ctask_number}


                  üìÖ **Scheduled Start Date**: ${qa_start_date}
                  üìÖ **Scheduled End Date**: ${qa_end_date}

                  ‚úÖ Please validate the change change tasks and update.

                  ---

                  Thank you,
                  **PCP  Release Bot ü§ñ**

                  ---
                owner: admin
                variableMapping:
                  pythonScript.server: "${teams_channel_ref}"
            - name: New QA CHG Adhoc Ctasks
              type: xlrelease.SequentialGroup
              precondition: "${createNewQaunplannedCtasks}"
              tasks:
              - name: Create Stage AdHoc CTask
                type: servicenow.CreateChangeTask
                servicenowServer: Disney Prod
                shortDescription: "IR - QA - Independent Release - ${app_name} ${Release_Version}\
                  \ - STAGE - ${ctask_purpose}"
                ^description: |-
                  Application Name: ${app_name}
                  BAPP ID: ${app_bappid}

                  IR - QA - Independent Release - ${app_name} ${Release_Version}-${build_version}
                  ==========================================================
                  ${ctask_purpose_info}
                  ====================================================================
                ciSysId: "${stage_sys_id}"
                assignmentGroup: "${ctask_assignmentgroup}"
                additionalFields:
                  u_type: unplanned
                  work_end: "${qa_new_end_date}"
                  work_start: "${qa_new_start_date}"
                changeRequest: "${qa_new_sys_id}"
                variableMapping:
                  pythonScript.Ticket: "${stage_new_adhoc_ctask_number}"
                  pythonScript.data: "${stage_adhoc_ctask_data}"
                  pythonScript.sysId: "${stage_new_adhoc_ctask_sys_id}"
              - name: Create Load AdHoc CTask
                type: servicenow.CreateChangeTask
                servicenowServer: Disney Prod
                shortDescription: "IR - QA - Independent Release - ${app_name} ${Release_Version}\
                  \ - LOAD - ${ctask_purpose}"
                ^description: |-
                  Application Name: ${app_name}
                  BAPP ID: ${app_bappid}

                  IR - QA - Independent Release - ${app_name} ${Release_Version}-${build_version}
                  ==========================================================
                  ${ctask_purpose_info}
                  ====================================================================
                ciSysId: "${load_sys_id}"
                assignmentGroup: "${ctask_assignmentgroup}"
                additionalFields:
                  u_type: unplanned
                  work_end: "${qa_new_end_date}"
                  work_start: "${qa_new_start_date}"
                changeRequest: "${qa_new_sys_id}"
                variableMapping:
                  pythonScript.Ticket: "${load_new_adhoc_ctask_number}"
                  pythonScript.data: "${load_new_adhoc_ctask_data}"
                  pythonScript.sysId: "${load_new_adhoc_ctask_sys_id}"
              - name: QA  Adhoc ctask Notification
                type: msteams.Notification
                channel: "#${channel_name}"
                message: |-
                  üì¢ **Release QA Change Adhoc Change Task Creation Notification**

                  ---

                  üõ†Ô∏è **Application**: ${app_name} - ${Release_Version}
                  üì¶ **Build Version**: ${build_version}
                  üîÅ **Environment**: Stage  & Load

                  üìù **Change Request ID**: [${qa_new_crq_number}](https://disney.service-now.com/change_request.do?sys_id=${qa_new_sys_id})
                  üìÑ **Change Request URL**: https://disney.service-now.com/change_request.do?sys_id=${qa_new_sys_id}
                  üìÑ **Change Summary**: ${business_justification}
                  üìÑ **Stage Adhoc Ctask**: ${stage_new_adhoc_ctask_number}
                  üìÑ **Load Adhoc Ctask**: ${load_new_adhoc_ctask_number}


                  üìÖ **Scheduled Start Date**: ${qa_new_start_date}
                  üìÖ **Scheduled End Date**: ${qa_new_end_date}

                  ‚úÖ Please validate the change tasks.

                  ---

                  Thank you,
                  **PCP  Release Bot ü§ñ**

                  ---
                owner: admin
                variableMapping:
                  pythonScript.server: "${teams_channel_ref}"
      - name: Outlook Invite Creation
        type: xlrelease.SequentialGroup
        precondition: "${create_invite}"
        tasks:
        - name: Create Invite
          type: xlrelease.UserInputTask
          description: Please enter the required information below.
          owner: admin
          variables:
          - event_start
          - event_end
          - invite_receipients
          - Release_Plan_Url
        - name: Create Calendar Invite
          type: outlook.CreateCalendarEvent
          server: Outlook
          emails: "${invite_receipients}"
          timeStart: "${event_start}"
          timeEnd: "${event_end}"
          subject: "IR | PROD | ${app_name}  |  ${Release_Version}  | ${prod_crq_number}"
          message: |-
            <html>
            <head>
              <style>
                body {
                  font-family: "Segoe UI", Arial, sans-serif;
                  font-size: 14px;
                  color: #333333;
                  line-height: 1.6;
                  margin: 0;
                  padding: 20px;
                  background-color: #f0f4f8; /* very light page background */
                }

                .container {
                  background-color: #ffffff;
                  border: 2px solid #1976d2; /* bold outer blue border */
                  border-radius: 8px;
                  padding: 20px 25px;
                  max-width: 750px;
                  margin: auto;
                }

                h2 {
                  color: #1976d2; /* dark blue */
                  font-size: 15px;
                  margin-top: 25px;
                  margin-bottom: 10px;
                  border-bottom: 2px solid #90caf9; /* light blue underline */
                  padding-bottom: 4px;
                  font-weight: 600;
                }

                p {
                  margin: 10px 0;
                }

                table {
                  border-collapse: collapse;
                  width: 100%;
                  margin-top: 10px;
                }

                th, td {
                  text-align: left;
                  padding: 10px 12px;
                  vertical-align: top;
                  border: 2px solid #1976d2; /* bold blue borders for outer table */
                }

                th {
                  background-color: #bbdefb; /* light blue header for outer table */
                  color: #1976d2;
                  font-weight: 600;
                }

                /* Outer table alternating rows for all except white rows */
                .outer-table tr:nth-child(odd) td:not(.no-bg) {
                  background-color: #e3f2fd; /* very light blue for alternate rows */
                }

                /* Rows that should have no background */
                .no-bg {
                  background-color: #ffffff !important;
                }

                /* Inner table card styling */
                .inner-table {
                  border: 2px solid #43a047; /* bold green border */
                  border-radius: 6px;
                  background-color: #ffffff; /* plain white cells */
                  box-shadow: 2px 2px 6px rgba(0,0,0,0.05);
                  margin-top: 10px;
                  width: 100%;
                }

                .inner-table th {
                  background-color: #a0ff9f; /* light neon green header */
                  color: #2e7d32;
                  border: 2px solid #43a047;
                  text-align: center;
                  font-weight: bold;
                }

                .inner-table td {
                  border: 2px solid #43a047;
                  background-color: #ffffff; /* plain white cells */
                  text-align: center;
                  font-weight: bold;
                }

                a {
                  color: #1976d2;
                  text-decoration: none;
                }

                a:hover {
                  text-decoration: underline;
                }

                hr {
                  border: none;
                  border-top: 2px solid #1976d2; /* bold blue line */
                  margin: 25px 0;
                }

                .footer {
                  font-size: 12px;
                  color: #555555;
                  margin-top: 25px;
                  text-align: center;
                }

                em {
                  color: #333333;
                }
              </style>
            </head>
            <body>
              <div class="container">
                <p>Hello everyone,</p>
                <p>Please find below meeting info to join us for the release of:</p>

                <!-- Outer Table -->
                <table class="outer-table">
                  <tr>
                    <td colspan="2">
                      <!-- Inner Table Card: Application, ServiceNow, Build Version as columns -->
                      <table class="inner-table">
                        <tr>
                          <th>Application</th>
                          <th>Prod Change Request</th>
                          <th>Build Version</th>
                        </tr>
                        <tr>
                          <td>${app_name} ${Release_Version}</td>
                          <td>${prod_crq_number}</td>
                          <td>${build_version}</td>
                        </tr>
                        <!-- Example if you have multiple apps
                            <tr>
                            <td>App 1</td>
                            <td>CRQ12345</td>
                            <td>v1.2.0</td>
                        </tr>
                        <tr>
                            <td>App 2</td>
                            <td>CRQ12346</td>
                            <td>v3.4.1</td>
                        </tr> -->
                      </table>
                    </td>
                  </tr>
                  <!-- disable below table row if there are multiple apps for a invite -->
                  <tr>
                    <th class="no-bg">Snow URL</th>
                    <td class="no-bg">
                      <a href="https://disney.service-now.com/change_request.do?sys_id=${prod_crq_sys_id}">
                        https://disney.service-now.com/change_request.do?sys_id=${prod_crq_sys_id}
                      </a>
                    </td>
                  </tr>
                  <tr>
                    <th class="no-bg">Teams Channel</th>
                    <td class="no-bg">${folder.invite_vision_channel}</td>
                  </tr>
                  <tr>
                    <th class="no-bg">Release Plan</th>
                    <td class="no-bg"><a href="${Release_Plan_Url}">${Release_Plan_Url}</a></td>
                  </tr>
                </table>
                <!-- Meeting Info Section -->
                <h2>Meeting Invite Details</h2>

                <table class="outer-table">
                  <tr>
                    <th class="no-bg">Meeting Info</th>
                    <td class="no-bg">${folder.vision_invite_meeting_info}</td>
                  </tr>
                </table>

                <p>Feel free to forward this invite as needed.</p>

                <p>Thanks,<br>
                <em>PCP Release Bot</em></p>

                <hr>

                <div class="footer">
                  <p>- This invite was automatically generated by XL Release.</p>
                </div>
              </div>
            </body>
            </html>
          fromSender: WDPR.DL-Resort.Sales.Release.Support@wdprapps.disney.com
          variableMapping:
            pythonScript.eventUid: "${calendarEventUid}"
            pythonScript.created: "${invitetimestamp}"
    - name: CCB Skip
      type: delivery.MarkTrackedItems
      stage: CCB Phase & QE SignOff
      ^status: SKIPPED
      delivery: "${delivery_id}"
      pattern: Cynthia/PCP Release
      flagStatus: ATTENTION_NEEDED
      flagComment: "Task 'CCB Skip' in Phase 'CCB' has properties that do not match\
        \ with the known type. Following properties do not match: [configurationUri]."
      precondition: "${skip_qa} == False"
      variableMapping:
        pythonScript.trackedItems: "${application}"
    color: "#3d6c9e"
  - phase: PROD  CAB Efforts / SONAR METRICS
    tasks:
    - name: PROD CHG CAB Schedule & Outlook Invite
      type: xlrelease.ParallelGroup
      precondition: "${skip_prod}"
      tasks:
      - name: PROD CERTIFY BUILD VERSION
        type: xlrelease.SequentialGroup
        precondition: "${skip_prod}"
        tasks:
        - name: Certified PROD Build Version
          type: xlrelease.UserInputTask
          description: |-
            Please enter the certified build version for production deployment. ( Please provide the Jenkins Job Number )

            Format: Release_Version-( JenkinsBuildNumber )
          owner: admin
          variables:
          - build_version
        - name: Update Certified Build Version - Prod Deploy Ctask
          type: servicenow.UpdateChangeTask
          servicenowServer: Disney Prod
          ^description: |-
            NOTE: PLEASE WAIT FOR Confirmation to deploy.

            Application Team: ${app_name}
            BAPP ID: ${app_bappid}
            Harness Link:  ${app_harness_base_url}
            Rundeck Link: ${app_rundeck_nonprodjob}
            ==========================================================
            Application Team: ${app_name}
            ==========================================================
            Rundeck Project: ${app_rundeck_nonprodjob}
            Build version: ${build_version}
            Environment: prod
            ${rundeck_deploy_lambda_options}
            ====================================================================
          sysId: "${prod_build_deploy_ctask_sys_id}"
          changeRequest: "${prod_crq_sys_id}"
          variableMapping:
            pythonScript.Ticket: "${prod_deploy_ctask_number}"
        - name: "Notify ${Release_Version}-${build_version}"
          type: msteams.Notification
          channel: "#${channel_name}"
          message: |-
            üì¢ **Release PROD Change Build Version Confirmation Notification**

            IR - ${app_name} - ${Release_Version} - ${prod_crq_number} PROD - Change is Updated with Certified Build Version.

            ---

            üõ†Ô∏è **Application**: ${app_name} - ${Release_Version}
            üì¶ **Build Version**: ${build_version}
            üîÅ **Environment**: Production

            üìù **Change Request ID**: [${prod_crq_number}](https://disney.service-now.com/change_request.do?sys_id=${prod_crq_sys_id})
            üìÑ **Change Summary**: ${business_justification}

            üìÑ **ADS Team Deploy**: ${prod_build_deploy_ctask_number}

            ---

            üìÖ **Scheduled Date**: ${start_date} ${start} - ${end_date} ${end}

            ‚úÖ Please validate the change and Push for Peer Approval.

            ---

            Thank you,
            **PCP Release Bot ü§ñ**

            ---
          dueDate: 2020-06-29T12:00:00Z
          variableMapping:
            pythonScript.server: "${teams_channel_ref}"
      - name: Do you need PROD Adhoc CTASKS ?
        type: xlrelease.SequentialGroup
        tasks:
        - name: Do you need AdHoc Ctasks ?
          type: xlrelease.UserInputTask
          description: Please enter the required information below.
          owner: admin
          variables:
          - adhoc_ctask
          - ctask_purpose
          - ctask_purpose_info
          - ctask_type
          - ctask_assignmentgroup
        - name: Create Prod AdHoc CTask
          type: servicenow.CreateChangeTask
          servicenowServer: Disney Prod
          shortDescription: "IR - PROD - Independent Release - ${app_name} ${Release_Version}\
            \ - PROD - ${ctask_purpose}"
          ^description: |-
            IR - PROD - Independent Release - ${app_name} ${Release_Version}-
            ==========================================================
            ${ctask_purpose_info}
            ====================================================================
          ciSysId: "${prod_sys_id}"
          assignmentGroup: "${ctask_assignmentgroup}"
          state: Draft
          additionalFields:
            work_start: "${start_date} ${start}"
            work_end: "${end_date} ${end}"
            u_type: "${prod_ctask_type}"
          changeRequest: "${prod_crq_sys_id}"
          precondition: "${adhoc_ctask}"
          variableMapping:
            pythonScript.Ticket: "${prod_adhoc_ctask_number}"
            pythonScript.sysId: "${prod_adhoc_ctask_sys_id}"
            pythonScript.data: "${prod_adhoc_ctask_data}"
        - name: Prod Adhoc Ctask Notification
          type: msteams.Notification
          channel: "#${channel_name}"
          message: |-
            IR - PROD - ${app_name} - ${Release_Version} - ${prod_crq_number} Prod Adhoc Ctask is created.
            =================================
            Prod: ${prod_adhoc_ctask_number}
            =================================
          owner: admin
          precondition: "${adhoc_ctask}"
          variableMapping:
            pythonScript.server: "${teams_channel_ref}"
      - name: "PROD ${prod_crq_number} CAB Efforts"
        type: xlrelease.SequentialGroup
        tasks:
        - name: Do you need to Reschedule Prod Dates?
          type: xlrelease.UserInputTask
          description: "Please enter Go-Live Date for production in this format: YYYY-MM-DD"
          owner: admin
          variables:
          - skip_chgreschedule
          - start_date
          - end_date
        - name: "Assign Go-Live Date OR Reschedule : PROD ${prod_crq_number}"
          type: xlrelease.SequentialGroup
          precondition: "${skip_chgreschedule}"
          tasks:
          - name: Update Date- Production CRQ
            type: servicenow.UpdateChangeRequest
            servicenowServer: Disney Prod
            additionalFields:
              end_date: "${end_date} ${end}"
              start_date: "${start_date} ${start}"
            sysId: "${prod_crq_sys_id}"
          - name: Update Date- Nimbus / Vault Ctask
            type: servicenow.UpdateChangeTask
            servicenowServer: Disney Prod
            additionalFields:
              work_start: "${start_date} ${start}"
              work_end: "${end_date} ${end}"
            sysId: "${prod_nimbus_ctask_sysid}"
            changeRequest: "${prod_crq_sys_id}"
            precondition: "${chg_nimbus}"
          - name: EE SE Channel Nimbus Notification (copy)
            type: msteams.Notification
            server: Core-SE
            channel: "#${se_channel_name}"
            message: |-
              @core-se

              üì¢ **Release PROD Change SE Task Assignee Notification**

              IR - ${app_name} - ${Release_Version} - ${prod_crq_number} PROD - Change task needs to be assigned.

              ---

              üõ†Ô∏è **Application**: ${app_name} - ${Release_Version}
              üì¶ **Build Version**: ${build_version}
              üîÅ **Environment**: Production

              üìù **Change Request ID**: [${prod_crq_number}](https://disney.service-now.com/change_request.do?sys_id=${prod_crq_sys_id})
              üìÑ **Service Now URL**: https://disney.service-now.com/change_request.do?sys_id=${prod_crq_sys_id}

              üìÑ **SE Team Task**: ${prod_nimbus_ctask_number}

              ---

              üìÖ **Scheduled Date**: ${start_date} ${start} - ${end_date} ${end}

              ‚úÖ Please assign a resource for above change task.

              ---

              Thank you,
              **PCS Release Bot ü§ñ**

              ---
            waitForScheduledStartDate: false
            precondition: "${chg_nimbus}"
          - name: Update Date - Prod Deploy Ctask
            type: servicenow.UpdateChangeTask
            servicenowServer: Disney Prod
            additionalFields:
              work_start: "${start_date} ${start}"
              work_end: "${end_date} ${end}"
            sysId: "${prod_build_deploy_ctask_sys_id}"
            changeRequest: "${prod_crq_sys_id}"
          - name: ADS Channel Deploy Assignee Notification (copy)
            type: msteams.Notification
            message: |-
              @ADS-Team

              üì¢ **Release PROD Change ADS Task Assignee Notification**

              IR - ${app_name} - ${Release_Version} - ${prod_crq_number} PROD - Change task needs to be assigned.

              ---

              üõ†Ô∏è **Application**: ${app_name} - ${Release_Version}
              üì¶ **Build Version**: ${build_version}
              üîÅ **Environment**: Production

              üìù **Change Request ID**: [${prod_crq_number}](https://disney.service-now.com/change_request.do?sys_id=${prod_crq_sys_id})
              üìÑ **Service Now URL**: https://disney.service-now.com/change_request.do?sys_id=${prod_crq_sys_id}

              üìÑ **ADS Team Deploy**: ${prod_build_deploy_ctask_number}

              ---

              üìÖ **Scheduled Date**: ${start_date} ${start} - ${end_date} ${end}

              ‚úÖ Please assign a resource for above change task.

              ---

              Thank you,
              **PCP Release Bot ü§ñ**

              ---
            waitForScheduledStartDate: false
            precondition: "False"
          - name: Update Date - Prod GQE Validation Ctask
            type: servicenow.UpdateChangeTask
            servicenowServer: Disney Prod
            additionalFields:
              work_start: "${start_date} ${start}"
              work_end: "${end_date} ${end}"
            sysId: "${prod_gqe_validation_ctask_sys_id}"
            changeRequest: "${prod_crq_sys_id}"
          - name: Update Date - Prod Vision Validation Ctask
            type: servicenow.UpdateChangeTask
            servicenowServer: Disney Prod
            additionalFields:
              work_start: "${start_date} ${start}"
              work_end: "${end_date} ${end}"
            sysId: "${prod_vision_validation_ctask_sys_id}"
            changeRequest: "${prod_crq_sys_id}"
          - name: PROD CHG Reschedule Notification
            type: msteams.Notification
            channel: "#${channel_name}"
            message: |-
              üì¢ **Release PROD Change Request Date Reschedule Notification**

              IR - ${app_name} - ${Release_Version} - ${prod_crq_number} PROD - Change is Rescheduled and please find below ctasks.

              ---

              üõ†Ô∏è **Application**: ${app_name} - ${Release_Version}
              üì¶ **Build Version**: ${build_version}
              üîÅ **Environment**: Production

              üìù **Change Request ID**: [${prod_crq_number}](https://disney.service-now.com/change_request.do?sys_id=${prod_crq_sys_id})
              üìÑ **Service Now URL**: https://disney.service-now.com/change_request.do?sys_id=${prod_crq_sys_id}
              üìÑ **Change Summary**: ${business_justification}

              ---

              üìÑ **ADS Team Deploy**: ${prod_build_deploy_ctask_number}

              üìÑ **GQE Team Validation**: ${prod_gqe_validation_ctask_number}

              üìÑ **Application Team Validation**: ${prod_vision_validation_ctask_number}

              ---

              üìÖ **Scheduled Date**: ${start_date} ${start} and ${end_date} ${end}

              ‚úÖ Please validate the change and Push for Peer Approval.

              ---

              Thank you,
              **PCP Release Bot ü§ñ**

              ---
            variableMapping:
              pythonScript.server: "${teams_channel_ref}"
        - name: "Is QA - ${qa_crq_number} Closed Complete ?"
          type: servicenow.PollingCheckStatus
          servicenowServer: Disney Prod
          sysId: "${qa_sys_id}"
          checkForStatus: Complete
          owner: admin
        - name: "Is QA - ${qa_new_crq_number} Closed Complete ?"
          type: servicenow.PollingCheckStatus
          servicenowServer: Disney Prod
          sysId: "${qa_new_sys_id}"
          checkForStatus: Complete
          owner: admin
          precondition: "${createNewQaCtasks} or ${createNewQaunplannedCtasks}"
        - name: Check All QA Changes are Closed?
          type: xlrelease.Task
          owner: admin
          precondition: |-
            #${createNewQaCtasks} or ${createNewQaunplannedCtasks}
            False
        - name: Resolve Conflicts & Obtain Peer Approval
          type: servicenow.PollingCheckStatus
          servicenowServer: Disney Prod
          sysId: "${prod_crq_sys_id}"
          statusField: approval
          checkForStatus: Pending Peer Approval
          owner: admin
        - name: "Peer Approval  ${prod_crq_number}"
          type: msteams.Notification
          server: Peer Approval
          channel: "#DigitalPeerApproval"
          message: |-
            @${service_owner}

            üì¢ **Release PROD Change Peer Approval Notification**

            IR - ${app_name} - ${Release_Version} - ${prod_crq_number} PROD - Change is Created and pushed for Peer review and approval.

            ---

            üõ†Ô∏è **Application**: ${app_name} - ${Release_Version}
            üì¶ **Build Version**: ${build_version}
            üîÅ **Environment**: Production

            üìù **Change Request ID**: [${prod_crq_number}](https://disney.service-now.com/change_request.do?sys_id=${prod_crq_sys_id})
            üìÑ **Service Now URL**: https://disney.service-now.com/change_request.do?sys_id=${prod_crq_sys_id}
            üìÑ **Change Summary**: ${business_justification}

            ---

            üìÖ **Scheduled Date**: ${start_date} ${start} and ${end_date} ${end}

            ‚úÖ Please Peer Review and Approve change request.

            ---

            Thank you,
            **PCP Release Bot ü§ñ**

            ---
          owner: admin
        - name: Resolve Conflicts & Obtain Peer Approval
          type: servicenow.PollingCheckStatus
          servicenowServer: Disney Prod
          sysId: "${prod_crq_sys_id}"
          statusField: approval
          checkForStatus: Pending Additional Approvals
          owner: admin
        - name: "${prod_crq_number} CAB Approved"
          type: servicenow.PollingCheckStatus
          servicenowServer: Disney Prod
          sysId: "${prod_crq_sys_id}"
          statusField: approval
          checkForStatus: Approved
          owner: admin
        - name: PROD CAB Aproval Notification
          type: xlrelease.SequentialGroup
          tasks:
          - name: "${prod_crq_number} CAB Approved"
            type: msteams.Notification
            channel: "#${channel_name}"
            message: |-
              üì¢ **Release PROD Change CAB Approval Notification**

              IR - ${app_name} - ${Release_Version} - ${prod_crq_number} PROD - Change is **CAB Approved**.

              ---

              üõ†Ô∏è **Application**: ${app_name} - ${Release_Version}
              üì¶ **Build Version**: ${build_version}
              üîÅ **Environment**: Production

              üìù **Change Request ID**: [${prod_crq_number}](https://disney.service-now.com/change_request.do?sys_id=${prod_crq_sys_id})
              üìÑ **Service Now URL**: https://disney.service-now.com/change_request.do?sys_id=${prod_crq_sys_id}
              üìÑ **Change Summary**: ${business_justification}

              üìÑ **ADS Team Deploy**: ${prod_build_deploy_ctask_number}

              üìÑ **GQE Team Validation**: ${prod_gqe_validation_ctask_number}

              üìÑ **Application Team Validation**: ${prod_vision_validation_ctask_number}


              ---

              üìÖ **Scheduled Date**: ${start_date} ${start} and ${end_date} ${end}

              ‚úÖ Please find the change request which is CAB Approved.

              ---

              Thank you,
              **PCP Release Bot ü§ñ**

              ---
            precondition: "${chg_nimbus} == False"
            variableMapping:
              pythonScript.server: "${teams_channel_ref}"
          - name: "${prod_crq_number} CAB Approved SE+Code Ctask"
            type: msteams.Notification
            channel: "#${channel_name}"
            message: |-
              üì¢ **Release PROD Change CAB Approval Notification**

              IR - ${app_name} - ${Release_Version} - ${prod_crq_number} PROD - Change is **CAB Approved**.

              ---

              üõ†Ô∏è **Application**: ${app_name} - ${Release_Version}
              üì¶ **Build Version**: ${build_version}
              üîÅ **Environment**: Production

              üìù **Change Request ID**: [${prod_crq_number}](https://disney.service-now.com/change_request.do?sys_id=${prod_crq_sys_id})
              üìÑ **Service Now URL**: https://disney.service-now.com/change_request.do?sys_id=${prod_crq_sys_id}
              üìÑ **Change Summary**: ${business_justification}


              üìÑ **SE Updates Task**: ${prod_nimbus_ctask_number}

              üìÑ **ADS Team Deploy**: ${prod_build_deploy_ctask_number}

              üìÑ **GQE Team Validation**: ${prod_gqe_validation_ctask_number}

              üìÑ **Application Team Validation**: ${prod_vision_validation_ctask_number}


              ---

              üìÖ **Scheduled Date**: ${start_date} ${start} and ${end_date} ${end}

              ‚úÖ Please find the change request which is CAB Approved.

              ---

              Thank you,
              **PCP Release Bot ü§ñ**

              ---
            precondition: "${chg_nimbus}"
            variableMapping:
              pythonScript.server: "${teams_channel_ref}"
        - name: PROD CAB Schedule & Approval
          type: delivery.MarkTrackedItems
          stage: Production CAB Schedule & Approval
          delivery: "${delivery_id}"
          pattern: Cynthia/PCP Release
          flagStatus: ATTENTION_NEEDED
          flagComment: "Task 'PROD CAB Schedule & Approval' in Phase 'PROD  CAB Efforts\
            \ / SONAR METRICS' has properties that do not match with the known type.\
            \ Following properties do not match: [configurationUri]."
          variableMapping:
            pythonScript.trackedItems: "${application}"
        - name: "Git Compare Tag Within ${Release_Version} Script (copy)"
          type: xlrelease.ScriptTask
          script: |-
            from java.net import URL
            from java.util import Scanner
            import json
            import time
            from distutils.version import LooseVersion # ### ADDED IMPORT for correct version sorting

            # === CONFIGURATION ===
            GITHUB_API_URL = "https://github.disney.com/api/v3"
            REPO = "${app_gitorg}/${app_gitrepo}"
            REPO_URL = "https://github.disney.com/" + REPO
            RELEASE_PREFIX = "v${Release_Version}"

            # Secure token
            GITHUB_TOKEN = releaseVariables["githubToken"]

            # === HELPERS ===

            def get_json(url_str, extra_accept=None):
                url = URL(url_str)
                conn = url.openConnection()
                conn.setRequestProperty("Authorization", "Bearer " + GITHUB_TOKEN)
                if extra_accept:
                    conn.setRequestProperty("Accept", extra_accept)
                else:
                    conn.setRequestProperty("Accept", "application/vnd.github+json")
                conn.setRequestMethod("GET")
                conn.connect()
                code = conn.getResponseCode()
                if code != 200:
                    raise Exception("GitHub API failed: {} -> {}".format(url_str, code))
                scanner = Scanner(conn.getInputStream()).useDelimiter("\\A")
                resp = scanner.hasNext() and scanner.next() or ""
                scanner.close()
                return json.loads(resp)

            def parse_iso_date(s):
                # Parse ISO 8601 date, ignore timezone for simplicity
                return time.strptime(s[:19], "%Y-%m-%dT%H:%M:%S")

            # Helper to safely join Unicode strings encoded as UTF-8 bytes
            def safe_join_utf8(lines):
                encoded_lines = []
                for line in lines:
                    if isinstance(line, unicode):
                        encoded_lines.append(line.encode('utf-8'))
                    elif isinstance(line, str):
                        encoded_lines.append(line)
                    else:
                        encoded_lines.append(str(line).encode('utf-8'))
                return "\n".join(encoded_lines)

            ### MODIFIED SECTION START ###

            def get_all_tags_paginated(api_url, repo):
                """Fetches all tags from a repository, handling pagination."""
                all_tags = []
                page = 1
                per_page = 50  # Fetch 30 tags per page as requested
                while True:
                    url = "{}/repos/{}/tags?page={}&per_page={}".format(api_url, repo, page, per_page)
                    print("Fetching tags from: {}".format(url))

                    page_of_tags = get_json(url)
                    if not page_of_tags:
                        break # Stop if the API returns an empty list

                    all_tags.extend(page_of_tags)

                    if len(page_of_tags) < per_page:
                        break # Last page was reached

                    page += 1
                return all_tags

            # --- Step 1: Get all tags and filter them ---
            all_repo_tags = get_all_tags_paginated(GITHUB_API_URL, REPO)

            if not all_repo_tags:
                raise Exception("No tags found at all in the repository '{}'.".format(REPO))

            print("Found {} total tags. Filtering for prefix '{}'...".format(len(all_repo_tags), RELEASE_PREFIX))

            # Filter tags that match the prefix and create a list of their names
            matching_tag_names = []
            for tag in all_repo_tags:
                name = tag.get("name")
                if name and name.startswith(RELEASE_PREFIX + "-"):
                    matching_tag_names.append(name)

            if not matching_tag_names:
                raise Exception("No tags with prefix '{}' found.".format(RELEASE_PREFIX))

            print("Found {} matching tags: {}".format(len(matching_tag_names), matching_tag_names))

            # --- Correctly sort tags by version number, not alphabetically ---
            # This correctly handles cases like "v3.0.0-10" vs "v3.0.0-2"
            sorted_tags = sorted(matching_tag_names, key=LooseVersion)

            initialTag = sorted_tags[0]
            lastTag = sorted_tags[-1]

            ### MODIFIED SECTION END ###


            # --- Step 2: Compare tags
            compare = get_json(GITHUB_API_URL + "/repos/{}/compare/{}...{}".format(REPO, initialTag, lastTag))

            # --- Step 3: Files changed
            filesChangedList = [f["filename"] for f in compare.get("files", [])]

            # --- Step 4: Commit logs
            commit_shas = []
            commitLogsList = []
            commitLogsFormattedList = []
            for c in compare.get("commits", []):
                sha = c["sha"]
                commit_shas.append(sha)
                msg = c["commit"]["message"]
                author = c["commit"]["author"]["name"]
                date = c["commit"]["author"]["date"]
                commitLogsList.append({
                    "commitID": sha,
                    "commitMessage": msg,
                    "author": author,
                    "date": date
                })
                commit_url = REPO_URL + "/commit/" + sha
                commitLogsFormattedList.append(u"[{}]({}) : {}".format(sha[:7], commit_url, msg.split("\n")[0]))

            # --- Step 5: PRs via commits
            prs_between_tags = []
            seen_pr_ids = set()
            pr_links_formatted = []
            pr_urls_only = []

            for sha in commit_shas:
                pr_url = GITHUB_API_URL + "/repos/{}/commits/{}/pulls".format(REPO, sha)
                try:
                    pr_objs = get_json(pr_url, extra_accept="application/vnd.github.groot-preview+json")
                except:
                    pr_objs = []
                for pr in pr_objs:
                    pr_id = pr.get("number")
                    if pr_id and pr.get("merged_at") and pr_id not in seen_pr_ids:
                        pr_link = REPO_URL + "/pull/" + str(pr_id)
                        title = pr.get("title", "")
                        entry = {
                            "number": pr_id,
                            "title": title,
                            "user": pr.get("user", {}).get("login"),
                            "merged_at": pr.get("merged_at"),
                            "url": pr_link
                        }
                        prs_between_tags.append(entry)
                        pr_links_formatted.append(u"[PR #{}]({}) : {}".format(pr_id, pr_link, title))
                        pr_urls_only.append(pr_link)
                        seen_pr_ids.add(pr_id)

            # --- Step 6: Build result dictionary
            result = {
                "initialTag": initialTag,
                "lastTag": lastTag,
                "filesChanged": filesChangedList,
                "commitLogs": commitLogsList,
                "pullRequests": prs_between_tags
            }

            # --- Step 7: Prepare safe UTF-8 joined strings for output and variables
            commitLogsFormattedJoined = safe_join_utf8(commitLogsFormattedList)
            prLinksFormattedJoined = safe_join_utf8(pr_links_formatted)
            prUrlsOnlyJoined = safe_join_utf8(pr_urls_only)

            # --- Step 8: Logging (print)
            print("Initial Tag: " + initialTag.encode('utf-8'))
            print("Last Tag: " + lastTag.encode('utf-8'))
            print("Files Changed:\n" + json.dumps(filesChangedList, indent=2).encode('utf-8'))
            print("Commit Logs:\n" + json.dumps(commitLogsList, indent=2).encode('utf-8'))
            print("Formatted Commit Logs:\n" + commitLogsFormattedJoined)
            print("Pull Requests:\n" + json.dumps(prs_between_tags, indent=2).encode('utf-8'))
            print("Formatted PRs:\n" + prLinksFormattedJoined)
            print("PR URLs:\n" + prUrlsOnlyJoined)

            # --- Step 9: Set release variables (assign UTF-8 encoded byte strings)
            releaseVariables["initialTag"] = initialTag.encode('utf-8')
            releaseVariables["lastTag"] = lastTag.encode('utf-8')
            releaseVariables["filesChanged"] = json.dumps(filesChangedList).encode('utf-8')
            releaseVariables["commitLogs"] = json.dumps(commitLogsList).encode('utf-8')
            releaseVariables["commitLogsFormatted"] = commitLogsFormattedJoined
            releaseVariables["pullRequests"] = json.dumps(prs_between_tags).encode('utf-8')
            releaseVariables["pullRequestLinksFormatted"] = prLinksFormattedJoined
            releaseVariables["pullRequestUrlsOnly"] = prUrlsOnlyJoined
            releaseVariables["githubCompareResult"] = json.dumps(result, indent=2).encode('utf-8')
        - name: Email Notification on Tag Comapre Info
          type: xlrelease.NotificationTask
          precondition: "False"
          addresses:
          - Mohisin.Anwar.Mohammed.-ND@disney.com
          subject: "IR - ${app_name} - ${Release_Version} - Git Tag Log Notification"
          body: |-
            ![Walt Disney World](https://www.google.com/imgres?imgurl=https%3A%2F%2Fwww.netclipart.com%2Fpp%2Fm%2F141-1411824_clipart-disney-world-walt-disney-company-logo-png.png&imgrefurl=https%3A%2F%2Fwww.netclipart.com%2Fisee%2FxThwwh_clipart-disney-world-walt-disney-company-logo-png%2F&tbnid=eoZQ4k9ko5nHmM&vet=12ahUKEwi5x8D-mr7rAhXz2nMBHZxYCp0QMygTegUIARDdAQ..i&docid=mFNs5JDfmnH_GM&w=920&h=247&q=walt%20disney%20logo&hl=en-GB&client=ubuntu&ved=2ahUKEwi5x8D-mr7rAhXz2nMBHZxYCp0QMygTegUIARDdAQ)


            ***
            ## Please find the git tag comparision of ${Release_Version}
            ***
            ## Commit Info for ${Release_Version}
            ***
            ${commitLogsFormatted}
            ***
            ## Files changed  for ${Release_Version}
            ***
            ${filesChanged}
            ***
            ## PR's Merged  for ${Release_Version}
            ***
            ${pullRequestLinksFormatted}
            ***
            ## PR URL's  for ${Release_Version}
            ***
            ${pullRequestUrlsOnly}
      - name: Outlook Invite Update or Cancel
        type: xlrelease.SequentialGroup
        precondition: "${create_invite}"
        tasks:
        - name: Update Invite
          type: xlrelease.UserInputTask
          description: Please enter the required information below.
          owner: admin
          variables:
          - update_invite
          - event_start
          - event_end
          - invite_receipients
          - Release_Plan_Url
        - name: Update Calendar Invite
          type: outlook.UpdateCalendarEvent
          server: Outlook
          emails: "${invite_receipients}"
          timeStart: "${event_start}"
          timeEnd: "${event_end}"
          subject: "IR | PROD | ${app_name}  ${Release_Version}  | ${prod_crq_number}"
          message: |-
            <html>
            <head>
              <style>
                body {
                  font-family: "Segoe UI", Arial, sans-serif;
                  font-size: 14px;
                  color: #333333;
                  line-height: 1.6;
                  margin: 0;
                  padding: 20px;
                  background-color: #f0f4f8; /* very light page background */
                }

                .container {
                  background-color: #ffffff;
                  border: 2px solid #1976d2; /* bold outer blue border */
                  border-radius: 8px;
                  padding: 20px 25px;
                  max-width: 750px;
                  margin: auto;
                }

                h2 {
                  color: #1976d2; /* dark blue */
                  font-size: 15px;
                  margin-top: 25px;
                  margin-bottom: 10px;
                  border-bottom: 2px solid #90caf9; /* light blue underline */
                  padding-bottom: 4px;
                  font-weight: 600;
                }

                p {
                  margin: 10px 0;
                }

                table {
                  border-collapse: collapse;
                  width: 100%;
                  margin-top: 10px;
                }

                th, td {
                  text-align: left;
                  padding: 10px 12px;
                  vertical-align: top;
                  border: 2px solid #1976d2; /* bold blue borders for outer table */
                }

                th {
                  background-color: #bbdefb; /* light blue header for outer table */
                  color: #1976d2;
                  font-weight: 600;
                }

                /* Outer table alternating rows for all except white rows */
                .outer-table tr:nth-child(odd) td:not(.no-bg) {
                  background-color: #e3f2fd; /* very light blue for alternate rows */
                }

                /* Rows that should have no background */
                .no-bg {
                  background-color: #ffffff !important;
                }

                /* Inner table card styling */
                .inner-table {
                  border: 2px solid #43a047; /* bold green border */
                  border-radius: 6px;
                  background-color: #ffffff; /* plain white cells */
                  box-shadow: 2px 2px 6px rgba(0,0,0,0.05);
                  margin-top: 10px;
                  width: 100%;
                }

                .inner-table th {
                  background-color: #a0ff9f; /* light neon green header */
                  color: #2e7d32;
                  border: 2px solid #43a047;
                  text-align: center;
                  font-weight: bold;
                }

                .inner-table td {
                  border: 2px solid #43a047;
                  background-color: #ffffff; /* plain white cells */
                  text-align: center;
                  font-weight: bold;
                }

                a {
                  color: #1976d2;
                  text-decoration: none;
                }

                a:hover {
                  text-decoration: underline;
                }

                hr {
                  border: none;
                  border-top: 2px solid #1976d2; /* bold blue line */
                  margin: 25px 0;
                }

                .footer {
                  font-size: 12px;
                  color: #555555;
                  margin-top: 25px;
                  text-align: center;
                }

                em {
                  color: #333333;
                }
              </style>
            </head>
            <body>
              <div class="container">
                <p>Hello everyone,</p>
                <p>Please find below meeting info to join us for the release of:</p>

                <!-- Outer Table -->
                <table class="outer-table">
                  <tr>
                    <td colspan="2">
                      <!-- Inner Table Card: Application, ServiceNow, Build Version as columns -->
                      <table class="inner-table">
                        <tr>
                          <th>Application</th>
                          <th>Prod Change Request</th>
                          <th>Build Version</th>
                        </tr>
                        <tr>
                          <td>${app_name} ${Release_Version}</td>
                          <td>${prod_crq_number}</td>
                          <td>${build_version}</td>
                        </tr>
                        <!-- Example if you have multiple apps
                            <tr>
                            <td>App 1</td>
                            <td>CRQ12345</td>
                            <td>v1.2.0</td>
                        </tr>
                        <tr>
                            <td>App 2</td>
                            <td>CRQ12346</td>
                            <td>v3.4.1</td>
                        </tr> -->
                      </table>
                    </td>
                  </tr>
                  <!-- disable below table row if there are multiple apps for a invite -->
                  <tr>
                    <th class="no-bg">Snow URL</th>
                    <td class="no-bg">
                      <a href="https://disney.service-now.com/change_request.do?sys_id=${prod_crq_sys_id}">
                        https://disney.service-now.com/change_request.do?sys_id=${prod_crq_sys_id}
                      </a>
                    </td>
                  </tr>
                  <tr>
                    <th class="no-bg">Teams Channel</th>
                    <td class="no-bg">${folder.invite_vision_channel}</td>
                  </tr>
                  <tr>
                    <th class="no-bg">Release Plan</th>
                    <td class="no-bg"><a href="${Release_Plan_Url}">${Release_Plan_Url}</a></td>
                  </tr>
                </table>
                <!-- Meeting Info Section -->
                <h2>Meeting Invite Details</h2>

                <table class="outer-table">
                  <tr>
                    <th class="no-bg">Meeting Info</th>
                    <td class="no-bg">${folder.vision_invite_meeting_info}</td>
                  </tr>
                </table>

                <p>Feel free to forward this invite as needed.</p>

                <p>Thanks,<br>
                <em>PCP Release Bot</em></p>

                <hr>

                <div class="footer">
                  <p>- This invite was automatically generated by XL Release.</p>
                </div>
              </div>
            </body>
            </html>
          fromSender: WDPR.DL-Resort.Sales.Release.Support@wdprapps.disney.com
          eventUid: "${calendarEventUid}"
          sequence: 1
          created: "${invitetimestamp}"
          precondition: "${update_invite}"
        - name: Cancel Invite
          type: xlrelease.UserInputTask
          description: Please enter the required information below.
          owner: admin
          variables:
          - cancel_invite
          - event_start
          - event_end
          - invite_receipients
        - name: Cancel Calendar Invite
          type: outlook.CancelCalendarEvent
          server: Outlook
          emails: "${invite_receipients}"
          timeStart: "${event_start}"
          timeEnd: "${event_end}"
          subject: "IR | PROD | ${app_name}  ${Release_Version}  | ${prod_crq_number}"
          message: |-
            <html>
            <head>
              <style>
                body {
                  font-family: "Segoe UI", Arial, sans-serif;
                  font-size: 14px;
                  color: #333333;
                  line-height: 1.6;
                  margin: 0;
                  padding: 20px;
                  background-color: #f0f4f8; /* very light page background */
                }

                .container {
                  background-color: #ffffff;
                  border: 2px solid #1976d2; /* bold outer blue border */
                  border-radius: 8px;
                  padding: 20px 25px;
                  max-width: 750px;
                  margin: auto;
                }

                h2 {
                  color: #1976d2; /* dark blue */
                  font-size: 15px;
                  margin-top: 25px;
                  margin-bottom: 10px;
                  border-bottom: 2px solid #90caf9; /* light blue underline */
                  padding-bottom: 4px;
                  font-weight: 600;
                }

                p {
                  margin: 10px 0;
                }

                table {
                  border-collapse: collapse;
                  width: 100%;
                  margin-top: 10px;
                }

                th, td {
                  text-align: left;
                  padding: 10px 12px;
                  vertical-align: top;
                  border: 2px solid #1976d2; /* bold blue borders for outer table */
                }

                th {
                  background-color: #bbdefb; /* light blue header for outer table */
                  color: #1976d2;
                  font-weight: 600;
                }

                /* Outer table alternating rows for all except white rows */
                .outer-table tr:nth-child(odd) td:not(.no-bg) {
                  background-color: #e3f2fd; /* very light blue for alternate rows */
                }

                /* Rows that should have no background */
                .no-bg {
                  background-color: #ffffff !important;
                }

                /* Inner table card styling */
                .inner-table {
                  border: 2px solid #43a047; /* bold green border */
                  border-radius: 6px;
                  background-color: #ffffff; /* plain white cells */
                  box-shadow: 2px 2px 6px rgba(0,0,0,0.05);
                  margin-top: 10px;
                  width: 100%;
                }

                .inner-table th {
                  background-color: #a0ff9f; /* light neon green header */
                  color: #2e7d32;
                  border: 2px solid #43a047;
                  text-align: center;
                  font-weight: bold;
                }

                .inner-table td {
                  border: 2px solid #43a047;
                  background-color: #ffffff; /* plain white cells */
                  text-align: center;
                  font-weight: bold;
                }

                a {
                  color: #1976d2;
                  text-decoration: none;
                }

                a:hover {
                  text-decoration: underline;
                }

                hr {
                  border: none;
                  border-top: 2px solid #1976d2; /* bold blue line */
                  margin: 25px 0;
                }

                .footer {
                  font-size: 12px;
                  color: #555555;
                  margin-top: 25px;
                  text-align: center;
                }

                em {
                  color: #333333;
                }
              </style>
            </head>
            <body>
              <div class="container">
                <p>Hello everyone,</p>
                <p>Please find below meeting info to join us for the release of:</p>

                <!-- Outer Table -->
                <table class="outer-table">
                  <tr>
                    <td colspan="2">
                      <!-- Inner Table Card: Application, ServiceNow, Build Version as columns -->
                      <table class="inner-table">
                        <tr>
                          <th>Application</th>
                          <th>Prod Change Request</th>
                          <th>Build Version</th>
                        </tr>
                        <tr>
                          <td>${app_name} ${Release_Version}</td>
                          <td>${prod_crq_number}</td>
                          <td>${build_version}</td>
                        </tr>
                        <!-- Example if you have multiple apps
                            <tr>
                            <td>App 1</td>
                            <td>CRQ12345</td>
                            <td>v1.2.0</td>
                        </tr>
                        <tr>
                            <td>App 2</td>
                            <td>CRQ12346</td>
                            <td>v3.4.1</td>
                        </tr> -->
                      </table>
                    </td>
                  </tr>
                  <!-- disable below table row if there are multiple apps for a invite -->
                  <tr>
                    <th class="no-bg">Snow URL</th>
                    <td class="no-bg">
                      <a href="https://disney.service-now.com/change_request.do?sys_id=${prod_crq_sys_id}">
                        https://disney.service-now.com/change_request.do?sys_id=${prod_crq_sys_id}
                      </a>
                    </td>
                  </tr>
                  <tr>
                    <th class="no-bg">Teams Channel</th>
                    <td class="no-bg">${folder.invite_vision_channel}</td>
                  </tr>
                  <tr>
                    <th class="no-bg">Release Plan</th>
                    <td class="no-bg"><a href="${Release_Plan_Url}">${Release_Plan_Url}</a></td>
                  </tr>
                </table>
                <!-- Meeting Info Section -->
                <h2>Meeting Invite Details</h2>

                <table class="outer-table">
                  <tr>
                    <th class="no-bg">Meeting Info</th>
                    <td class="no-bg">${folder.vision_invite_meeting_info}</td>
                  </tr>
                </table>

                <p>Feel free to forward this invite as needed.</p>

                <p>Thanks,<br>
                <em>PCP Release Bot</em></p>

                <hr>

                <div class="footer">
                  <p>- This invite was automatically generated by XL Release.</p>
                </div>
              </div>
            </body>
            </html>
          fromSender: WDPR.DL-Resort.Sales.Release.Support@wdprapps.disney.com
          eventUid: "${calendarEventUid}"
          sequence: 2
          created: "${invitetimestamp}"
          precondition: "${cancel_invite}"
    - name: PROD Schedule & Approval Skip
      type: delivery.MarkTrackedItems
      stage: Production CAB Schedule & Approval
      ^status: SKIPPED
      delivery: "${delivery_id}"
      pattern: Cynthia/PCP Release
      flagStatus: ATTENTION_NEEDED
      flagComment: "Task 'PROD Schedule & Approval Skip' in Phase 'PROD  CAB Efforts\
        \ / SONAR METRICS' has properties that do not match with the known type. Following\
        \ properties do not match: [configurationUri]."
      precondition: "${skip_prod} == False"
      variableMapping:
        pythonScript.trackedItems: "${application}"
    - name: Go Live Completion
      type: xlrelease.SequentialGroup
      precondition: "${skip_prod}"
      tasks:
      - name: "${prod_crq_number} Closed Complete"
        type: servicenow.PollingCheckStatus
        servicenowServer: Disney Prod
        sysId: "${prod_crq_sys_id}"
        checkForStatus: Complete
        owner: admin
        precondition: "${skip_prod}"
      - name: Release Notes
        type: delivery.MarkTrackedItems
        stage: Release Notes & Go Live Status
        delivery: "${delivery_id}"
        pattern: Cynthia/PCP Release
        flagStatus: ATTENTION_NEEDED
        flagComment: "Task 'Release Notes' in Phase 'PROD  CAB Efforts / SONAR METRICS'\
          \ has properties that do not match with the known type. Following properties\
          \ do not match: [configurationUri]."
        precondition: "${skip_prod}"
        variableMapping:
          pythonScript.trackedItems: "${application}"
    - name: Release Notes Skipped
      type: delivery.MarkTrackedItems
      stage: Release Notes
      ^status: SKIPPED
      delivery: "${delivery_id}"
      pattern: PCS/PCS Release
      flagStatus: ATTENTION_NEEDED
      flagComment: "Task 'Release Notes Skipped' in Phase 'PROD  CAB Efforts / SONAR\
        \ METRICS' has properties that do not match with the known type. Following\
        \ properties do not match: [configurationUri]."
      precondition: "${skip_prod} == False"
      variableMapping:
        pythonScript.trackedItems: "${application}"
    - name: "${release.title}"
      type: xlrelease.ScriptTask
      facets:
      - type: udm.DeploymentTaskFacet
        variableMapping:
          version: "${prod_crq_number}"
        application: ChangeRequest PROD
        environment: PROD
      script: "globalVariables['global.PROD_CRQ'].append(releaseVariables['prod_crq_number'])"
    color: "#0079BC"
  realFlagStatus: ATTENTION_NEEDED
  variables:
  - type: xlrelease.StringVariable
    key: Release_Version
    label: Release Version
    description: "Application Release Version (Example : 1.3.2)"
  - type: xlrelease.StringVariable
    key: app_name
    label: Application Name As Per CHG - BAPPID
    valueProvider:
      type: xlrelease.ListOfStringValueProviderConfiguration
      values:
      - DLR Resort Reservation View Assembly
      - DLR Guest Resort Reservation WebAPI
      - DLR Guest Resort Reservation SPA
      - DLR Ticket and Voucher Batch
      - DLR Ticket Order Batch
      - DLR Package Entitlement Service
      - DLR Lodging Digital Services - SPA - Guest Facing
      - DLR Lodging Digital Services - WebAPI - Guest Facing
      - DLR Lodging Digital Services - View Assembly - Guest Facing
      - DLR Cast Resort Reservation SPA
      - DLR Cast Resort Reservation WebAPI
      - WDPR Resorts List View Assembly
      - WDW Disney AddOns View Assembly
      - WDW Resort Details View Assembly
      - WDW Parks as a Platform Package Service
      - WDW Package Offer Service
      - WDW Mobile Resort Reservation Api
      - WDPR Lodging Add Ons SPA
      - WDPR Lodging Addon Web API
      - WDW Parks as a Platform Room Pricing Service
      - WDW Parks As a Platform Marketing Offer Service
      - DLR Parks as a Platform Package Service
      - WDPR Accommodation Facility Service
      - WDW Mobile Resort Reservation Spa
      - WDW Mobile Resort Reservation VA
      - WDPR Resorts List Spa
      - WDPR Resorts List API
      - DREAMS UI
      - WDPR Passport
      - WDPR Payment Hub Service (Web API)
      - WDPR Payment Hub UI (Web Client)
      - WDPR payment-hub-session-handler
      - WDPR Ticket Sales UI
      - WISHESUI-DVC
      - DLR Parks As A Platform Marketing Offer Service
      - DLR Parks As A Platform Room Pricing Service
      - WDW Resort Reservation View Assembly
      - DVC Auto Member Information (AMI) API
      - DVC Auto Member Information (AMI) UI
      - DLR Resort Details VA
      - DLR Resort Details SPA
      - DLR Resort Details Web API
      - DLR Resort Details SPA
      - DLR Resort Details Web API
      - DLR Resort Details VA
      - DLR Resort List VA
      - DLR Resort List SPA
      - DLR Resort List web API
      - DLR Resort Addons VA
      - DLR Resort Sales Checkout VA
      - DLR Resort Sales Checkout WebAPI
      - DLR Resort Sales Checkout SPA
      - DLR Marketing Offer VA
      - DLR Resort Package VA
      - WDPR PCS Availability Service
      - WDPR Facilities & Events Services
      - CTI - Computer Telephony Integration
      - DRC APR Prd
      - NICE Call Quality Monitoring - DGCS-3.5
      - NICE Engage - WDPR
      - NICE Total Recording - DLR Security
      - SPOK - Aulani
      - SPOK - Disney's Guest Communications Services
      - SPOK - DLR
      - WDW Disney Performance Tracker (DPT) 7.1
      - WDPR  Resort Package VA Service
      - WDPR Marketing Offer VA Service
      - DLR Cancellation Form - Web API
      - WDW Lodging Service
      - DLR Cancellation Form - Spa
      - WDW Lodging Recommendation Service
      - DLR Online Modifications SPA
      - DLR Online Modifications VA
      - DLR Resort Landing Web API
      - DLR Online Modifications Web API
      - Facility Service
      - WDPR Special Offers Spa
      - WDPR Special Offers Web API
      - WDW Lodging Resort Details API
      - WDW Lodging Resort Details SPA
      - WDW Lodging Product Service
      - WDPR Syndicated Quick Quote Spa
      - WDW Lodging Landing SPA
      - DLR Resort Landing SPA
    value: WDPR Resorts List Spa
  - type: xlrelease.StringVariable
    key: select_brand
    label: Jurisdiction
    description: Select  Brand as per the Application
    valueProvider:
      type: xlrelease.ListOfStringValueProviderConfiguration
      variableMapping:
        values: "${app_brand}"
  - type: xlrelease.StringVariable
    key: tech_lead
    label: Application Tech Lead
    valueProvider:
      type: xlrelease.ListOfStringValueProviderConfiguration
      values:
      - Abhilash Kochanujan Pillai
      - Nathan Dougherty
      - Nagi Kolli
      - Evy I Nuguid
      - Benas Vaiciunas
      - Yatesh P Patil
      - Mohan Masilamani
      - Josh Johnson
      - Sailendra Swain
      - Sathishkumar Vijayakumar
      - Jose Cifuentes
      - Kaustav Mitra
      - Raja Shiva Prasad Deeti
      - Dhananjay Kushawah
      - Nijo Johnson
    value: Jose Cifuentes
  - type: xlrelease.StringVariable
    key: tech_manager
    requiresValue: false
    showOnReleaseStart: false
    label: Application Manager
    valueProvider:
      type: xlrelease.ListOfStringValueProviderConfiguration
      values:
      - Amit Hathiramani
      - Ravi Tula
      - Kelly Taylor-Noble
      - Abhilash Kochanujan Pillai
    value: Abhilash Kochanujan Pillai
  - type: xlrelease.StringVariable
    key: channel
    requiresValue: false
    showOnReleaseStart: false
    label: Teams Channel Name for Release Notifications
    value: Studio Vision Release
  - type: xlrelease.BooleanVariable
    key: skip_phaseslack
    requiresValue: false
    showOnReleaseStart: false
    label: Do We Need To Create Slack Channel ?
    description: Checkbox/Enable - To create New Slack Channel (or) Leave it unchecked
      - If a Slack Channel Already Exists
  - type: xlrelease.StringVariable
    key: business_justification
    label: Business Justification of Change
    description: Please provide details why this change is needed for prod implementation.
    multiline: true
  - type: xlrelease.StringVariable
    key: business_impact
    requiresValue: false
    label: Business Impact of Change
    description: Please provide details why this change is needed for prod implementation
      so there is no impact to live site.
    multiline: true
  - type: xlrelease.StringVariable
    key: Studio
    requiresValue: false
    showOnReleaseStart: false
    valueProvider:
      type: xlrelease.ListOfStringValueProviderConfiguration
  - type: xlrelease.StringVariable
    key: purpose_change
    requiresValue: false
    showOnReleaseStart: false
    label: Purpose of Change
    description: Please provide the purpose of this change for prod implementation.
    multiline: true
  - type: xlrelease.StringVariable
    key: ticket_details
    requiresValue: false
    showOnReleaseStart: false
    label: My Jira / Version One Tickets As Part Of Release Scope
  - type: xlrelease.StringVariable
    key: pr_details
    requiresValue: false
    showOnReleaseStart: false
    label: Git Hub Pull Requests Details As per My Jira Tickets / Version One
    multiline: true
  - type: xlrelease.StringVariable
    key: chg_subcategory
    requiresValue: false
    showOnReleaseStart: false
    label: Change SubCategory
    description: For Regular Release Please select " Scheduled Release " and For Offcycle
      Release Please Select " General " options.
    valueProvider:
      type: xlrelease.ListOfStringValueProviderConfiguration
      values:
      - Scheduled Release
      - General
      - Code Changes
      - Database
    value: Scheduled Release
  - type: xlrelease.StringVariable
    key: chg_template
    requiresValue: false
    showOnReleaseStart: false
    label: Change Template to be Applied
    valueProvider:
      type: xlrelease.ListOfStringValueProviderConfiguration
      values:
      - DPEP Cloud Live v1
      - DPEP Cloud Live v1.1
      - DPEP Live
      - DPEP Not Live
    value: DPEP Live
  - type: xlrelease.StringVariable
    key: blackout_scope
    label: Is There Any Change Management Freeze?
    description: Do we have any SOX / Year End / Finance / Monthly-Weekend / WDW -
      DLR Freeze Going On
    valueProvider:
      type: xlrelease.ListOfStringValueProviderConfiguration
      values:
      - NA
      - This application does not come under Financial Impact for the blackout. It
        is not part of any PCI application. This Change has been discussed and approved
        by Senior Manager  for PROD launch
    value: NA
  - type: xlrelease.StringVariable
    key: ReleaseStakeHolders
    requiresValue: false
    showOnReleaseStart: false
    label: Release Stake Holders
    description: "Ensure to add stakeholders such as Technical Manager, Service Owner,\
      \ and any others per your Studio's requirements. Emails added will get notifications.\
      \ Email ID should be separated with comma."
    value: "Mohisin.Anwar.Mohammed.-ND@disney.com,Cynthia.Cardona@disney.com"
    multiline: true
  - type: xlrelease.StringVariable
    key: build_version
    requiresValue: false
    label: Build Version
    description: "Please Provide Harness Build Version. ( EX: v1.2.0-4596 )"
  - type: xlrelease.BooleanVariable
    key: bypass_build_stage
    label: Deploy To Stage
    description: checkbox/Enable this field if deploy is to be performed in stage
      environment.
  - type: xlrelease.BooleanVariable
    key: bypass_build_load
    label: Deploy to Load
    description: checkbox/Enable this field if deploy is to be performed in load environment.
  - type: xlrelease.StringVariable
    key: GQEStakeHolders
    requiresValue: false
    showOnReleaseStart: false
    label: GQE Stake Holders
    description: Ensure to add GQE Stake Holders who will be a part of this release
      for reviewing/approving. Emails added will get notifications.
    value: "Siddharthan.X.Rajendran.-ND@disney.com,Kshama.X.Pawar.-ND@disney.com,Brent.Hohn@disney.com,quijano@disney.com,bhanu.kiran.x.pabbathi.-nd@disney.com,gowri.shankar.x.chellapandi.selvi.-nd@disney.com"
    multiline: true
  - type: xlrelease.StringVariable
    key: PEStakeHolders
    requiresValue: false
    showOnReleaseStart: false
    label: PE Stake Holders
    description: Ensure to add PE Stake Holders who will be a part of this release
      for reviewing/approving . Emails added will get notifications.
    value: "Nikhil.X.Kale.-ND@disney.com,Charles.Piazza@disney.com,Cody.A.Stull@disney.com"
    multiline: true
  - type: xlrelease.BooleanVariable
    key: chg_qa_nimbus
    requiresValue: false
    label: SE - Nimbus/Vault QA (Stage&Load) CTask
    description: checkbox/Enable this field if nimbus task is needed to be created
      in the CRQ
  - type: xlrelease.BooleanVariable
    key: chg_nimbus
    label: SE - Nimbus/Vault Prod CTask
    description: checkbox/Enable this field if nimbus task is needed to be created
      in the CRQ
  - type: xlrelease.StringVariable
    key: nimbus_info
    requiresValue: false
    label: Prod Nimbus Information
    description: "If you have any Nimbus Changes Then Please provide for Lower and\
      \ Higher Env's. NOTE: if you dont know the changes then PLEASE REPLACE NA with\
      \ SE Will Perform The CHanges"
    value: SE Changes - NA
    multiline: true
  - type: xlrelease.StringVariable
    key: rollback_version
    label: Build Version To Rollback to Prod Live Side
  - type: xlrelease.StringVariable
    key: rollback_info
    requiresValue: false
    label: Production Rollback Instructions
    value: |-
      SE/Database RollBack Instructions: ( Enter step by step instructions if any )

      ====================================================
      Application RollBack Instructions ( Toggle off etc ): ( Enter step by step instructions if any )
    multiline: true
  - type: xlrelease.StringVariable
    key: commit_id
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: build_status
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: channel_
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: qa_sys_id
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: qa_crq_number
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.MapStringStringVariable
    key: qa_crq_data
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.MapStringStringVariable
    key: stage_ctask_data
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: stage_ctask_sys_id
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: stage_ctask_number
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.MapStringStringVariable
    key: load_ctask_data
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: load_ctask_sys_id
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: load_ctask_number
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.MapStringStringVariable
    key: prod_crq_data
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: prod_crq_number
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.MapStringStringVariable
    key: prod_deploy_ctask_data
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: prod_deploy_ctask_sys_id
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: prod_deploy_ctask_number
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: prod_crq_sys_id
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: prod_sys_id
    showOnReleaseStart: false
  - type: xlrelease.MapStringStringVariable
    key: prod_build_validation_ctask_data
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: prod_build_validation_ctask_sys_id
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: prod_build_validation_ctask_number
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.MapStringStringVariable
    key: loadvalidation_ctask_data
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: loadvalidation_ctask_sys_id
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: loadvalidation_ctask_number
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.MapStringStringVariable
    key: stagevalidation_ctask_data
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: stagevalidation_ctask_sys_id
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: stagevalidation_ctask_number
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: stage.env
    requiresValue: false
    showOnReleaseStart: false
    label: AWS Stage Env
    value: AWS Staging
  - type: xlrelease.StringVariable
    key: chg_assignment_group
    requiresValue: false
    showOnReleaseStart: false
    label: Change Assignment group
    value: chc-global-chcoo
  - type: xlrelease.StringVariable
    key: ctaskassignment_group
    requiresValue: false
    showOnReleaseStart: false
    label: CTASK Assignment Group
  - type: xlrelease.StringVariable
    key: source_branch
    requiresValue: false
    showOnReleaseStart: false
    label: Branch to Cut From
    value: develop
  - type: xlrelease.StringVariable
    key: stage_deploy_job_number
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: stage_Deploy_job_status
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: stage_validation_response
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: load_validation_response
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: Description
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: bump_version
    requiresValue: false
    showOnReleaseStart: false
    label: Bumping Version To Next Release
    value: 0.0.0
  - type: xlrelease.StringVariable
    key: branch_to_bump
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: start_date
    requiresValue: false
    showOnReleaseStart: false
    label: Production Planned Start Date
    description: YYYY-MM-DD
  - type: xlrelease.StringVariable
    key: end_date
    requiresValue: false
    showOnReleaseStart: false
    label: Production Planned End Date
    description: YYYY-MM-DD
  - type: xlrelease.StringVariable
    key: buildjobname
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: deployjobname
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: app_stageOutput
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: load_deploy_job_number
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: load_Deploy_job_status
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.MapStringStringVariable
    key: loadpe_ctask_data
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: loadpe_ctask_sys_id
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: loadpe_ctask_number
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.MapStringStringVariable
    key: stagegqe_ctask_data
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: stagegqe_ctask_sys_id
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: stagegqe_ctask_number
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.MapStringStringVariable
    key: loadsdetvalidation_ctask_data
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: loadsdetvalidation_ctask_sys_id
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: loadsdetvalidation_ctask_number
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.MapStringStringVariable
    key: stagesdetvalidation_ctask_data
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: stagesdetvalidation_ctask_sys_id
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: stagesdetvalidation_ctask_number
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: stagedeploy_ctask_number
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: stagesdet_ctask_number
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: loadsdet_ctask_number
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.MapStringStringVariable
    key: sdet_ctask_data
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: app_loadOutput
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.MapStringStringVariable
    key: DLR Guest Resort Reservation WebAPI
    requiresValue: false
    showOnReleaseStart: false
    value:
      app_brand: DLR
      chg_ctaskassignment_group: web-global-saleslodging
      chg_peerapproval_group: apv-global-rocket
      app_stagevalidateendpoint: https://stage.disneyland.disney.go.com/my-hotel-reservation/api/v1/healthcheck
      project_key: dlr-revmgmt-guestresortres-api
      app_bappid: BAPP0179297
      app_prodvalidateendpoint: https://disneyland.disney.go.com/my-hotel-reservation/api/v1/healthcheck
      app_buildjob: dlr-revmgmt-guestresortres-api/job/dlr-revmgmt-guestresortres-api-single-repo
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      sonar_codequalitygate: dlr-revmgmt-guestresortres-api
      app_loadvalidateendpoint: https://lt01.disneyland.disney.go.com/my-hotel-reservation/api/v1/healthcheck
      app_gitrepo: dlr-revmgmt-guestresortres-api
      app_deployjob: dlr-revmgmt-guestresortres-api/job/dlr-revmgmt-guestresortres-api-aws-live
      service_owner: william.l.johnson@disney.com
      app_gitorg: wdprd-development
  - type: xlrelease.MapStringStringVariable
    key: DLR Resort Reservation View Assembly
    requiresValue: false
    showOnReleaseStart: false
    value:
      app_stagevalidateendpoint: https://stage.resort-reservation-dlr.wdprapps.disney.com/resort-reservation-va/info
      app_brand: DLR
      chg_ctaskassignment_group: web-global-saleslodging
      app_buildjob: dlr-revmgmt-resortreserv-va/job/dlr-revmgmt-resortreserv-va-single-repo
      chg_peerapproval_group: apv-global-rocket
      load_test: NA
      sonar_codequalitygate: com.disney.dlr.resortreserv:dlr-resortreserv-va
      app_gitorg: wdprt-paap-api
      app_gitrepo: dlr-revmgmt-resortreserv-va
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      project_key: com.disney.dlr.resortreserv:dlr-resortreserv-va
      stage_test: XLR-Test-Automation/job/Rocket/job/RocketResortReservationVA/
      app_loadvalidateendpoint: https://load.resort-reservation-dlr.wdprapps.disney.com/resort-reservation-va/info
      app_bappid: BAPP0179217
      shield_report: XLR-Test-Automation/job/Rocket/job/RocketResortReservationVA/SHIELD_20Report/
      app_deployjob: dlr-revmgmt-resortreserv-va/job/dlr-revmgmt-resortreserv-va-aws-live
      app_prodvalidateendpoint: https://resort-reservation-dlr.wdprapps.disney.com/resort-reservation-va/info
      service_owner: william.l.johnson@disney.com
  - type: xlrelease.MapStringStringVariable
    key: DLR Guest Resort Reservation SPA
    requiresValue: false
    showOnReleaseStart: false
    value:
      app_brand: DLR
      chg_ctaskassignment_group: web-global-saleslodging
      sonar_codequalitygate: dlr-revmgmt-guestresortres-spa
      chg_peerapproval_group: apv-global-rocket
      app_gitrepo: dlr-revmgmt-guestresortres-spa
      app_loadvalidateendpoint: https://lt01.disneyland.disney.go.com/my-hotel-reservation/spa/healthreport
      app_buildjob: dlr-revmgmt-guestresortres-spa/job/dlr-revmgmt-guestresortres-spa-single-repo
      app_deployjob: dlr-revmgmt-guestresortres-spa/job/dlr-revmgmt-guestresortres-spa-aws-live
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      app_bappid: BAPP0179317
      project_key: dlr-revmgmt-guestresortres-spa
      app_prodvalidateendpoint: https://disneyland.disney.go.com/my-hotel-reservation/spa/healthreport
      app_stagevalidateendpoint: https://stage.disneyland.disney.go.com/my-hotel-reservation/spa/healthreport
      service_owner: william.l.johnson@disney.com
      app_gitorg: wdprd-development
  - type: xlrelease.MapStringStringVariable
    key: DLR Package Entitlement Service
    requiresValue: false
    showOnReleaseStart: false
    value:
      app_brand: DLR
      chg_ctaskassignment_group: web-global-saleslodging
      chg_peerapproval_group: apv-global-rocket
      project_key: com.disney.dlr.pkgentitlement:dlr-pkgentitlement-svc
      app_prodvalidateendpoint: https://package-entitlement-dlr.wdprapps.disney.com/package-entitlement-svc/info
      app_bappid: BAPP0179197
      app_gitrepo: dlr-revmgmt-pkgentitlement-svc
      app_gitorg: wdprt-paap-api
      app_loadvalidateendpoint: https://load.package-entitlement-dlr.wdprapps.disney.com/package-entitlement-svc/info
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      app_buildjob: dlr-revmgmt-pkgentitlement-svc/job/dlr-revmgmt-pkgentitlement-svc-single-repo
      sonar_codequalitygate: com.disney.dlr.pkgentitlement:dlr-pkgentitlement-svc
      app_deployjob: dlr-revmgmt-pkgentitlement-svc/job/dlr-revmgmt-pkgentitlement-svc-aws-live
      app_stagevalidateendpoint: https://stage.package-entitlement-dlr.wdprapps.disney.com/package-entitlement-svc/info
      service_owner: william.l.johnson@disney.com
  - type: xlrelease.MapStringStringVariable
    key: DLR Ticket and Voucher Batch
    requiresValue: false
    showOnReleaseStart: false
    value:
      app_brand: DLR
      app_buildjob: dlr-revmgmt-ticketvoucher-batch/job/dlr-revmgmt-ticketvoucher-batch-single-repo
      chg_ctaskassignment_group: web-global-saleslodging
      app_bappid: BAPP0180041
      app_gitrepo: dlr-revmgmt-ticketvoucher-batch
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      chg_peerapproval_group: apv-global-rocket
      app_deployjob: dlr-revmgmt-ticketvoucher-batch/job/dlr-revmgmt-ticketvoucher-batch-aws-live
      service_owner: william.l.johnson@disney.com
      app_gitorg: wdprd-development
  - type: xlrelease.MapStringStringVariable
    key: DLR Ticket Order Batch
    requiresValue: false
    showOnReleaseStart: false
    value:
      app_brand: DLR
      app_deployjob: dlr-revmgmt-ticketorder-batch/job/dlr-revmgmt-ticketorder-batch-aws-live
      chg_ctaskassignment_group: web-global-saleslodging
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      app_buildjob: dlr-revmgmt-ticketorder-batch/job/dlr-revmgmt-ticketorder-batch-single-repo
      chg_peerapproval_group: apv-global-rocket
      app_bappid: BAPP0180017
      app_gitrepo: dlr-revmgmt-ticketorder-batch
      service_owner: william.l.johnson@disney.com
      app_gitorg: wdprd-development
  - type: xlrelease.MapStringStringVariable
    key: DLR Cast Resort Reservation SPA
    requiresValue: false
    showOnReleaseStart: false
    value:
      app_brand: DLR
      app_prodvalidateendpoint: https://cast-resort-reservation-dlr.wdprapps.disney.com/spa/healthcheck
      sonar_codequalitygate: dlr-revmgmt-castresortres-spa
      chg_ctaskassignment_group: web-global-saleslodging
      chg_peerapproval_group: apv-global-rocket
      app_stagevalidateendpoint: https://stage.cast-resort-reservation-dlr.wdprapps.disney.com/spa/healthcheck
      app_buildjob: dlr-revmgmt-castresortres-spa/job/dlr-revmgmt-castresortres-spa-single-repo
      app_gitrepo: dlr-revmgmt-castresortres-spa
      app_loadvalidateendpoint: https://load.cast-resort-reservation-dlr.wdprapps.disney.com/spa/healthcheck
      app_deployjob: dlr-revmgmt-castresortres-spa/job/dlr-revmgmt-castresortres-spa-aws-live
      app_bappid: BAPP0179277
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      project_key: dlr-revmgmt-castresortres-spa
      service_owner: william.l.johnson@disney.com
      app_gitorg: wdprd-development
  - type: xlrelease.MapStringStringVariable
    key: DLR Cast Resort Reservation WebAPI
    requiresValue: false
    showOnReleaseStart: false
    value:
      app_brand: DLR
      chg_ctaskassignment_group: web-global-saleslodging
      chg_peerapproval_group: apv-global-rocket
      project_key: dlr-revmgmt-castresortres-api
      app_prodvalidateendpoint: https://cast-resort-reservation-dlr.wdprapps.disney.com/api/v1/healthcheck
      app_deployjob: dlr-revmgmt-castresortres-api/job/dlr-revmgmt-castresortres-api-aws-live
      app_loadvalidateendpoint: https://load.cast-resort-reservation-dlr.wdprapps.disney.com/api/v1/healthcheck
      app_buildjob: dlr-revmgmt-castresortres-api/job/dlr-revmgmt-castresortres-api-single-repo
      app_bappid: BAPP0179257
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      sonar_codequalitygate: dlr-revmgmt-castresortres-api
      app_gitrepo: dlr-revmgmt-castresortres-api
      app_stagevalidateendpoint: https://stage.cast-resort-reservation-dlr.wdprapps.disney.com/api/v1/healthcheck
      service_owner: william.l.johnson@disney.com
      app_gitorg: wdprd-development
  - type: xlrelease.StringVariable
    key: app_jenkins_url
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: app_jenkins_deploy_url
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.BooleanVariable
    key: any_gqe_pe_defects
    requiresValue: false
    showOnReleaseStart: false
    label: any defects found in testing
    description: Please checkbox if there are any defects found which needs code to
      be redeployed and Tested
  - type: xlrelease.StringVariable
    key: filesChanged
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: commitLogs
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: initialTag
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: app_gitorg
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: app_gitrepo
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: loaddeploy_ctask_number
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: app_deployjob
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.MapStringStringVariable
    key: WDW Resort Details View Assembly
    requiresValue: false
    showOnReleaseStart: false
    value:
      service_owner: cynthia.cardona@disney.com
      app_brand: WDW
      chg_ctaskassignment_group: web-global-saleslodging
      app_bappid: BAPP0161375
      chg_peerapproval_group: apv-global-onlineapprovers
      app_loadvalidateendpoint: https://load.resort-details-va-wdw.wdprapps.disney.com/resort-details-va/info
      app_gitorg: wdprt-paap-api
      app_prodvalidateendpoint: https://resort-details-va-wdw.wdprapps.disney.com/resort-details-va/info
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      app_stagevalidateendpoint: https://stage.resort-details-va-wdw.wdprapps.disney.com/resort-details-va/info
      app_buildjob: wdw-revmgmt-resortdetails-va/job/wdw-revmgmt-resortdetails-va-single-repo
      project_key: |
        com.disney.wdw.resortdetails:wdw-resortdetails-va
      sonar_codequalitygate: com.disney.wdat.api:resort-details-va
      app_deployjob: wdw-revmgmt-resortdetails-va/job/wdw-revmgmt-resortdetails-va-aws-live
      app_gitrepo: wdw-revmgmt-resortdetails-va
  - type: xlrelease.MapStringStringVariable
    key: WDW Disney AddOns View Assembly
    requiresValue: false
    showOnReleaseStart: false
    value:
      service_owner: cynthia.cardona@disney.com
      app_brand: WDW
      chg_ctaskassignment_group: web-global-saleslodging
      app_loadvalidateendpoint: https://load.disney-addons-va-wdw.wdprapps.disney.com/disney-addons-va/info
      app_gitrepo: disney-addons-va
      project_key: com.disney.wdat.api:disney-addons-va
      app_buildjob: disney-addons-va/job/disney-addons-va-single-repo
      app_deployjob: disney-addons-va/job/disney-addons-va-aws-live
      chg_peerapproval_group: apv-global-onlineapprovers
      app_bappid: BAPP0161403
      app_gitorg: wdprt-paap-api
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      sonar_codequalitygate: com.disney.wdat.api:disney-addons-va
      app_stagevalidateendpoint: https://stage.disney-addons-va-wdw.wdprapps.disney.com/disney-addons-va/info
      app_prodvalidateendpoint: https://disney-addons-va-wdw.wdprapps.disney.com/disney-addons-va/info
  - type: xlrelease.MapStringStringVariable
    key: WDPR Resorts List View Assembly
    requiresValue: false
    showOnReleaseStart: false
    value:
      app_stagevalidateendpoint: https://stage.resorts-list-va-wdw.wdprapps.disney.com/svc/info
      service_owner: cynthia.cardona@disney.com
      app_brand: WDW
      sonar_codequalitygate: com.disney.wdat.api.resortslistva:resorts-list-va
      app_bappid: BAPP0140536
      chg_ctaskassignment_group: web-global-saleslodging
      app_prodvalidateendpoint: https://resorts-list-va-wdw.wdprapps.disney.com/svc/info
      chg_peerapproval_group: apv-global-onlineapprovers
      app_gitorg: wdprt-paap-api
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      app_buildjob: resorts-list-va/job/resorts-list-va-single-repo
      app_deployjob: resorts-list-va/job/resorts-list-va-aws-live
      app_gitrepo: resorts-list-va
      app_loadvalidateendpoint: https://load.resorts-list-va-wdw.wdprapps.disney.com/svc/info
      project_key: com.disney.wdat.api.resortslistva:resorts-list-va
  - type: xlrelease.StringVariable
    key: service_owner
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.MapStringStringVariable
    key: WDW Parks as a Platform Package Service
    requiresValue: false
    showOnReleaseStart: false
    value:
      app_brand: WDW
      service_owner: steve.repp@disney.com
      project_key: com.disney.wdprt.paap.sales:package-service
      app_bappid: BAPP0084210
      app_prodvalidateendpoint: https://package-service.wdw.wdprapps.disney.com/package-service/application/info
      app_gitorg: wdprt-paap-api
      app_jenkins_base_url: https://packaging.cicd.wdprapps.disney.com/
      app_loadvalidateendpoint: https://load.package-service.wdw.wdprapps.disney.com/package-service/application/info
      app_deployjob: package-service/job/package-service-aws-live
      app_buildjob: package-service/job/package-service-single-repo
      app_gitrepo: package-service
      sonar_codequalitygate: com.disney.wdprt.paap.sales:package-service
      app_stagevalidateendpoint: https://stage.package-service.wdw.wdprapps.disney.com/package-service/application/info
      chg_peerapproval_group: |
        apv-global-defenders
      chg_ctaskassignment_group: app-flcorp-l3defenders
  - type: xlrelease.MapStringStringVariable
    key: WDW Package Offer Service
    requiresValue: false
    showOnReleaseStart: false
    value:
      app_deployjob: package-offer-service/job/package-offer-service-aws-live
      app_brand: WDW
      app_stagevalidateendpoint: https://stage.package-offer-svc.wdw.wdprapps.disney.com/application/info
      app_prodvalidateendpoint: https://package-offer-svc.wdw.wdprapps.disney.com/application/info
      service_owner: steve.repp@disney.com
      sonar_codequalitygate: com.disney.dre.api:package-offer-service
      app_buildjob: package-offer-service/job/package-offer-service-single-repo
      app_gitorg: wdprt-paap-api
      app_loadvalidateendpoint: https://load.package-offer-svc.wdw.wdprapps.disney.com/application/info
      app_gitrepo: package-offer-service
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      chg_peerapproval_group: apv-global-eternals
      project_key: com.disney.dre.api:package-offer-service
      chg_ctaskassignment_group: app-flcorp-l3defenders
      app_bappid: BAPP0132343
  - type: xlrelease.MapStringStringVariable
    key: WDW Mobile Resort Reservation Api
    requiresValue: false
    showOnReleaseStart: false
    value:
      app_stagevalidateendpoint: https://stage.disneyworld.disney.go.com/resort-reservation/api/v1/version
      service_owner: cynthia.cardona@disney.com
      app_brand: WDW
      chg_peerapproval_group: apv-global-onlineapprovers
      app_loadvalidateendpoint: https://lt01.disneyworld.disney.go.com/resort-reservation/api/v1/version
      project_key: mobile-resort-reservation-api
      sonar_codequalitygate: mobile-resort-reservation-api
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      app_deployjob: mobile-resort-reservation-api/job/mobile-resort-reservation-api-aws-live
      app_prodvalidateendpoint: https://disneyworld.disney.go.com/resort-reservation/api/v1/version
      app_buildjob: mobile-resort-reservation-api/job/mobile-resort-reservation-api-single-repo
      app_bappid: BAPP0138318
      app_gitorg: wdprd-development
      app_gitrepo: mobile-resort-reservation-api
  - type: xlrelease.StringVariable
    key: gqe_condition
    requiresValue: false
    showOnReleaseStart: false
    valueProvider:
      type: xlrelease.ListOfStringValueProviderConfiguration
      values:
      - "True"
      - "False"
    value: "True"
  - type: xlrelease.StringVariable
    key: pe_condition
    requiresValue: false
    showOnReleaseStart: false
    valueProvider:
      type: xlrelease.ListOfStringValueProviderConfiguration
      values:
      - "True"
      - "False"
    value: "True"
  - type: xlrelease.MapStringStringVariable
    key: WDPR Lodging Addon Web API
    requiresValue: false
    showOnReleaseStart: false
    value:
      service_owner: cynthia.cardona@disney.com
      app_brand: WDW
      app_deployjob: wdpr-resorts-addons-api/job/wdpr-resorts-addons-api-aws-live
      app_gitrepo: wdpr-resorts-addons-api
      sonar_codequalitygate: wdpr-resorts-addons-api
      chg_peerapproval_group: apv-global-onlineapprovers
      app_loadvalidateendpoint: https://lt01.disneyworld.disney.go.com/wdpr-resorts-addons-api/api/v1/healthcheck
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      project_key: wdpr-resorts-addons-api
      app_prodvalidateendpoint: https://disneyworld.disney.go.com/wdpr-resorts-addons-api/api/v1/healthcheck
      app_bappid: BAPP0104622
      app_stagevalidateendpoint: https://stage.disneyworld.disney.go.com/wdpr-resorts-addons-api/api/v1/healthcheck
      app_buildjob: wdpr-resorts-addons-api/job/wdpr-resorts-addons-api-single-repo
      app_gitorg: wdprd-development
  - type: xlrelease.MapStringStringVariable
    key: WDPR Lodging Add Ons SPA
    requiresValue: false
    showOnReleaseStart: false
    value:
      service_owner: cynthia.cardona@disney.com
      app_brand: WDW
      app_buildjob: wdpr-resorts-addons-spa/job/wdpr-resorts-addons-spa-single-repo
      chg_peerapproval_group: apv-global-onlineapprovers
      app_bappid: BAPP0104690
      project_key: wdpr-resorts-addons-spa
      app_loadvalidateendpoint: https://lt01.disneyworld.disney.go.com/wdpr-resorts-addons-spa/constant
      sonar_codequalitygate: wdpr-resorts-addons-spa
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      app_deployjob: wdpr-resorts-addons-spa/job/wdpr-resorts-addons-spa-aws-live
      app_stagevalidateendpoint: https://stage.disneyworld.disney.go.com/wdpr-resorts-addons-spa/constant
      app_prodvalidateendpoint: https://disneyworld.disney.go.com/wdpr-resorts-addons-spa/constant
      app_gitrepo: wdpr-resorts-addons-spa
      app_gitorg: wdprd-development
  - type: xlrelease.MapStringStringVariable
    key: WDPR  Resort Package VA Service
    requiresValue: false
    showOnReleaseStart: false
    value:
      service_owner: cynthia.cardona@disney.com
      app_brand: WDW
      app_loadvalidateendpoint: https://load.resort-package-va.wdw.wdprapps.disney.com/resort-package-va/application/info
      app_gitrepo: resort-package-va-service
      chg_ctaskassignment_group: web-global-saleslodging
      app_stagevalidateendpoint: https://stage.resort-package-va.wdw.wdprapps.disney.com/resort-package-va/application/info
      app_bappid: BAPP0084195
      app_buildjob: resort-package-va-service/job/resort-package-va-service-single-repo
      sonar_codequalitygate: com.disney.wdat.api.resortpackageva:resort-package-va
      chg_peerapproval_group: apv-global-onlineapprovers
      app_gitorg: wdprt-paap-api
      app_deployjob: resort-package-va-service/job/resort-package-va-service-aws-live
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      project_key: com.disney.wdat.api.resortpackageva:resort-package-va
      app_prodvalidateendpoint: https://resort-package-va.wdw.wdprapps.disney.com/resort-package-va/application/info
  - type: xlrelease.MapStringStringVariable
    key: WDW Parks as a Platform Room Pricing Service
    requiresValue: false
    showOnReleaseStart: false
    value:
      app_bappid: BAPP0083720
      app_brand: WDW
      app_stagevalidateendpoint: https://stage.room-pricing.wdw.wdprapps.disney.com/room-pricing/application/info
      app_buildjob: room-pricing-service/job/room-pricing-service-single-repo
      service_owner: steve.repp@disney.com
      chg_peerapproval_group: apv-global-defenders
      app_loadvalidateendpoint: https://load.room-pricing.wdw.wdprapps.disney.com/room-pricing/application/info
      sonar_codequalitygate: com.disney.wdat.api:room-pricing-service
      app_deployjob: room-pricing-service/job/room-pricing-service-aws-live
      app_gitorg: wdprt-paap-api
      app_gitrepo: room-pricing-service
      app_prodvalidateendpoint: https://room-pricing.wdw.wdprapps.disney.com/room-pricing/application/info
      project_key: com.disney.wdat.api:room-pricing-service
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      chg_ctaskassignment_group: app-flcorp-l3defenders
  - type: xlrelease.MapStringStringVariable
    key: DLR Parks as a Platform Package Service
    requiresValue: false
    showOnReleaseStart: false
    value:
      app_brand: DLR
      app_loadvalidateendpoint: https://load.package-service.dlr.wdprapps.disney.com/package-service/application/info
      app_bappid: BAPP0200676
      service_owner: steve.repp@disney.com
      chg_peerapproval_group: apv-global-defenders
      app_stagevalidateendpoint: https://stage.package-service.dlr.wdprapps.disney.com/package-service/application/info
      project_key: com.disney.wdprt.paap.sales:Apackage-service
      app_gitorg: wdprt-paap-api
      app_jenkins_base_url: https://packaging.cicd.wdprapps.disney.com/
      app_deployjob: package-service/job/package-service-aws-live
      chg_ctaskassignment_group: app-cacorp-l3defenders
      app_prodvalidateendpoint: https://package-service.dlr.wdprapps.disney.com/package-service/application/info
      app_buildjob: package-service/job/package-service-single-repo
      app_gitrepo: package-service
  - type: xlrelease.MapStringStringVariable
    key: WDPR Marketing Offer VA Service
    requiresValue: false
    showOnReleaseStart: false
    value:
      service_owner: cynthia.cardona@disney.com
      app_brand: WDW
      app_prodvalidateendpoint: https://marketing-offer-va.wdw.wdprapps.disney.com/marketing-offer-va/application/info
      app_bappid: BAPP0083750
      chg_peerapproval_group: apv-global-onlineapprovers
      app_deployjob: marketing-offer-va-service/job/marketing-offer-va-service-aws-live
      app_gitorg: wdprt-paap-api
      app_buildjob: marketing-offer-va-service/job/marketing-offer-va-service-single-repo
      project_key: com.disney.wdat.api:room-pricing-service
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      sonar_codequalitygate: com.disney.wdprt.paap.sales:marketing-offer-va-service
      app_loadvalidateendpoint: https://load.marketing-offer-va.wdw.wdprapps.disney.com/marketing-offer-va/application/info
      app_stagevalidateendpoint: https://stage.marketing-offer-va.wdw.wdprapps.disney.com/marketing-offer-va/application/info
      app_gitrepo: marketing-offer-va-service
  - type: xlrelease.MapStringStringVariable
    key: WDW Parks As a Platform Marketing Offer Service
    requiresValue: false
    showOnReleaseStart: false
    value:
      app_brand: WDW
      app_bappid: BAPP0083735
      sonar_codequalitygate: com.disney.wdat.api:marketing-offer-service
      service_owner: steve.repp@disney.com
      chg_peerapproval_group: apv-global-defenders
      app_prodvalidateendpoint: https://marketing-offer.wdw.wdprapps.disney.com/marketing-offer/application/info
      app_gitorg: wdprt-paap-api
      app_deployjob: marketing-offer-service/job/marketing-offer-service-aws-live
      app_jenkins_base_url: https://packaging.cicd.wdprapps.disney.com/
      app_gitrepo: marketing-offer-service
      app_stagevalidateendpoint: https://stage.marketing-offer.wdw.wdprapps.disney.com/marketing-offer/application/info
      project_key: com.disney.wdat.api:marketing-offer-service
      chg_ctaskassignment_group: app-flcorp-l3defenders
      app_loadvalidateendpoint: https://load.marketing-offer.wdw.wdprapps.disney.com/marketing-offer/application/info
      app_buildjob: marketing-offer-service/job/marketing-offer-service-single-repo
  - type: xlrelease.MapStringStringVariable
    key: WDPR Accommodation Facility Service
    requiresValue: false
    showOnReleaseStart: false
    value:
      app_brand: WDW
      service_owner: steve.repp@disney.com
      app_gitrepo: accommodation-facility-service
      project_key: com.disney.wdat.api:accommodation-facility-service
      app_bappid: BAPP0140164
      app_deployjob: accommodation-facility-service/job/accommodation-facility-service-aws-live
      app_gitorg: wdprt-paap-api
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      app_buildjob: accommodation-facility-service/job/accommodation-facility-service-single-repo
      sonar_codequalitygate: com.disney.wdat.api:accommodation-facility-service
      app_stagevalidateendpoint: https://stage.accommodation-facility-svc.wdw.wdprapps.disney.com/application/info
      chg_peerapproval_group: apv-global-eternals
      app_prodvalidateendpoint: https://accommodation-facility-svc.wdw.wdprapps.disney.com/application/info
      app_loadvalidateendpoint: https://load.accommodation-facility-svc.wdw.wdprapps.disney.com/application/info
  - type: xlrelease.MapStringStringVariable
    key: WDW Mobile Resort Reservation Spa
    requiresValue: false
    showOnReleaseStart: false
    value:
      service_owner: cynthia.cardona@disney.com
      app_brand: WDW
      app_deployjob: mobile-resort-reservation-spa/job/mobile-resort-reservation-spa-aws-live
      app_gitrepo: mobile-resort-reservation-spa
      sonar_codequalitygate: mobile-resort-reservation-spa
      app_prodvalidateendpoint: https://disneyworld.disney.go.com/resort-reservation/healthcheck
      chg_peerapproval_group: apv-global-onlineapprovers
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      project_key: mobile-resort-reservation-spa
      app_stagevalidateendpoint: https://stage.disneyworld.disney.go.com/resort-reservation/healthcheck
      app_loadvalidateendpoint: https://lt01.disneyworld.disney.go.com/resort-reservation/healthcheck
      app_buildjob: mobile-resort-reservation-spa/job/mobile-resort-reservation-spa-single-repo
      app_bappid: BAPP0134215
      app_gitorg: wdprd-development
  - type: xlrelease.MapStringStringVariable
    key: WDW Mobile Resort Reservation VA
    requiresValue: false
    showOnReleaseStart: false
    value:
      service_owner: cynthia.cardona@disney.com
      app_brand: WDW
      chg_ctaskassignment_group: web-global-saleslodging
      app_bappid: BAPP0134195
      sonar_codequalitygate: com.disney.wdat.api:mobile-resort-reservation-va
      chg_peerapproval_group: apv-global-onlineapprovers
      app_loadvalidateendpoint: https://load.resort-reservation-va.wdprapps.disney.com/application/health
      app_prodvalidateendpoint: https://resort-reservation-va.wdprapps.disney.com/application/health
      app_stagevalidateendpoint: https://stage.resort-reservation-va.wdprapps.disney.com/application/health
      app_gitorg: wdprt-paap-api
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      project_key: com.disney.wdat.api:mobile-resort-reservation-va
      app_gitrepo: mobile-resort-reservation-va
      app_deployjob: mobile-resort-reservation-va/job/mobile-resort-reservation-va-aws-live
      app_buildjob: mobile-resort-reservation-va/job/mobile-resort-reservation-va-single-repo
  - type: xlrelease.MapStringStringVariable
    key: WDPR Resorts List Spa
    requiresValue: false
    showOnReleaseStart: false
    value:
      service_owner: cynthia.cardona@disney.com
      app_brand: WDW
      app_gitrepo: wdpr-resorts-list-spa
      app_prodvalidateendpoint: https://origin.resorts-list-wdw.wdprapps.disney.com/spa/healthreport
      app_stagevalidateendpoint: https://origin.stage.resorts-list-wdw.wdprapps.disney.com/spa/healthreport
      app_loadvalidateendpoint: https://origin.load.resorts-list-wdw.wdprapps.disney.com/spa/healthreport
      chg_peerapproval_group: apv-global-onlineapprovers
      sonar_codequalitygate: wdpr-resorts-list-spa
      app_buildjob: wdpr-resorts-list-spa/job/wdpr-resorts-list-spa-single-repo
      app_bappid: BAPP0140580
      app_deployjob: wdpr-resorts-list-spa/job/wdpr-resorts-list-spa-aws-live
      project_key: wdpr-resorts-list-spa
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      app_gitorg: wdprd-development
  - type: xlrelease.MapStringStringVariable
    key: WDPR Resorts List API
    requiresValue: false
    showOnReleaseStart: false
    value:
      service_owner: cynthia.cardona@disney.com
      app_brand: WDW
      app_stagevalidateendpoint: https://origin.stage.resorts-list-wdw.wdprapps.disney.com/api/v1/healthreport
      app_bappid: BAPP0140556
      sonar_codequalitygate: wdpr-resorts-list-api
      app_gitrepo: wdpr-resorts-list-api
      app_buildjob: wdpr-resorts-list-api/job/wdpr-resorts-list-api-single-repo
      chg_peerapproval_group: apv-global-onlineapprovers
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      app_deployjob: wdpr-resorts-list-api/job/wdpr-resorts-list-api-aws-live
      app_loadvalidateendpoint: https://origin.load.resorts-list-wdw.wdprapps.disney.com/api/v1/healthreport
      app_prodvalidateendpoint: https://origin.resorts-list-wdw.wdprapps.disney.com/api/v1/healthreport
      project_key: wdpr-resorts-list-api
      app_gitorg: wdprd-development
  - type: xlrelease.StringVariable
    key: app_bappid
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: gqe_approver
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: pe_approver
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: qa_crq_impl_ctask_sysid
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: qa_crq_val_ctask_sysid
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: prod_crq_impl_ctask_sysid
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: prod_crq_aoe_supp_ctask_number
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.MapStringStringVariable
    key: prod_nimbus_ctask_data
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: prod_nimbus_ctask_sysid
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: prod_nimbus_ctask_number
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.MapStringStringVariable
    key: prod_build_deploy_ctask_data
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: prod_build_deploy_ctask_sys_id
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: prod_build_deploy_ctask_number
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: prod_crq_val_ctask_sysid
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: prod_crq_sdet_val_ctask_number
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.MapStringStringVariable
    key: prod_vision_validation_ctask_data
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: prod_vision_validation_ctask_sys_id
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: prod_vision_validation_ctask_number
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.MapStringStringVariable
    key: prod_gqe_validation_ctask_data
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: prod_gqe_validation_ctask_sys_id
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: prod_gqe_validation_ctask_number
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.MapStringStringVariable
    key: prod_lead_validation_ctask_data
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: prod_lead_validation_ctask_sys_id
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: prod_lead_validation_ctask_number
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.MapStringStringVariable
    key: prod_aoe_monitor_ctask_data
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: prod_aoe_monitor_ctask_sys_id
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: prod_aoe_monitor_ctask_number
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.MapStringStringVariable
    key: prod_aoe_enable_ctask_data
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: prod_aoe_enable_ctask_sys_id
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: prod_aoe_enable_ctask_number
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.MapStringStringVariable
    key: loadaoevalidation_ctask_data
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: loadaoevalidation_ctask_sys_id
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: loadaoevalidation_ctask_number
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.MapStringStringVariable
    key: stageaoevalidation_ctask_data
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: stageaoevalidation_ctask_sys_id
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: stageaoevalidation_ctask_number
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.MapStringStringVariable
    key: qa_nimbus_ctask_data
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: qa_nimbus_ctask_sysid
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: qa_nimbus_ctask_number
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.MapStringStringVariable
    key: stage_nimbus_ctask_data
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: stage_nimbus_ctask_sysid
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: stage_nimbus_ctask_number
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.MapStringStringVariable
    key: load_nimbus_ctask_data
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: load_nimbus_ctask_sysid
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: load_nimbus_ctask_number
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: start
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: end
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.BooleanVariable
    key: skip_chgreschedule
    showOnReleaseStart: false
    label: Do We Need To Reschedule CHG ?
    description: Checkbox/Enable - To Reschedule PROD CHG (or) Leave it unchecked
      - If PROD CHG does not need to Reschedule
  - type: xlrelease.MapStringStringVariable
    key: DLR
    requiresValue: false
    showOnReleaseStart: false
    value:
      start: 03:00:00
      backout_rollback_time: 07:30:00
      std_mnt_window: "[03:00 - 09:00]"
      end: 09:00:00
  - type: xlrelease.MapStringStringVariable
    key: WDW
    requiresValue: false
    showOnReleaseStart: false
    value:
      end: 06:00:00
      start: 23:00:00
      std_mnt_window: "[23:00 - 06:00]"
      backout_rollback_time: 04:30:00
  - type: xlrelease.ListStringVariable
    key: app_brand
    requiresValue: false
    showOnReleaseStart: false
    label: Application Brand
    value:
    - DLR
    - WDW
    - WDPR
  - type: xlrelease.StringVariable
    key: std_mnt_window
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: backout_rollback_time
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.BooleanVariable
    key: restart_ccb
    requiresValue: false
    showOnReleaseStart: false
    label: Do you want to restart CCB Phase?
    description: Checkbox/Enable this field to restart CCB Phase
  - type: xlrelease.StringVariable
    key: chg_peerapproval_group
    requiresValue: false
    showOnReleaseStart: false
    label: Change Peer Approval Group
    value: apv-global-rocket
  - type: xlrelease.StringVariable
    key: project_key
    requiresValue: false
    showOnReleaseStart: false
    label: SonarQube Project Key for application
  - type: xlrelease.StringVariable
    key: vuln
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: code_smell
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: sec_hotspot
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: blocker_issues
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: critical_issues
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: major_issues
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: minor_issues
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: stage_inc_deploy_failure
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: load_inc_deploy_failure
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: overall_coverage
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.MapStringStringVariable
    key: DREAMS UI
    requiresValue: false
    showOnReleaseStart: false
    value:
      app_prodvalidateendpoint: https://dreamsui.wdprapps.disney.com/dpms/static/healthcheck
      app_brand: WDW
      chg_peerapproval_group: apv-global-slsmktui
      project_key: ""
      app_bappid: BAPP0012308
      app_buildjob: wdw-revmgmt-dreams-ui/job/wdw-revmgmt-dreams-ui-single-repo
      app_gitorg: WDPR-SALES-UI
      app_gitrepo: wdw-revmgmt-dreams-ui
      app_deployjob: wdw-revmgmt-dreams-ui/job/wdw-revmgmt-dreams-ui-aws-live
      app_stagevalidateendpoint: https://stage.dreamsui.wdprapps.disney.com/dpms/static/healthcheck
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      service_owner: sarah.reardon@disney.com
      app_loadvalidateendpoint: https://load.dreamsui.wdprapps.disney.com/dpms/static/healthcheck
  - type: xlrelease.MapStringStringVariable
    key: WDPR Passport
    requiresValue: false
    showOnReleaseStart: false
    value:
      app_brand: WDW
      chg_peerapproval_group: apv-global-slsmktui
      app_deployjob: wdpr-revmgmt-passport-ui/job/wdpr-revmgmt-passport-ui-aws-live
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      app_buildjob: wdpr-revmgmt-passport-ui/job/wdpr-revmgmt-passport-ui-single-repo
      project_key: ""
      app_gitrepo: wdpr-revmgmt-passport-ui
      chg_ctaskassignment_group: app-flwdw-pprtprd
      service_owner: sarah.reardon@disney.com
      app_gitorg: WDPR-SALES-UI
      app_bappid: BAPP0013343
  - type: xlrelease.MapStringStringVariable
    key: WDPR Payment Hub Service (Web API)
    requiresValue: false
    showOnReleaseStart: false
    value:
      app_brand: WDW
      chg_peerapproval_group: apv-global-slsmktui
      app_stagevalidateendpoint: https://stage.paymenthub.wdprapps.disney.com/api/health-check/full/html
      app_bappid: BAPP0160131
      project_key: payment-hub-webapi
      app_gitorg: WDPR-SALES-UI
      app_loadvalidateendpoint: https://load.paymenthub.wdprapps.disney.com/api/health-check/full/html
      app_buildjob: payment-hub-webapi/job/payment-hub-webapi-single-repo
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      app_prodvalidateendpoint: https://paymenthub.wdprapps.disney.com/api/health-check/full/html
      app_gitrepo: payment-hub-webapi
      app_deployjob: payment-hub-webapi/job/payment-hub-webapi-aws-live
      service_owner: sarah.reardon@disney.com
  - type: xlrelease.MapStringStringVariable
    key: WDPR Payment Hub UI (Web Client)
    requiresValue: false
    showOnReleaseStart: false
    value:
      app_brand: WDW
      chg_peerapproval_group: apv-global-slsmktui
      app_loadvalidateendpoint: https://load.paymenthub.wdprapps.disney.com/health-check/full/html
      project_key: payment-hub-client
      app_bappid: BAPP0160075
      app_gitorg: WDPR-SALES-UI
      app_stagevalidateendpoint: https://stage.paymenthub.wdprapps.disney.com/health-check/full/html
      app_prodvalidateendpoint: https://paymenthub.wdprapps.disney.com/health-check/full/html
      app_deployjob: payment-hub-client/job/payment-hub-client-aws-live
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      app_gitrepo: payment-hub-client
      app_buildjob: payment-hub-client/job/payment-hub-client-single-repo
      service_owner: sarah.reardon@disney.com
  - type: xlrelease.MapStringStringVariable
    key: WDPR payment-hub-session-handler
    requiresValue: false
    showOnReleaseStart: false
    value:
      app_brand: WDW
      chg_peerapproval_group: apv-global-slsmktui
      app_bappid: BAPP0191475
      app_deployjob: wdpr-payment-hub-session-handler/job/wdpr-payment-hub-session-handler-aws-live
      app_buildjob: wdpr-payment-hub-session-handler/job/wdpr-payment-hub-session-handler-single-repo
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      app_gitrepo: wdpr-payment-hub-session-handler
      service_owner: sarah.reardon@disney.com
      app_gitorg: WDPR-SALES-UI
  - type: xlrelease.MapStringStringVariable
    key: WDPR Ticket Sales UI
    requiresValue: false
    showOnReleaseStart: false
    value:
      app_buildjob: tui-api/job/tui-api-single-repo
      app_brand: WDW
      chg_peerapproval_group: apv-global-slsmktui
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      project_key: tui-api
      app_gitrepo: tui-api
      app_bappid: BAPP0080652
      service_owner: sarah.reardon@disney.com
      app_gitorg: WDPR-Release
      app_deployjob: tui-api/job/tui-api-aws-live
  - type: xlrelease.MapStringStringVariable
    key: WISHESUI-DVC
    requiresValue: false
    showOnReleaseStart: false
    value:
      app_brand: WDW
      chg_peerapproval_group: apv-global-slsmktui
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      app_gitrepo: wdpr-revmgmt-wishes-ui
      app_deployjob: wdpr-revmgmt-wishes-ui/job/wdpr-revmgmt-wishes-ui-aws-live
      app_buildjob: wdpr-revmgmt-wishes-ui/job/wdpr-revmgmt-wishes-ui-single-repo
      service_owner: sarah.reardon@disney.com
      app_gitorg: WDPR-SALES-UI
      app_bappid: BAPP0195038
      project_key: com.wdpr.bussvcs.wishes.ui:wishes-ui-parent
  - type: xlrelease.BooleanVariable
    key: deploy_fixed
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: app_prodOutput
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: stage_ccb_deploy_ctask_number
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: stage_ccb_deploy_ctask_sys_id
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: load_ccb_deploy_ctask_number
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: load_ccb_deploy_ctask_sys_id
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.MapStringStringVariable
    key: DLR Parks As A Platform Room Pricing Service
    requiresValue: false
    showOnReleaseStart: false
    value:
      app_brand: DLR
      app_buildjob: room-pricing-service/job/room-pricing-service-single-repo
      app_bappid: BAPP0200964
      service_owner: steve.repp@disney.com
      app_stagevalidateendpoint: https://stage.room-pricing.dlr.wdprapps.disney.com/room-pricing/application/info
      app_deployjob: room-pricing-service/job/room-pricing-service-aws-live
      app_gitorg: wdprt-paap-api
      app_gitrepo: room-pricing-service
      project_key: com.disney.wdat.api:room-pricing-service
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      chg_peerapproval_group: apv-global-eternals
      chg_ctaskassignment_group: app-global-loenv-supp
      app_loadvalidateendpoint: https://load.room-pricing.dlr.wdprapps.disney.com/room-pricing/application/info
      app_prodvalidateendpoint: https://room-pricing.dlr.wdprapps.disney.com/room-pricing/application/info
  - type: xlrelease.MapStringStringVariable
    key: DLR Parks As A Platform Marketing Offer Service
    requiresValue: false
    showOnReleaseStart: false
    value:
      app_brand: DLR
      service_owner: steve.repp@disney.com
      chg_peerapproval_group: apv-global-defenders
      app_bappid: BAPP0200988
      app_stagevalidateendpoint: https://stage.room-pricing.dlr.wdprapps.disney.com/room-pricing/application/info
      app_loadvalidateendpoint: https://load.marketing-offer.dlr.wdprapps.disney.com/marketing-offer/application/info
      app_gitorg: wdprt-paap-api
      app_deployjob: marketing-offer-service/job/marketing-offer-service-aws-live
      app_jenkins_base_url: https://packaging.cicd.wdprapps.disney.com/
      app_gitrepo: marketing-offer-service
      app_prodvalidateendpoint: https://marketing-offer.dlr.wdprapps.disney.com/marketing-offer/application/info
      chg_ctaskassignment_group: app-cacorp-l3defenders
      project_key: com.disney.wdat.api:marketing-offer-service
      app_buildjob: marketing-offer-service/job/marketing-offer-service-single-repo
  - type: xlrelease.MapStringStringVariable
    key: WDW Resort Reservation View Assembly
    requiresValue: false
    showOnReleaseStart: false
    value:
      service_owner: cynthia.cardona@disney.com
      app_brand: WDW
      chg_ctaskassignment_group: web-global-saleslodging
      app_gitrepo: wdw-revmgmt-resortreserv-va
      app_prodvalidateendpoint: https://resortreserv-va-wdw.wdprapps.disney.com/resort-reservation-va/info
      app_buildjob: wdw-revmgmt-resortreserv-va/job/wdw-revmgmt-resortreserv-va-single-repo
      chg_peerapproval_group: apv-global-onlineapprovers
      project_key: com.disney.wdat.api:resort-reservation-va
      app_gitorg: wdprt-paap-api
      app_bappid: BAPP0178387
      app_loadvalidateendpoint: https://load.resortreserv-va-wdw.wdprapps.disney.com/resort-reservation-va/info
      app_deployjob: wdw-revmgmt-resortreserv-va/job/wdw-revmgmt-resortreserv-va-aws-live
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      app_stagevalidateendpoint: https://stage.resortreserv-va-wdw.wdprapps.disney.com/resort-reservation-va/info
  - type: xlrelease.StringVariable
    key: ctask_purpose
    requiresValue: false
    showOnReleaseStart: false
    label: Purpose Of CTASK
    description: Purpose of Ctask which will be applied in SHORT Description of CTASK
  - type: xlrelease.StringVariable
    key: ctask_purpose_info
    requiresValue: false
    showOnReleaseStart: false
    label: Instructions to Implement the Purpose
    description: "CTASK Description Field will be Updated : Please provide detail\
      \ information on what instructions need to be implemented"
    multiline: true
  - type: xlrelease.StringVariable
    key: ctask_assignmentgroup
    requiresValue: false
    showOnReleaseStart: false
    label: Change Task Assignment Group
    description: Please enter the assignment group of team which implements the task
  - type: xlrelease.MapStringStringVariable
    key: stage_adhoc_ctask_data
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: stage_adhoc_ctask_sys_id
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: stage_adhoc_ctask_number
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.MapStringStringVariable
    key: load_adhoc_ctask_data
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: load_adhoc_ctask_sys_id
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: load_adhoc_ctask_number
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.BooleanVariable
    key: adhoc_ctask
    requiresValue: false
    showOnReleaseStart: false
    label: Need AdHoc Ctasks ?
    description: Do you need additional CTASKS ?
  - type: xlrelease.StringVariable
    key: ctask_type
    requiresValue: false
    showOnReleaseStart: false
    label: Change Task Type
    description: "Please select the type of the ctask. ( Note: If change is approved\
      \ then please select the type as \" UNPLANNED \""
    valueProvider:
      type: xlrelease.ListOfStringValueProviderConfiguration
      values:
      - implementation
      - validation
      - pre-work
      - pre-test
      - unplanned
    value: unplanned
  - type: xlrelease.StringVariable
    key: ccb_ticket_details
    requiresValue: false
    showOnReleaseStart: false
    label: CCB MYJIRA & GitHub PR Info
    description: Please Provide CCB JIra & GitHub PR Info
    multiline: true
  - type: xlrelease.MapStringStringVariable
    key: prod_adhoc_ctask_data
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: prod_adhoc_ctask_sys_id
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: prod_adhoc_ctask_number
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.MapStringStringVariable
    key: DVC Auto Member Information (AMI) API
    requiresValue: false
    showOnReleaseStart: false
    value:
      app_brand: WDW
      app_stagevalidateendpoint: https://stage.dvc-ami.wdprapps.disney.com/api/v1/version
      chg_peerapproval_group: apv-global-slsmktui
      app_gitrepo: dvc-ami-webapi
      app_prodvalidateendpoint: https://prod.dvc-ami.wdprapps.disney.com/api/v1/version
      app_bappid: BAPP0224467
      app_buildjob: dvc-ami-webapi/job/dvc-ami-webapi-single-repo
      app_gitorg: WDPR-SALES-UI
      chg_ctaskassignment_group: apv-global-slsmktui
      project_key: dvc-ami-webapi
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      app_deployjob: dvc-ami-webapi/job/dvc-ami-webapi-aws-live
      service_owner: sarah.reardon@disney.com
      app_loadvalidateendpoint: https://load.dvc-ami.wdprapps.disney.com/api/v1/version
  - type: xlrelease.MapStringStringVariable
    key: DVC Auto Member Information (AMI) UI
    requiresValue: false
    showOnReleaseStart: false
    value:
      app_deployjob: dvc-ami-ui/job/dvc-ami-ui-aws-live
      app_brand: WDW
      chg_peerapproval_group: apv-global-slsmktui
      app_buildjob: dvc-ami-ui/job/dvc-ami-ui-single-repo
      app_gitrepo: dvc-ami-ui
      chg_ctaskassignment_group: app-global-amisupp
      app_gitorg: WDPR-SALES-UI
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      app_loadvalidateendpoint: https://load.dvc-ami.wdprapps.disney.com/version
      project_key: dvc-ami-ui
      app_prodvalidateendpoint: https://prod.dvc-ami.wdprapps.disney.com/version
      app_bappid: BAPP0081459
      service_owner: sarah.reardon@disney.com
      app_stagevalidateendpoint: https://stage.dvc-ami.wdprapps.disney.com/version
  - type: xlrelease.BooleanVariable
    key: pass
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.BooleanVariable
    key: fail
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.BooleanVariable
    key: skip_qa
    requiresValue: false
    label: Create QA Change ?
    description: If you don't want to CREATE QA CHANGE THEN PLEASE UNCHECK THE BOX
      / DISABLE The Option
    value: true
  - type: xlrelease.BooleanVariable
    key: skip_prod
    requiresValue: false
    label: Create PROD Change ?
    description: If you don't want to CREATE PROD CHANGE THEN PLEASE UNCHECK THE BOX
      / DISABLE The Option
    value: true
  - type: xlrelease.StringVariable
    key: JiraTickets
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: chg_ctaskassignment_group
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: Latest Test Results
    requiresValue: false
    showOnReleaseStart: false
    label: Latest Test Results
    valueProvider:
      type: xlrelease.ListOfStringValueProviderConfiguration
      values:
      - Successful
      - In Progress
    value: Successful
  - type: xlrelease.MapStringStringVariable
    key: CCBJiraTicketDetails
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: CCBJiraTickets
    showOnReleaseStart: false
    label: Please Provide CCB MyJira Tickets & GitHub Pull Request Details
    multiline: true
  - type: xlrelease.StringVariable
    key: IR_AppRelDoc_link
    requiresValue: false
    showOnReleaseStart: false
    label: Provide SharePoint Link for the Testing Results and Validation Docs
  - type: xlrelease.StringVariable
    key: release_date
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.MapStringStringVariable
    key: DLR Resort Details Web API
    requiresValue: false
    showOnReleaseStart: false
    value:
      service_owner: cynthia.cardona@disney.com
      app_brand: DLR
      project_key: dlr-revmgmt-rstdetails-api
      chg_ctaskassignment_group: web-global-saleslodging
      app_prodvalidateendpoint: https://disneyland.disney.go.com/dlr-resort-details-api/api/v1/healthcheck/
      app_bappid: BAPP0225543
      app_deployjob: dlr-revmgmt-rstdetails-api/job/dlr-revmgmt-rstdetails-api-aws-live
      app_loadvalidateendpoint: https://lt01.disneyland.disney.go.com/dlr-resort-details-api/api/v1/healthcheck/
      chg_peerapproval_group: apv-global-onlineapprovers
      app_buildjob: dlr-revmgmt-rstdetails-api/job/dlr-revmgmt-rstdetails-api-single-repo
      app_gitrepo: dlr-revmgmt-rstdetails-api
      app_stagevalidateendpoint: https://stage.disneyland.disney.go.com/dlr-resort-details-api/api/v1/healthcheck/
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      app_gitorg: wdprd-development
  - type: xlrelease.MapStringStringVariable
    key: DLR Resort Details SPA
    requiresValue: false
    showOnReleaseStart: false
    value:
      service_owner: cynthia.cardona@disney.com
      app_brand: DLR
      chg_ctaskassignment_group: web-global-saleslodging
      app_gitrepo: dlr-revmgmt-rstdetails-spa
      app_prodvalidateendpoint: https://disneyland.disney.go.com/dlr-resort-details-spa/healthcheck/
      app_bappid: BAPP0225519
      chg_peerapproval_group: apv-global-onlineapprovers
      app_stagevalidateendpoint: https://stage.disneyland.disney.go.com/dlr-resort-details-spa/healthcheck/
      app_deployjob: dlr-revmgmt-rstdetails-spa/view/Deploy/job/dlr-revmgmt-rstdetails-spa-aws-live
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      app_buildjob: dlr-revmgmt-rstdetails-spa/job/dlr-revmgmt-rstdetails-spa-single-repo
      app_loadvalidateendpoint: https://lt01.disneyland.disney.go.com/dlr-resort-details-spa/healthcheck/
      project_key: dlr-revmgmt-rstdetails-spa
      app_gitorg: wdprd-development
  - type: xlrelease.MapStringStringVariable
    key: DLR Resort Details VA
    requiresValue: false
    showOnReleaseStart: false
    value:
      app_deployjob: dlr-revmgmt-rstdetails-va/job/dlr-revmgmt-rstdetails-va-aws-live
      service_owner: cynthia.cardona@disney.com
      app_brand: DLR
      chg_ctaskassignment_group: web-global-saleslodging
      chg_peerapproval_group: apv-global-onlineapprovers
      app_gitrepo: dlr-revmgmt-rstdetails-va
      app_gitorg: wdprt-paap-api
      app_loadvalidateendpoint: https://load.dlr-rst-details-va.wdprapps.disney.com/resort-details-va/info
      app_stagevalidateendpoint: https://stage.dlr-rst-details-va.wdprapps.disney.com/resort-details-va/info
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      project_key: com.disney.dlr.resortdetails:dlr-resortdetails-va
      app_prodvalidateendpoint: https://dlr-rst-details-va.wdprapps.disney.com/resort-details-va/info
      app_bappid: BAPP0225351
      app_buildjob: dlr-revmgmt-rstdetails-va/job/dlr-revmgmt-rstdetails-va-single-repo
  - type: xlrelease.MapStringStringVariable
    key: DLR Resort List VA
    requiresValue: false
    showOnReleaseStart: false
    value:
      service_owner: cynthia.cardona@disney.com
      app_brand: DLR
      app_loadvalidateendpoint: https://load.dlr-rst-list-va.wdprapps.disney.com/resort-list-va/info
      chg_ctaskassignment_group: web-global-saleslodging
      project_key: com.disney.wdat.api.resortslistva:dlr-revmgmt-rstlist-va
      app_buildjob: dlr-revmgmt-rstlist-va/job/dlr-revmgmt-rstlist-va-single-repo
      app_stagevalidateendpoint: https://stage.dlr-rst-list-va.wdprapps.disney.com/resort-list-va/info
      chg_peerapproval_group: apv-global-onlineapprovers
      app_gitorg: wdprt-paap-api
      app_gitrepo: dlr-revmgmt-rstlist-va
      app_prodvalidateendpoint: https://dlr-rst-list-va.wdprapps.disney.com/resort-list-va/info
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      app_deployjob: dlr-revmgmt-rstlist-va/job/dlr-revmgmt-rstlist-va-aws-live
      app_bappid: BAPP0225399
  - type: xlrelease.MapStringStringVariable
    key: DLR Resort List SPA
    requiresValue: false
    showOnReleaseStart: false
    value:
      project_key: dlr-revmgmt-rstlist-spa
      service_owner: cynthia.cardona@disney.com
      app_brand: DLR
      chg_ctaskassignment_group: web-global-saleslodging
      app_prodvalidateendpoint: https://disneyland.disney.go.com/dlr-resort-list-spa/healthcheck
      chg_peerapproval_group: apv-global-onlineapprovers
      app_gitrepo: dlr-revmgmt-rstlist-spa
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      app_deployjob: dlr-revmgmt-rstlist-spa/job/dlr-revmgmt-rstlist-spa-aws-live
      app_stagevalidateendpoint: https://stage.disneyland.disney.go.com/dlr-resort-list-spa/healthcheck
      app_buildjob: dlr-revmgmt-rstlist-spa/job/dlr-revmgmt-rstlist-spa-single-repo
      app_loadvalidateendpoint: https://lt01.disneyland.disney.go.com/dlr-resort-list-spa/healthcheck
      app_bappid: BAPP0225471
      app_gitorg: wdprd-development
  - type: xlrelease.MapStringStringVariable
    key: DLR Resort List web API
    requiresValue: false
    showOnReleaseStart: false
    value:
      service_owner: cynthia.cardona@disney.com
      app_brand: DLR
      chg_ctaskassignment_group: web-global-saleslodging
      app_loadvalidateendpoint: https://lt01.disneyland.disney.go.com/dlr-resort-list-api/api/v1/healthcheck/
      app_deployjob: dlr-revmgmt-rstlist-api/view/Deploy/job/dlr-revmgmt-rstlist-api-aws-live
      app_prodvalidateendpoint: https://disneyland.disney.go.com/dlr-resort-list-api/api/v1/healthcheck
      chg_peerapproval_group: apv-global-onlineapprovers
      project_key: dlr-revmgmt-rstlist-api
      app_stagevalidateendpoint: https://stage.disneyland.disney.go.com/dlr-resort-list-api/api/v1/healthcheck/
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      app_bappid: BAPP0225495
      app_gitrepo: dlr-revmgmt-rstlist-api
      app_gitorg: wdprd-development
      app_buildjob: dlr-revmgmt-rstlist-api/job/dlr-revmgmt-rstlist-api-single-repo
  - type: xlrelease.MapStringStringVariable
    key: DLR Resort Addons VA
    requiresValue: false
    showOnReleaseStart: false
    value:
      service_owner: cynthia.cardona@disney.com
      app_brand: DLR
      app_prodvalidateendpoint: https://dlr-rst-addons-va.wdprapps.disney.com/resort-addons-va/info
      chg_ctaskassignment_group: web-global-saleslodging
      app_bappid: BAPP0225423
      chg_peerapproval_group: apv-global-onlineapprovers
      app_loadvalidateendpoint: https://lt01.dlr-rst-addons-va.wdprapps.disney.com/resort-addons-va/info
      app_gitorg: wdprt-paap-api
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      app_stagevalidateendpoint: https://stage.dlr-rst-addons-va.wdprapps.disney.com/resort-addons-va/info
      project_key: com.disney.wdat.api:dlr-resort-addons-va
      app_buildjob: dlr-revmgmt-rstaddons-va/job/dlr-revmgmt-rstaddons-va-single-repo
      app_deployjob: dlr-revmgmt-rstaddons-va/job/dlr-revmgmt-rstaddons-va-aws-live
      app_gitrepo: dlr-revmgmt-rstaddons-va
  - type: xlrelease.MapStringStringVariable
    key: scope
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.MapStringStringVariable
    key: pr
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.MapStringStringVariable
    key: bjust
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.MapStringStringVariable
    key: DLR Resort Sales Checkout SPA
    requiresValue: false
    showOnReleaseStart: false
    value:
      app_brand: DLR
      app_gitrepo: dlr-revmgmt-resortsales-checkout-spa
      app_buildjob: dlr-revmgmt-resortsales-checkout-spa/job/dlr-revmgmt-resortsales-checkout-spa-single-repo
      chg_peerapproval_group: apv-global-rocket
      app_stagevalidateendpoint: ?????
      app_prodvalidateendpoint: ?????
      app_deployjob: dlr-revmgmt-resortsales-checkout-spa/job/dlr-revmgmt-resortsales-checkout-spa-aws-live
      project_key: dlr-revmgmt-resortsales-checkout-spa
      chg_ctaskassignment_group: app-flwdw-Payment Hub
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      app_bappid: BAPP0229375
      app_loadvalidateendpoint: ?????
      service_owner: william.l.johnson@disney.com
      app_gitorg: wdprd-development
  - type: xlrelease.MapStringStringVariable
    key: DLR Resort Sales Checkout VA
    requiresValue: false
    showOnReleaseStart: false
    value:
      app_brand: DLR
      app_gitrepo: dlr-revmgmt-resortsales-checkout-va
      app_deployjob: dlr-revmgmt-resortsales-checkout-va/job/dlr-revmgmt-resortsales-checkout-va-aws-live
      chg_peerapproval_group: apv-global-rocket
      app_prodvalidateendpoint: https://resort-sales-checkout-va-dlr.wdprapps.disney.com/resort-checkout-va/info
      app_gitorg: wdprt-paap-api
      chg_ctaskassignment_group: app-flwdw-Payment Hub
      app_stagevalidateendpoint: https://stage.resort-sales-checkout-va-dlr.wdprapps.disney.com/resort-checkout-va/info
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      app_buildjob: dlr-revmgmt-resortsales-checkout-va/job/dlr-revmgmt-resortsales-checkout-va-single-repo
      project_key: com.disney.wdat.rescheckout%3Adlr-resortsales-checkout-va
      app_bappid: BAPP0229423
      service_owner: william.l.johnson@disney.com
      app_loadvalidateendpoint: https://load.resort-sales-checkout-va-dlr.wdprapps.disney.com/resort-checkout-va/info
  - type: xlrelease.MapStringStringVariable
    key: DLR Marketing Offer VA
    requiresValue: false
    showOnReleaseStart: false
    value:
      service_owner: cynthia.cardona@disney.com
      app_brand: DLR
      chg_ctaskassignment_group: web-global-saleslodging
      app_stagevalidateendpoint: https://stage.marketing-offer-va.dlr.wdprapps.disney.com/marketing-offer-va/application/health
      app_bappid: BAPP0225995
      app_loadvalidateendpoint: https://load.marketing-offer-va.dlr.wdprapps.disney.com/marketing-offer-va/application/health
      chg_peerapproval_group: apv-global-onlineapprovers
      app_gitorg: wdprt-paap-api
      app_gitrepo: marketing-offer-va-dlr
      app_deployjob: marketing-offer-va-dlr/job/marketing-offer-va-dlr-aws-live
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      project_key: com.disney.wdprt.paap.sales%3Amarketing-offer-va-dlr
      app_buildjob: marketing-offer-va-dlr/job/marketing-offer-va-dlr-single-repo
      app_prodvalidateendpoint: https://marketing-offer-va.dlr.wdprapps.disney.com/marketing-offer-va/application/health
  - type: xlrelease.MapStringStringVariable
    key: DLR Resort Package VA
    requiresValue: false
    showOnReleaseStart: false
    value:
      service_owner: cynthia.cardona@disney.com
      app_brand: DLR
      app_stagevalidateendpoint: https://stage.resort-package-va.dlr.wdprapps.disney.com/resort-package-va/application/health
      app_gitrepo: resort-package-va-dlr
      chg_ctaskassignment_group: web-global-saleslodging
      app_deployjob: resort-package-va-dlr/job/resort-package-va-dlr-aws-live
      project_key: com.disney.wdat.api.resortpackageva%3Aresort-package-va-dlr
      app_prodvalidateendpoint: https://resort-package-va.dlr.wdprapps.disney.com/resort-package-va/application/health
      chg_peerapproval_group: apv-global-onlineapprovers
      app_gitorg: wdprt-paap-api
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      app_loadvalidateendpoint: https://load.resort-package-va.dlr.wdprapps.disney.com/resort-package-va/application/health
      app_bappid: BAPP0226023
      app_buildjob: resort-package-va-dlr/job/resort-package-va-dlr-single-repo
  - type: xlrelease.MapStringStringVariable
    key: WDPR PCS Availability Service
    requiresValue: false
    showOnReleaseStart: false
    value:
      service_owner: cynthia.cardona@disney.com
      app_brand: WDW
      chg_ctaskassignment_group: web-global-saleslodging
      project_key: --
      app_bappid: BAPP0192898
      app_loadvalidateendpoint: TBD
      app_deployjob: digital-availability-service/view/Deploy/job/digital-availability-service-aws-live
      chg_peerapproval_group: apv-global-onlineapprovers
      app_stagevalidateendpoint: TBD
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      app_prodvalidateendpoint: TBD
      app_gitrepo: wdprd-development/digital-availability-service
      app_buildjob: job/digital-availability-service/job/digital-availability-service-single-repo
      app_gitorg: wdprd-development
  - type: xlrelease.StringVariable
    key: skip1
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: skip2
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.MapStringStringVariable
    key: WDPR Facilities & Events Services
    requiresValue: false
    showOnReleaseStart: false
    value:
      app_stagevalidateendpoint: http://stage.facility-svc.wdprapps.disney.com:8080/facility/info
      app_brand: WDW
      app_gitrepo: composite-facility-service
      app_bappid: BAPP0006047
      service_owner: steve.repp@disney.com
      chg_peerapproval_group: apv-global-defenders
      project_key: com.wdpr.bussvcs.facility%3Afacility-svcs-parent
      app_gitorg: WDPR-Sales-SVCS
      chg_ctaskassignment_group: app-global-l3defenders
      app_loadvalidateendpoint: http://load.facility-svc.wdprapps.disney.com:8080/facility/info
      app_deployjob: composite-facility-service/job/composite-facility-service-aws-live
      app_prodvalidateendpoint: http://facility-svc.wdprapps.disney.com:8080/facility/info
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      app_buildjob: composite-facility-service/job/composite-facility-service-single-repo
  - type: xlrelease.MapStringStringVariable
    key: CTI - Computer Telephony Integration
    requiresValue: false
    showOnReleaseStart: false
    value:
      app_brand: WDW
      app_buildjob: NA
      chg_peerapproval_group: apv-global-slsmktui
      app_loadvalidateendpoint: NA
      app_gitrepo: NA
      service_owner: SARAH Reardon
      app_bappid: BAPP0012311
      chg_ctaskassignment_group: app-flwdw-ctisup
      app_stagevalidateendpoint: NA
      app_deployjob: NA
      app_prodvalidateendpoint: NA
      app_jenkins_base_url: NA
      project_key: NA
      app_gitorg: NA
  - type: xlrelease.MapStringStringVariable
    key: DRC APR Prd
    requiresValue: false
    showOnReleaseStart: false
    value:
      app_brand: WDW
      app_buildjob: NA
      chg_peerapproval_group: apv-global-slsmktui
      app_loadvalidateendpoint: NA
      app_gitrepo: NA
      chg_ctaskassignment_group: app-flwdw-drcutil
      app_bappid: BAPP0012761
      service_owner: Scott Puccia
      app_stagevalidateendpoint: NA
      app_deployjob: NA
      app_prodvalidateendpoint: NA
      app_jenkins_base_url: NA
      project_key: NA
      app_gitorg: NA
  - type: xlrelease.MapStringStringVariable
    key: NICE Call Quality Monitoring - DGCS-3.5
    requiresValue: false
    showOnReleaseStart: false
    value:
      app_brand: WDW
      app_buildjob: NA
      chg_peerapproval_group: apv-global-slsmktui
      app_loadvalidateendpoint: NA
      app_gitrepo: NA
      chg_ctaskassignment_group: NA
      service_owner: Scott Puccia
      app_stagevalidateendpoint: NA
      app_bappid: BAPP0012095
      app_deployjob: NA
      app_prodvalidateendpoint: NA
      app_jenkins_base_url: NA
      project_key: NA
      app_gitorg: NA
  - type: xlrelease.MapStringStringVariable
    key: NICE Engage - WDPR
    requiresValue: false
    showOnReleaseStart: false
    value:
      app_bappid: BAPP0083566
      app_brand: WDW
      app_buildjob: NA
      chg_peerapproval_group: apv-global-slsmktui
      app_loadvalidateendpoint: NA
      app_gitrepo: NA
      service_owner: Scott Puccia
      app_stagevalidateendpoint: NA
      app_deployjob: NA
      app_prodvalidateendpoint: NA
      app_jenkins_base_url: NA
      project_key: NA
      app_gitorg: NA
      chg_ctaskassignment_group: app-global-callmtr
  - type: xlrelease.MapStringStringVariable
    key: NICE Total Recording - DLR Security
    requiresValue: false
    showOnReleaseStart: false
    value:
      app_brand: DLR
      app_buildjob: NA
      chg_peerapproval_group: apv-global-slsmktui
      app_loadvalidateendpoint: NA
      app_gitrepo: NA
      app_bappid: BAPP0005099
      service_owner: SARAH Reardon
      app_stagevalidateendpoint: NA
      app_deployjob: NA
      app_prodvalidateendpoint: NA
      app_jenkins_base_url: NA
      project_key: NA
      app_gitorg: NA
      chg_ctaskassignment_group: app-global-callmtr
  - type: xlrelease.MapStringStringVariable
    key: SPOK - Aulani
    requiresValue: false
    showOnReleaseStart: false
    value:
      app_brand: WDW
      app_buildjob: NA
      chg_peerapproval_group: apv-global-slsmktui
      app_loadvalidateendpoint: NA
      app_bappid: BAPP0012932
      app_gitrepo: NA
      service_owner: SARAH Reardon
      app_stagevalidateendpoint: NA
      chg_ctaskassignment_group: app-flwdw-spok
      app_deployjob: NA
      app_prodvalidateendpoint: NA
      app_jenkins_base_url: NA
      project_key: NA
      app_gitorg: NA
  - type: xlrelease.MapStringStringVariable
    key: SPOK - Disney's Guest Communications Services
    requiresValue: false
    showOnReleaseStart: false
    value:
      app_brand: WDW
      app_buildjob: NA
      chg_peerapproval_group: apv-global-slsmktui
      app_loadvalidateendpoint: NA
      app_gitrepo: NA
      service_owner: SARAH Reardon
      app_bappid: BAPP0009791
      app_stagevalidateendpoint: NA
      chg_ctaskassignment_group: app-flwdw-spok
      app_deployjob: NA
      app_prodvalidateendpoint: NA
      app_jenkins_base_url: NA
      project_key: NA
      app_gitorg: NA
  - type: xlrelease.MapStringStringVariable
    key: SPOK - DLR
    requiresValue: false
    showOnReleaseStart: false
    value:
      app_brand: DLR
      app_buildjob: NA
      chg_peerapproval_group: apv-global-slsmktui
      app_loadvalidateendpoint: NA
      app_bappid: BAPP0012107
      app_gitrepo: NA
      service_owner: SARAH Reardon
      app_stagevalidateendpoint: NA
      chg_ctaskassignment_group: app-flwdw-spok
      app_deployjob: NA
      app_prodvalidateendpoint: NA
      app_jenkins_base_url: NA
      project_key: NA
      app_gitorg: NA
  - type: xlrelease.MapStringStringVariable
    key: WDW Disney Performance Tracker (DPT) 7.1
    requiresValue: false
    showOnReleaseStart: false
    value:
      app_brand: WDW
      app_buildjob: NA
      chg_peerapproval_group: apv-global-slsmktui
      app_loadvalidateendpoint: NA
      app_gitrepo: NA
      app_bappid: BAPP0204814
      chg_ctaskassignment_group: app-global-dptsupp
      service_owner: Scott Puccia
      app_stagevalidateendpoint: NA
      app_deployjob: NA
      app_prodvalidateendpoint: NA
      app_jenkins_base_url: NA
      project_key: NA
      app_gitorg: NA
  - type: xlrelease.StringVariable
    key: qa_start_date
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: qa_end_date
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: scope_delivered
    showOnReleaseStart: false
    value: "${JiraTicketSummary}"
    multiline: true
  - type: xlrelease.StringVariable
    key: release_purpose
    requiresValue: false
    showOnReleaseStart: false
    label: Release Purpose
    valueProvider:
      type: xlrelease.ListOfStringValueProviderConfiguration
      variableMapping:
        values: "${global.release_purpose}"
  - type: xlrelease.StringVariable
    key: prd_crq_sys_id
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: sdate
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: edate
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.MapStringStringVariable
    key: JiraTicketSummary
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.MapStringStringVariable
    key: DLR Resort Sales Checkout WebAPI
    requiresValue: false
    showOnReleaseStart: false
    value:
      project_key: dlr-revmgmt-resortsales-checkout-webapi
      app_brand: DLR
      chg_peerapproval_group: apv-global-rocket
      app_stagevalidateendpoint: https://stage.disneyland.disney.go.com/resort-checkout/api/v1/healthcheck
      app_deployjob: dlr-revmgmt-resortsales-checkout-webapi/job/dlr-revmgmt-resortsales-checkout-webapi-aws-live
      app_gitrepo: dlr-revmgmt-resortsales-checkout-webapi
      chg_ctaskassignment_group: app-flwdw-Payment Hub
      app_prodvalidateendpoint: https://disneyland.disney.go.com/resort-checkout/api/v1/healthcheck
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      app_bappid: BAPP0229399
      app_loadvalidateendpoint: https://lt01.disneyland.disney.go.com/resort-checkout/api/v1/healthcheck
      app_buildjob: dlr-revmgmt-resortsales-checkout-webapi/job/dlr-revmgmt-resortsales-checkout-webapi-single-repo
      service_owner: william.l.johnson@disney.com
      app_gitorg: wdprd-development
  - type: xlrelease.StringVariable
    key: JiraTicketDetails1
    requiresValue: false
    showOnReleaseStart: false
    multiline: true
  - type: xlrelease.StringVariable
    key: all_apps
    requiresValue: false
    showOnReleaseStart: false
    multiline: true
  - type: xlrelease.StringVariable
    key: all_story
    requiresValue: false
    showOnReleaseStart: false
    multiline: true
  - type: xlrelease.StringVariable
    key: all_chg
    showOnReleaseStart: false
    multiline: true
  - type: xlrelease.MapStringStringVariable
    key: DLR Cancellation Form - Spa
    requiresValue: false
    showOnReleaseStart: false
    value:
      app_prodvalidateendpoint: https://disneyland.disney.go.com/resort-cancellation/healthcheck/
      service_owner: cynthia.cardona@disney.com
      app_brand: DLR
      app_bappid: BAPP0194918
      project_key: dlr-res-cancel-spa
      app_deployjob: dlr-res-cancel-spa/job/dlr-res-cancel-spa-aws-live
      app_loadvalidateendpoint: https://lt01.disneyland.disney.go.com/resort-cancellation/healthcheck/
      app_stagevalidateendpoint: https://stage.disneyland.disney.go.com/resort-cancellation/healthcheck/
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      chg_peerapproval_group: apv-global-gamora
      app_gitorg: https://github.disney.com
      app_buildjob: dlr-res-cancel-spa/job/dlr-res-cancel-spa-single-repo
      app_gitrepo: wdprt-paap-api/dlr-res-cancel-spa
      chg_ctaskassignment_group: app-global-gamora
  - type: xlrelease.MapStringStringVariable
    key: DLR Cancellation Form - Web API
    requiresValue: false
    showOnReleaseStart: false
    value:
      app_stagevalidateendpoint: https://stage.disneyland.disney.go.com/resort-cancellation/api/health-check/full/
      service_owner: cynthia.cardona@disney.com
      app_brand: DLR
      app_buildjob: dlr-res-cancel-webapi/job/dlr-res-cancel-webapi-single-repo/
      app_loadvalidateendpoint: https://lt01.disneyland.disney.go.com/resort-cancellation/api/health-check/full/
      app_gitrepo: wdprt-paap-api/dlr-res-cancel-webapi
      app_deployjob: dlr-res-cancel-webapi/job/dlr-res-cancel-webapi-aws-live/
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      chg_peerapproval_group: apv-global-gamora
      app_gitorg: https://github.disney.com
      project_key: dlr-res-cancel-webapi
      app_bappid: BAPP0194894
      app_prodvalidateendpoint: https://disneyland.disney.go.com/resort-cancellation/api/health-check/full/
      chg_ctaskassignment_group: app-global-gamora
  - type: xlrelease.BooleanVariable
    key: send_invite
    requiresValue: false
    showOnReleaseStart: false
    label: Do you want to send meeting invite?
    description: Do you want to Create Meeting invite ( Select checkbox for Creation
      and Uncheck if you dont want to Create Invite )
  - type: xlrelease.StringVariable
    key: meet_start
    requiresValue: false
    showOnReleaseStart: false
    label: Event Start Time
    description: "The start time of the event (Eastern Time): MM/DD/YY hh:mm (08/15/21\
      \ 17:30)."
    value: "${end_date}"
  - type: xlrelease.StringVariable
    key: meet_end
    requiresValue: false
    showOnReleaseStart: false
    label: Event End Time
    value: "${end_date}"
  - type: xlrelease.StringVariable
    key: meeting_link
    requiresValue: false
    showOnReleaseStart: false
    label: Provide Meeting Link
    value: https://disney.zoom.us/j/6038649065?pwd=NUczem1BbEpUVG4vOVEvVkdZYlJSdz09
    multiline: true
  - type: xlrelease.StringVariable
    key: email_dl
    requiresValue: false
    showOnReleaseStart: false
    label: Emails
    description: "The list of emails this invite will go out to: 'user1@disney.com,\
      \ user2@disney.com, DL1@disney.com'"
    value: "WDPR.DL-Resort.Sales.Release.Support@disney.com,${ReleaseStakeholders}"
    multiline: true
  - type: xlrelease.MapStringStringVariable
    key: WDW Lodging Service
    requiresValue: false
    showOnReleaseStart: false
    value:
      service_owner: cynthia.cardona@disney.com
      app_brand: WDW
      app_buildjob: https://rev-mgmt.cicd.wdprapps.disney.com/job/wdpr-lodging-service-repo/
      app_loadvalidateendpoint: https://load.lodgingservice.wdprapps.disney.com/lodging-service/admin/health-report
      app_stagevalidateendpoint: https://stage.lodgingservice.wdprapps.disney.com/lodging-service/admin/health-report
      chg_ctaskassignment_group: web-global-saleslodging
      app_bappid: BAPP0231825
      app_deployjob: https://rev-mgmt.cicd.wdprapps.disney.com/job/wdpr-lodging-service/
      chg_peerapproval_group: apv-global-onlineapprovers
      project_key: com.disney.wdpr.api:wdw-lodging-service
      app_prodvalidateendpoint: https://lodgingservice.wdprapps.disney.com/lodging-service/admin/health-report
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      app_gitrepo: wdpr-lodging-service
      app_gitorg: wdprd-development
  - type: xlrelease.StringVariable
    key: stage_test
    requiresValue: false
    showOnReleaseStart: false
    value: NA
  - type: xlrelease.StringVariable
    key: qestatus
    requiresValue: false
    showOnReleaseStart: false
    label: Status of QE Job
  - type: xlrelease.StringVariable
    key: sdet_jenkins
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: shield_report
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.MapStringStringVariable
    key: WDW Lodging Product Service
    requiresValue: false
    showOnReleaseStart: false
    value:
      service_owner: cynthia.cardona@disney.com
      app_brand: WDW
      app_gitrepo: lodging-product-service
      chg_ctaskassignment_group: web-global-saleslodging
      app_prodvalidateendpoint: https://lodging-product-service.wdprapps.disney.com/product-service/admin/healthcheck
      app_deployjob: lodging-product-service/job/lodging-product-service-aws-live
      app_stagevalidateendpoint: https://stage.lodging-product-service.wdprapps.disney.com/product-service/admin/healthcheck
      chg_peerapproval_group: apv-global-onlineapprovers
      app_loadvalidateendpoint: https://load.lodging-product-service.wdprapps.disney.com/product-service/admin/healthcheck
      app_buildjob: lodging-product-service/job/lodging-product-service-single-repo
      project_key: com.disney.wdpro.service%3Alodging-product-service
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      app_bappid: BAPP0242454
      app_gitorg: wdprd-development
  - type: xlrelease.StringVariable
    key: group_project
    showOnReleaseStart: false
    label: Define The Group Release Name
    description: Define The Group Release Name
    value: Rocket Release
  - type: xlrelease.StringVariable
    key: authz_info
    showOnReleaseStart: false
    label: Any Authz Updates ?
    description: Any Authz Updates ?
    value: Not Applicable
    multiline: true
  - type: xlrelease.StringVariable
    key: dscribe_info
    showOnReleaseStart: false
    label: Any D-Scribe Updates ?
    description: Any D-Scribe Updates ?
    value: Not Applicable
    multiline: true
  - type: xlrelease.StringVariable
    key: nimbus_ctask
    showOnReleaseStart: false
    label: List the SE Ctasks Info
    description: List the SE Ctasks Info
    value: Not Applicable
    multiline: true
  - type: xlrelease.StringVariable
    key: app_change_build_info
    showOnReleaseStart: false
    label: List Application & Build & Change Info
    description: List Application & Build & Change Info
    multiline: true
  - type: xlrelease.StringVariable
    key: sustainment_studio
    showOnReleaseStart: false
    label: List the Sustainment Studio Name
    description: List the Sustainment Studio Name
    value: Studio Vision
  - type: xlrelease.StringVariable
    key: ReleaseStakeholders
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: in_scope
    showOnReleaseStart: false
    label: Do we have this task in scope to be implemented ?
    description: Do we have this task in scope to be implemented ?
    valueProvider:
      type: xlrelease.ListOfStringValueProviderConfiguration
      values:
      - Not Applicable
      - Scheduled
    value: Not Applicable
  - type: xlrelease.StringVariable
    key: implementation_time
    showOnReleaseStart: false
    label: Select the Timings for The Task To be Implemented
    description: Select the Timings for The Task To be Implemented
    valueProvider:
      type: xlrelease.ListOfStringValueProviderConfiguration
      values:
      - "${start_date} 11 PM - ${end_date} 6 AM EST"
      - "${end_date} 3 - 9 AM EST"
      - "${end_date} 6 - 9 AM EST"
    value: "${end_date} 6 - 9 AM EST"
  - type: xlrelease.MapStringStringVariable
    key: WDW Offer Adapter
    requiresValue: false
    showOnReleaseStart: false
    value:
      app_brand: WDW
      app_prodvalidateendpoint: https://offer-adapter-wdw.wdprapps.disney.com/offer-adapter/application/info
      app_stagevalidateendpoint: https://stage.offer-adapter-wdw.wdprapps.disney.com/offer-adapter/application/info
      service_owner: steve.repp@disney.com
      chg_peerapproval_group: apv-global-defenders
      app_gitrepo: offer-adapter-service
      app_gitorg: WDPR-Resort-Sales
      app_bappid: BAPP0143870
      app_buildjob: offer-adapter-service/job/offer-adapter-service-single-repo
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      project_key: com.disney.wdat.api:offer-adapter-service
      app_deployjob: offer-adapter-service/job/offer-adapter-service-aws-live
      app_loadvalidateendpoint: https://load.offer-adapter-wdw.wdprapps.disney.com/offer-adapter/application/info
      chg_ctaskassignment_group: app-flcorp-l3defenders
  - type: xlrelease.MapStringStringVariable
    key: DLR  Online Modifications Web API
    requiresValue: false
    showOnReleaseStart: false
    value:
      service_owner: cynthia.cardona@disney.com
      app_brand: DLR
      app_stagevalidateendpoint: https://stage.disneyland.disney.go.com/dlr-resort-onlinemods-api/api/v1/healthcheck
      app_prodvalidateendpoint: https://disneyland.disney.go.com/dlr-resort-onlinemods-api/api/v1/healthcheck/
      app_gitrepo: dlr-revmgmt-rstonlinemods-api
      app_deployjob: dlr-revmgmt-rstonlinemods-api/job/dlr-revmgmt-rstonlinemods-api-batch-aws-live
      chg_peerapproval_group: apv-global-onlineapprovers
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      project_key: NA
      app_loadvalidateendpoint: https://lt01.disneyland.disney.go.com/dlr-resort-onlinemods-api/api/v1/healthcheck
      app_buildjob: dlr-revmgmt-rstonlinemods-api/job/dlr-revmgmt-rstonlinemods-api-batch-single-repo
      app_bappid: BAPP0242487
      app_gitorg: wdprd-development
      chg_ctaskassignment_group: app-global-resort-sales-online-delivery
  - type: xlrelease.MapStringStringVariable
    key: DLR Online Modifications SPA
    requiresValue: false
    showOnReleaseStart: false
    value:
      service_owner: cynthia.cardona@disney.com
      app_brand: DLR
      app_prodvalidateendpoint: https://disneyland.disney.go.com/dlr-resort-onlinemods-spa/healthcheck
      chg_ctaskassignment_group: web-global-saleslodging
      app_stagevalidateendpoint: https://stage.disneyland.disney.go.com/dlr-resort-onlinemods-spa/healthcheck
      app_loadvalidateendpoint: https://lt01.disneyland.disney.go.com/dlr-resort-onlinemods-spa/healthcheck
      chg_peerapproval_group: apv-global-onlineapprovers
      project_key: TBD
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      app_bappid: BAPP0242486
      app_gitrepo: dlr-revmgmt-rstonlinemods-spa
      app_deployjob: dlr-revmgmt-rstonlinemods-spa/job/dlr-revmgmt-rstonlinemods-spa-batch-aws-live
      app_gitorg: wdprd-development
      app_buildjob: dlr-revmgmt-rstonlinemods-spa/job/dlr-revmgmt-rstonlinemods-spa-batch-single-repo
  - type: xlrelease.MapStringStringVariable
    key: DLR Online Modifications VA
    requiresValue: false
    showOnReleaseStart: false
    value:
      service_owner: cynthia.cardona@disney.com
      app_brand: DLR
      chg_ctaskassignment_group: web-global-saleslodging
      app_prodvalidateendpoint: https://disneyland.disney.go.com/dlr-rst-onlinemods-va.wdprapps.disney.com/healthcheck
      chg_peerapproval_group: apv-global-onlineapprovers
      app_stagevalidateendpoint: https://stage.disneyland.disney.go.com/dlr-rst-onlinemods-va.wdprapps.disney.com/healthcheck
      app_loadvalidateendpoint: https://lt01.disneyland.disney.go.com/dlr-rst-onlinemods-va.wdprapps.disney.com/healthcheck
      app_gitorg: wdprt-paap-api
      app_buildjob: dlr-revmgmt-rstonlinemods-va/job/dlr-revmgmt-rstonlinemods-va-batch-single-repo
      app_jenkins_base_url: https://rev-mgmt.cicd.wdprapps.disney.com/
      app_gitrepo: dlr-revmgmt-rstonlinemods-va
      app_deployjob: dlr-revmgmt-rstonlinemods-va/job/dlr-revmgmt-rstonlinemods-va-batch-aws-live
      project_key: com.disney.dlr.mods:dlr-online-mods-va
      app_bappid: BAPP0242462
  - type: xlrelease.StringVariable
    key: app_sys_id
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: prod_child_ci_sys_id
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: app_build_change_info
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: stage_sys_id
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: load_sys_id
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: validation_steps
    requiresValue: false
    showOnReleaseStart: false
    label: Additional Fields
    description: Use ServiceNow technical field name as 'key' and the corresponding
      value.
  - type: xlrelease.StringVariable
    key: planning_test
    requiresValue: false
    showOnReleaseStart: false
    value: "***NOTHING ON THIS TEMPLATE IS TO BE DELETED*** \n1. List the validation\
      \ steps (and owner) which will be performed in the change window to ensure that\
      \ the implementation was performed correctly. Include technical step-by-step\
      \ details to explain how the update will be validated\nAnswer:\na) Delivery/Sustainment\
      \ team to check the status endpoints to ensure correct version deployed in prod\n\
      b) Delivery/Sustainment team to check that ec2 instances have come up and stabilized\
      \ running correct version\nc) Delivery/Sustainment - Delivery/Sustainment to\
      \ check proper version of code was deployed\nd) Delivery/Sustainment will run\
      \ standard smoke tests that we execute after deployment. The smoke tests invoke\
      \ endpoints and test the systems functionality after application is deployed.\
      \ Additionally our smoke tests run on a schedule. Additionally will perform\
      \ necessary post deploy validation coverage which allows us to to detect any\
      \ issues (ART, Error rate increase, Eventing failures) soon after each deployment\n\
      e) AOE to peform appD monitoring \n\n2.   Is monitoring required after the change\
      \ window to ensure that there are no unexpected production impacts as the business\
      \ resumes [Y/N]? Yes  \n\n****If Q2 is No then answer below with N/A **** \n\
      a.) Who will be monitoring for production impact(s) from this change as Business\
      \ resumes (outside the change window)?       \nAnswer: Application Sustainment\
      \ Team will monitor after change window for 6 Hours.\n\nb.) What types of transactions\
      \ will be reviewed, to ensure business resumption was successful?      \nAnswer:\
      \ Splunk will have Business Related Transactions and Appd Will have both Business\
      \ & Infrastructure Resources Health Metrics.\n\nc.)  What are the success criteria\
      \ for this change that will trigger an exit from post change monitoring  and\
      \ return to normal production monitoring \n\nAnswer: No issues or alarms/alerts\
      \ coming up from dashboards. \n\n3. Are there any downstream apps that need\
      \ to validate this change? (Y/N) [If Yes, please add validation ctask for each\
      \ team to validate]      \nAnswer: NO \n\n<DO NOT DELETE THE INFORMATION ABOVE\
      \ THIS LINE>"
    multiline: true
  - type: xlrelease.StringVariable
    key: planning_backout
    requiresValue: false
    showOnReleaseStart: false
    value: "***NOTHING ON THIS TEMPLATE IS TO BE DELETED***\nInclude technical step-by-step\
      \ details here that explain how you  plan to backout this change. \nInclude\
      \ script names, etc. Information may also be referred to and included the Backout\
      \ task.  \nPlease DO NOT provide a link to the technical details. \n\n1.\tWill\
      \ there be a Production Outage if the Rollback occurs outside of the Approved\
      \ Execution Window?\nAnswer (Y/N): No  Outage\n\n2.\tWhat are detailed steps\
      \ required to execute the backout? (include previous version if applicable)\
      \ \nAnswer: ${rollback_info}\n===========================================\n\
      Below are the ADS instructions for rollback - \nPromote: No     \nBuild: No\
      \     \nDeploy: Yes  \nRollback Version : ${rollback_version} (Rollback Version\
      \ has been validated by GQE /PE/ App Team)\nNOTE: As soon as the deployment\
      \ finished, app team will start the validation. If there is any issue we will\
      \ rollback immediately.\n\n3.  What time is needed to start rollback to successfully\
      \ complete backout within the limits of the Approved Change Window. \nCalculate\
      \ answer by replacing (x) below with number:\n- Start Time for Rollback [ ${backout_rollback_time}\
      \ ]\n- Time to implement backout: ( 15 minutes)- Time for testing backout: (15\
      \ minutes) \n- Time for troubleshooting backout: (30 minutes)\n- Total time\
      \ needed for backout: (1 hour)  \n\n<DO NOT DELETE THE INFORMATION ABOVE THIS\
      \ LINE>"
    multiline: true
  - type: xlrelease.StringVariable
    key: planning_chg
    requiresValue: false
    showOnReleaseStart: false
    value: "***NOTHING ON THIS TEMPLATE IS TO BE DELETED***\nTechnical details provided\
      \ here explain how to implement this change. The intent of information captured\
      \ within the change plan should be sufficient for any operation or engineer\
      \ to pick up & implement ‚Äì specifically calling out all steps, scripts + versions,\
      \ files, commands, etc. Step by step. Include script names, etc. Information\
      \ may also be referred to and included the Implementation task.\n\n***Please\
      \ DO NOT provide a link to the technical details.***  \n\nAnswer:\n\nStep:1.1)\
      \ ${nimbus_info}\nStep:1.2) ADS Team Deployment To Prod\nStep:2) GQE Validation\n\
      Step:3) Sustainment team  validation\n\n\nNOTE:  \na.  These stories are tested\
      \ successfully in Stage (GQE) and Load (Performance) environments.\nb.  Sustainment\
      \ Team validated in lower environment; they  did not encounter any issues &\
      \ closed CTASK with evidence. \nc.  Change Coordination team cross-verified;\
      \  change has been implemented only after verification."
    multiline: true
  - type: xlrelease.StringVariable
    key: delivery_effort
    requiresValue: false
    label: Delivery Effort Name
    description: "Replace ${app_name} With a Business Delivery Name if yuu have a\
      \ release which has  > 1 Application"
    value: "${app_name} ${Release_Version}"
  - type: xlrelease.StringVariable
    key: delivery_id
    requiresValue: false
    showOnReleaseStart: false
    label: Delivery ID
    description: Select an ID variable to hold the delivery ID created from this search
  - type: xlrelease.ListStringVariable
    key: application
    requiresValue: false
    showOnReleaseStart: false
    label: Tracked items
    description: "Enter the names of the tracked items you want to register to the\
      \ delivery and click\_'Add'\_to make a list, or click\_'X'\_to remove them from\
      \ the list."
    value:
    - "${app_name}"
  - type: xlrelease.StringVariable
    key: rundeckStageExecutionUrl
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: rundeckLoadExecutionUrl
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: harnessStageExecutionResponse
    requiresValue: false
    showOnReleaseStart: false
    multiline: true
  - type: xlrelease.StringVariable
    key: harnessLoadExecutionResponse
    requiresValue: false
    showOnReleaseStart: false
    multiline: true
  - type: xlrelease.StringVariable
    key: harnessStageExecutionGetResponse
    requiresValue: false
    showOnReleaseStart: false
    multiline: true
  - type: xlrelease.StringVariable
    key: harnessLoadExecutionGetResponse
    requiresValue: false
    showOnReleaseStart: false
    multiline: true
  - type: xlrelease.StringVariable
    key: harnessStageExecutionId
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: harnessLoadExecutionId
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: harnessStageExecutionGetResponseStatus
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: harnessLoadExecutionGetResponseStatus
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: harnessPAT
    requiresValue: false
    showOnReleaseStart: false
    value: pat.1-wFe3qRQv2mUh1s9244Eg.6893e433f5ca46096affd0a6.B8ZdDHIrpq4gvLacRwkx
  - type: xlrelease.StringVariable
    key: app_buildjob
    requiresValue: false
    showOnReleaseStart: false
    label: Script
    description: Script
  - type: xlrelease.StringVariable
    key: app_jenkins_base_url
    requiresValue: false
    showOnReleaseStart: false
    label: Script
    description: Script
  - type: xlrelease.StringVariable
    key: metrics_data
    requiresValue: false
    showOnReleaseStart: false
    multiline: true
  - type: xlrelease.StringVariable
    key: app_rundeck_nonprodjob
    requiresValue: false
    showOnReleaseStart: false
    label: Description
    description: The complete description of the task.
  - type: xlrelease.StringVariable
    key: app_harness_base_url
    requiresValue: false
    showOnReleaseStart: false
    label: Harness URL
    description: The complete description of the task.
    value: "https://disney.harness.io/ng/account/${harnessAccountId}/module/ci/orgs/${harnessOrgId}/projects/${harnessProjectIdentifier}/overview"
  - type: xlrelease.StringVariable
    key: responseText
    requiresValue: false
    showOnReleaseStart: false
    label: Message
    description: The notification message text (Markdown syntax can be used)
    multiline: true
  - type: xlrelease.StringVariable
    key: githubToken
    requiresValue: false
    showOnReleaseStart: false
    label: Github Token
    value: l0Vdu2rAY8FSrsAgeAgfLIuT2v2D3u2ahRFM
  - type: xlrelease.StringVariable
    key: commitLogsFormatted
    requiresValue: false
    showOnReleaseStart: false
    multiline: true
  - type: xlrelease.StringVariable
    key: pullRequests
    requiresValue: false
    showOnReleaseStart: false
    multiline: true
  - type: xlrelease.StringVariable
    key: pullRequestLinksFormatted
    requiresValue: false
    showOnReleaseStart: false
    multiline: true
  - type: xlrelease.StringVariable
    key: pullRequestUrlsOnly
    requiresValue: false
    showOnReleaseStart: false
    multiline: true
  - type: xlrelease.StringVariable
    key: githubCompareResult
    requiresValue: false
    showOnReleaseStart: false
    multiline: true
  - type: xlrelease.StringVariable
    key: rundeckApiToken
    requiresValue: false
    showOnReleaseStart: false
    value: NbNqwyLC1bo2hf8HxMkg4Ew7CWi5VUVP
  - type: xlrelease.StringVariable
    key: rundeckExecutionUrl
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: rundeckExecutionStatus
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: JiraTicketDetails2
    requiresValue: false
    showOnReleaseStart: false
    multiline: true
  - type: xlrelease.StringVariable
    key: rundeckLoadExecutionStatus
    requiresValue: false
    showOnReleaseStart: false
    label: Precondition
    description: A snippet of code that is evaluated when the task is started.
  - type: xlrelease.StringVariable
    key: rundeckStageExecutionStatus
    requiresValue: false
    showOnReleaseStart: false
    label: Precondition
    description: A snippet of code that is evaluated when the task is started.
  - type: xlrelease.StringVariable
    key: request
    requiresValue: false
    showOnReleaseStart: false
    multiline: true
  - type: xlrelease.StringVariable
    key: lastTag
    requiresValue: false
    showOnReleaseStart: false
    label: Last Tag
    description: lastTag on branch
  - type: xlrelease.StringVariable
    key: harnessAccountId
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: harnessOrgId
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: harnessPipelineIdentifier
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: harnessProjectIdentifier
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: FormattedSonarQubeMetrics
    requiresValue: false
    showOnReleaseStart: false
    multiline: true
  - type: xlrelease.BooleanVariable
    key: create_invite
    requiresValue: false
    label: Do you want to Create Meeting invite
    description: Select checkbox for Creation and Uncheck if you dont want to Create
      Invite
  - type: xlrelease.BooleanVariable
    key: update_invite
    requiresValue: false
    showOnReleaseStart: false
    label: Do you want to Update Meeting invite
    description: Do you want to Update Meeting invite ( Select checkbox for Update
      and Uncheck if you dont want to Update Invite )
  - type: xlrelease.BooleanVariable
    key: cancel_invite
    requiresValue: false
    showOnReleaseStart: false
    label: Do you want to Cancel Meeting invite
    description: Do you want to Cancel Meeting invite ( Select checkbox for Cancel
      and Uncheck if you dont want to Cancel Invite )
  - type: xlrelease.StringVariable
    key: invitetimestamp
    requiresValue: false
    showOnReleaseStart: false
    label: Created Invite Date Format
  - type: xlrelease.StringVariable
    key: calendarEventUid
    requiresValue: false
    showOnReleaseStart: false
    label: Invite Event ID
  - type: xlrelease.StringVariable
    key: event_start
    requiresValue: false
    showOnReleaseStart: false
    label: Start Date and Time of Meeting Invite
    description: "MM/DD/YY hh:mm  ex: 12/21/25 23:00 for Dec 21st 11pm EST"
    value: "${event_start}"
  - type: xlrelease.StringVariable
    key: event_end
    requiresValue: false
    showOnReleaseStart: false
    label: Event Date and Time End Info
    description: "MM/DD/YY hh:mm   ex: 12/21/25 06:00 for Dec 21st 06am EST"
    value: "${event_end}"
  - type: xlrelease.StringVariable
    key: invite_receipients
    requiresValue: false
    showOnReleaseStart: false
    label: Meeting receipients List
    value: "WDAT.DL-studiovision@disney.com,WDAT.DL-AOE@disney.com,WDPRTechnologyDL-StudioKylo@disney.com,DPEP.DL-PCS.SRE@disney.com,WDAT.DL-Application.Deployment.Services@disney.com,DPEP.DL-EE.Systems.Engineering@disney.com,Cynthia.Cardona@disney.com,Sachita.Rane.-ND@disney.com,WDPR.DL-Digital.Studio.Gamora@disney.com,Keith.Waskom@disney.com,Sagar.Choudhari.-ND@disney.com,Kathy.M.Deleon@disney.com,WDPR.DL-Digital.Studio.Nebula@disney.com,Amit.Hathiramani@disney.com,Aaron.Caryl@disney.com,Nagi.X.Kolli.-ND@disney.com,Gurpreet.Kaur.-ND@disney.com,Malathi.X.Govindaraju.-ND@disney.com,Bhavana.X.Sharma.-ND@disney.com,DPEP.DL-GQEOnlineProductionSupport@disney.com,Mohisin.Anwar.Mohammed.-ND@disney.com"
    multiline: true
  - type: xlrelease.StringVariable
    key: Release_Plan_Url
    requiresValue: false
    showOnReleaseStart: false
    label: Provide Sharepoint Release Plan URL
  - type: xlrelease.StringVariable
    key: invite_channel
    requiresValue: false
    showOnReleaseStart: false
    value: "Studio Vision Release | Studio Vision | Microsoft Teams \n\thttps://teams.microsoft.com/l/channel/19%3AeTt7wRNJsN1zreljFOli6YnfQXKzdMSbyWfdDjSp5f81%40thread.tacv2/Studio%20Vision%20Release?groupId=0cdb8969-7b33-4db4-8465-0d9141f42138&tenantId=56b731a8-a2ac-4c32-bf6b-616810e913c6&ngc=true&allowXTenantAccess=true"
    multiline: true
  - type: xlrelease.StringVariable
    key: invite_meeting_info
    requiresValue: false
    showOnReleaseStart: false
    multiline: true
  - type: xlrelease.StringVariable
    key: channel_ name
    requiresValue: false
    showOnReleaseStart: false
    valueProvider:
      type: xlrelease.ListOfStringValueProviderConfiguration
      values:
      - Studio Vision Release
      - Studio Terror Release
      - Studio Gamora - Releases
    value: Studio Vision Release
  - type: xlrelease.StringVariable
    key: invite_vision_channel
    requiresValue: false
    showOnReleaseStart: false
    value: <a href="https://teams.microsoft.com/l/channel/19%3AeTt7wRNJsN1zreljFOli6YnfQXKzdMSbyWfdDjSp5f81%40thread.tacv2/Studio%20Vision%20Release?groupId=0cdb8969-7b33-4db4-8465-0d9141f42138&tenantId=56b731a8-a2ac-4c32-bf6b-616810e913c6&ngc=true&allowXTenantAccess=true">Studio
      Vision Release | Studio Vision | Microsoft Teams</a>
    multiline: true
  - type: xlrelease.StringVariable
    key: invite_terror_channel
    requiresValue: false
    showOnReleaseStart: false
    value: <a href="https://teams.microsoft.com/l/channel/19%3ACH4kRqJQde5cBUFbvMRUJeijDekj2Qoej7580NwXxnk1%40thread.tacv2/Studio%20Terror%20Release?groupId=bfb70396-8156-4f89-a892-c12dc629e474&tenantId=56b731a8-a2ac-4c32-bf6b-616810e913c6&ngc=true&allowXTenantAccess=true">Studio
      Terror Release | Studio Terror | Microsoft Teams</a>
    multiline: true
  - type: xlrelease.StringVariable
    key: invite_gamora_channel
    requiresValue: false
    showOnReleaseStart: false
    value: <a href="https://teams.microsoft.com/l/channel/19%3Abb5df2a298a8415d8c7d5b7173f4e30d%40thread.tacv2/Studio%20Gamora%20-%20Releases?groupId=6b633f47-7a4c-4371-a664-828594b89b8c&tenantId=56b731a8-a2ac-4c32-bf6b-616810e913c6&ngc=true&allowXTenantAccess=true">Studio
      Gamora - Releases | Resort Online Sales (ROS) | Microsoft Teams</a>
    multiline: true
  - type: xlrelease.StringVariable
    key: invite_vision_meeting_info
    requiresValue: false
    showOnReleaseStart: false
    value: "<p>________________________________________________________________________________\
      \ </p>\n<p>Microsoft Teams Need help?  </p>\n<p><a href=\"https://teams.microsoft.com/l/meetup-join/19%3ameeting_NWM5OGU0OGQtNDA3OS00ZjVhLThmOTQtMDU1NzdjYjJjZjkx%40thread.v2/0?context=%7b%22Tid%22%3a%2256b731a8-a2ac-4c32-bf6b-616810e913c6%22%2c%22Oid%22%3a%22b68755ad-8b45-4aaa-84c2-d4e82274696f%22%7d\"\
      >Join the meeting now</a></p>\n\n<p>Meeting ID: 292 717 665 664 1  </p>\n<p>Passcode:\
      \ BL7BW7ry   </p>\n<p>________________________________________  </p>\n<p>Dial\
      \ in by phone   </p>\n<p>+1 747-261-1018,,467489061# United States, Burbank\
      \ </p>  \n<p>Find a local number  </p>\n<p>Phone conference ID: 467 489 061#\
      \   </p>\n<p>Join on a video conferencing device  </p>\n<p>Tenant key: teams@disney.vc\
      \  </p>\n<p>Video ID: 114 752 675 2  </p>\n<p>More info   </p>\n<p>For organizers:\
      \ Meeting options | Reset dial-in PIN  </p>\n<p>________________________________________________________________________________</p>"
    multiline: true
  - type: xlrelease.StringVariable
    key: invite_gamora_meeting_info
    requiresValue: false
    showOnReleaseStart: false
    value: "<p>________________________________________________________________________________</p>\n\
      <p>Microsoft Teams Need help?</p> \n<p><a href=\"https://teams.microsoft.com/l/meetup-join/19%3ameeting_OWNhNDQ1NmItMzg3Yi00NzNkLWJhMWItZTBkZjkwODhkMDAz%40thread.v2/0?context=%7b%22Tid%22%3a%2256b731a8-a2ac-4c32-bf6b-616810e913c6%22%2c%22Oid%22%3a%22b68755ad-8b45-4aaa-84c2-d4e82274696f%22%7d\"\
      >Join the meeting now</a> </p>\n<p>Meeting ID: 256 728 826 654 51</p> \n<p>Passcode:\
      \ ks7jx2Ar </p>\n<p>________________________________________</p>\n<p>Dial in\
      \ by phone </p>\n<p>+1 747-261-1018,,559884376# United States, Burbank</p> \n\
      <p>Find a local number </p>\n<p>Phone conference ID: 559 884 376# </p>\n<p>Join\
      \ on a video conferencing device</p> \n<p>Tenant key: teams@disney.vc</p> \n\
      <p>Video ID: 118 566 254 7</p> \n<p>More info </p>\n<p>For organizers: Meeting\
      \ options | Reset dial-in PIN</p> \n<p>________________________________________________________________________________</p>"
    multiline: true
  - type: xlrelease.StringVariable
    key: invite_terror_meeting_info
    requiresValue: false
    showOnReleaseStart: false
    value: "<p>________________________________________________________________________________\
      \ </p>\n<p>Microsoft Teams Need help?  </p>\n<p><a href=\"https://teams.microsoft.com/l/meetup-join/19%3ameeting_NWM5OGU0OGQtNDA3OS00ZjVhLThmOTQtMDU1NzdjYjJjZjkx%40thread.v2/0?context=%7b%22Tid%22%3a%2256b731a8-a2ac-4c32-bf6b-616810e913c6%22%2c%22Oid%22%3a%22b68755ad-8b45-4aaa-84c2-d4e82274696f%22%7d\"\
      >Join the meeting now</a></p>\n\n<p>Meeting ID: 292 717 665 664 1  </p>\n<p>Passcode:\
      \ BL7BW7ry   </p>\n<p>________________________________________  </p>\n<p>Dial\
      \ in by phone   </p>\n<p>+1 747-261-1018,,467489061# United States, Burbank\
      \ </p>  \n<p>Find a local number  </p>\n<p>Phone conference ID: 467 489 061#\
      \   </p>\n<p>Join on a video conferencing device  </p>\n<p>Tenant key: teams@disney.vc\
      \  </p>\n<p>Video ID: 114 752 675 2  </p>\n<p>More info   </p>\n<p>For organizers:\
      \ Meeting options | Reset dial-in PIN  </p>\n<p>________________________________________________________________________________</p>"
    multiline: true
  - type: xlrelease.StringVariable
    key: channel_name
    requiresValue: false
    showOnReleaseStart: false
    label: Teams Channel Name for Release Notifications
    valueProvider:
      type: xlrelease.ListOfStringValueProviderConfiguration
      values:
      - Studio Vision Release
      - Studio Terror Release
      - Studio Gamora - Releases
    value: Studio Vision Release
  - type: xlrelease.ReferenceVariable
    key: teams_channel_ref
    requiresValue: false
    showOnReleaseStart: false
    value: Studio Vision Release
    referencedType: msteams.Server
  - type: xlrelease.StringVariable
    key: smartsheet_sheet_id
    requiresValue: false
    showOnReleaseStart: false
    value: "6544860565006212"
  - type: xlrelease.StringVariable
    key: target_qa_column
    requiresValue: false
    showOnReleaseStart: false
    value: "QA Change #"
  - type: xlrelease.StringVariable
    key: target_qa_value
    requiresValue: false
    showOnReleaseStart: false
    value: qa_crq_number
  - type: xlrelease.StringVariable
    key: target_prod_column
    requiresValue: false
    showOnReleaseStart: false
    value: "Prod Change #"
  - type: xlrelease.StringVariable
    key: target_prod_value
    requiresValue: false
    showOnReleaseStart: false
    value: prod_crq_number
  - type: xlrelease.StringVariable
    key: target_deploy_column
    requiresValue: false
    showOnReleaseStart: false
    value: Merged in Stage/Load
  - type: xlrelease.StringVariable
    key: smart_api_token
    requiresValue: false
    showOnReleaseStart: false
    label: SmartSheet Info
    value: H8m5oQPtyyuyo0nRfQgF3znA3ayYKEOWKR58c
  - type: xlrelease.StringVariable
    key: bot
    requiresValue: false
    showOnReleaseStart: false
    value: PCP Release Bot
  - type: xlrelease.StringVariable
    key: target_deploy_value
    requiresValue: false
    showOnReleaseStart: false
    value: "true"
  - type: xlrelease.ReferenceVariable
    key: test
    requiresValue: false
    showOnReleaseStart: false
    referencedType: msteams.Server
  - type: xlrelease.StringVariable
    key: invite_vision_receipients
    requiresValue: false
    showOnReleaseStart: false
    label: Meeting receipients List
    value: "WDAT.DL-studiovision@disney.com,WDAT.DL-AOE@disney.com,WDPRTechnologyDL-StudioKylo@disney.com,DPEP.DL-PCS.SRE@disney.com,WDAT.DL-Application.Deployment.Services@disney.com,DPEP.DL-EE.Systems.Engineering@disney.com,Cynthia.Cardona@disney.com,Sachita.Rane.-ND@disney.com,Keith.Waskom@disney.com,Sagar.Choudhari.-ND@disney.com,Kathy.M.Deleon@disney.com,Amit.Hathiramani@disney.com,Aaron.Caryl@disney.com,Nagi.X.Kolli.-ND@disney.com,Gurpreet.Kaur.-ND@disney.com,Malathi.X.Govindaraju.-ND@disney.com,Bhavana.X.Sharma.-ND@disney.com,DPEP.DL-GQEOnlineProductionSupport@disney.com,Mohisin.Anwar.Mohammed.-ND@disney.com"
    multiline: true
  - type: xlrelease.StringVariable
    key: invite_gamora_receipients
    requiresValue: false
    showOnReleaseStart: false
    label: Meeting receipients List
    value: "WDPR.DL-Digital.Studio.Gamora@disney.com,WDAT.DL-AOE@disney.com,WDPRTechnologyDL-StudioKylo@disney.com,DPEP.DL-PCS.SRE@disney.com,WDAT.DL-Application.Deployment.Services@disney.com,DPEP.DL-EE.Systems.Engineering@disney.com,Cynthia.Cardona@disney.com,Sachita.Rane.-ND@disney.com,Kathy.M.Deleon@disney.com,WDPR.DL-Digital.Studio.Nebula@disney.com,Amit.Hathiramani@disney.com,Aaron.Caryl@disney.com,Nagi.X.Kolli.-ND@disney.com,Gurpreet.Kaur.-ND@disney.com,Malathi.X.Govindaraju.-ND@disney.com,Bhavana.X.Sharma.-ND@disney.com,DPEP.DL-GQEOnlineProductionSupport@disney.com,Mohisin.Anwar.Mohammed.-ND@disney.com"
    multiline: true
  - type: xlrelease.BooleanVariable
    key: createNewQaChange
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: code_planning_chg_deploy_backout_info
    requiresValue: false
    showOnReleaseStart: false
    value: "Application Team: ${app_name} BAPP ID: ${app_bappid}\n${rollback_info}\n\
      ==========================================================\nADS RollBack Instructions\
      \ : \n==========================================================\nRundeck Project:\
      \ ${app_rundeck_nonprodjob}\nBuild version: ${rollback_version} \nEnvironment:\
      \ prod\n===================================================================="
    multiline: true
  - type: xlrelease.StringVariable
    key: ccb_ctask_type
    requiresValue: false
    showOnReleaseStart: false
    label: Change Task Type
    description: "Please select the type of the ctask. ( Note: If change is approved\
      \ then please select the type as \" UNPLANNED \""
    valueProvider:
      type: xlrelease.ListOfStringValueProviderConfiguration
      values:
      - implementation
      - validation
      - pre-work
      - pre-test
      - unplanned
    value: unplanned
  - type: xlrelease.StringVariable
    key: qa_new_sys_id
    requiresValue: false
    showOnReleaseStart: false
    label: Sys Id
    description: The technical id of the task.
  - type: xlrelease.StringVariable
    key: qa_new_crq_number
    requiresValue: false
    showOnReleaseStart: false
    label: Number
    description: The unique number of the task.
  - type: xlrelease.StringVariable
    key: se_channel_name
    requiresValue: false
    showOnReleaseStart: false
    label: Teams Channel Name for Release Notifications
    valueProvider:
      type: xlrelease.ListOfStringValueProviderConfiguration
      values:
      - csre-ops-public
    value: csre-ops-public
  - type: xlrelease.StringVariable
    key: stage_ccb_new_deploy_ctask_sys_id
    requiresValue: false
    showOnReleaseStart: false
    label: Sys Id
    description: The technical id of the task.
  - type: xlrelease.StringVariable
    key: stage_ccb_new_deploy_ctask_number
    requiresValue: false
    showOnReleaseStart: false
    label: Number
    description: The unique number of the task.
  - type: xlrelease.StringVariable
    key: load_ccb_new_deploy_ctask_sys_id
    requiresValue: false
    showOnReleaseStart: false
    label: Sys Id
    description: The technical id of the task.
  - type: xlrelease.StringVariable
    key: load_ccb_new_deploy_ctask_number
    requiresValue: false
    showOnReleaseStart: false
    label: Number
    description: The unique number of the task.
  - type: xlrelease.StringVariable
    key: loadvalidation_new_ctask_sys_id
    requiresValue: false
    showOnReleaseStart: false
    label: Sys Id
    description: The technical id of the task.
  - type: xlrelease.StringVariable
    key: loadvalidation_new_ctask_number
    requiresValue: false
    showOnReleaseStart: false
    label: Number
    description: The unique number of the task.
  - type: xlrelease.StringVariable
    key: target_new_qa_column
    requiresValue: false
    showOnReleaseStart: false
    value: "QA Change #"
  - type: xlrelease.StringVariable
    key: target_new_qa_value
    requiresValue: false
    showOnReleaseStart: false
    value: qa_new_crq_number
  - type: xlrelease.StringVariable
    key: qa_new_end_date
    requiresValue: false
    showOnReleaseStart: false
    label: Additional Fields
    description: Use ServiceNow technical field name as 'key' and the corresponding
      value.
  - type: xlrelease.StringVariable
    key: qa_new_start_date
    requiresValue: false
    showOnReleaseStart: false
    label: Additional Fields
    description: Use ServiceNow technical field name as 'key' and the corresponding
      value.
  - type: xlrelease.StringVariable
    key: createNewQaCtasks2
    requiresValue: false
    showOnReleaseStart: false
    label: Precondition
    description: A snippet of code that is evaluated when the task is started.
  - type: xlrelease.StringVariable
    key: createoldQaCtasks2
    requiresValue: false
    showOnReleaseStart: false
    label: Precondition
    description: A snippet of code that is evaluated when the task is started.
  - type: xlrelease.StringVariable
    key: createNewQaunplannedCtasks2
    requiresValue: false
    showOnReleaseStart: false
    label: Precondition
    description: A snippet of code that is evaluated when the task is started.
  - type: xlrelease.StringVariable
    key: rundeckStageJobFailed1
    requiresValue: false
    showOnReleaseStart: false
    label: Precondition
    description: A snippet of code that is evaluated when the task is started.
  - type: xlrelease.StringVariable
    key: rundeckLoadJobFailed1
    requiresValue: false
    showOnReleaseStart: false
    label: Precondition
    description: A snippet of code that is evaluated when the task is started.
  - type: xlrelease.ListStringVariable
    key: lambdaAppsList
    requiresValue: false
    showOnReleaseStart: false
    value:
    - DLR Ticket and Voucher Batch
    - DLR Ticket Order Batch
    - WDPR Trade Content Service
    - WDPR Trade Distributor Service
    - WDPR Trade Product Service
    - WDPR Trade Service Jobs
  - type: xlrelease.BooleanVariable
    key: createNewQaCtasks
    requiresValue: false
    showOnReleaseStart: false
    label: CCB create New QA Ctasks
    description: A snippet of code that is evaluated when the task is started.
  - type: xlrelease.BooleanVariable
    key: createoldQaCtasks
    requiresValue: false
    showOnReleaseStart: false
    label: CCB Create Old Change Ctasks
    description: A snippet of code that is evaluated when the task is started.
  - type: xlrelease.BooleanVariable
    key: createNewQaunplannedCtasks
    requiresValue: false
    showOnReleaseStart: false
    label: CCB Create New CHG Unplanned Ctasks
    description: A snippet of code that is evaluated when the task is started.
  - type: xlrelease.StringVariable
    key: nimbus_info_stage
    requiresValue: false
    showOnReleaseStart: false
    label: STage Nimbus Information
    description: "If you have any Nimbus Changes Then Please provide for Lower and\
      \ Higher Env's. NOTE: if you dont know the changes then PLEASE REPLACE NA with\
      \ SE Will Perform The CHanges"
    value: SE Changes - NA
    multiline: true
  - type: xlrelease.StringVariable
    key: nimbus_info_load
    requiresValue: false
    showOnReleaseStart: false
    label: Load Nimbus Information
    description: "If you have any Nimbus Changes Then Please provide for Lower and\
      \ Higher Env's. NOTE: if you dont know the changes then PLEASE REPLACE NA with\
      \ SE Will Perform The CHanges"
    value: SE Changes - NA
    multiline: true
  - type: xlrelease.BooleanVariable
    key: qa_old_end_date_valid
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.BooleanVariable
    key: qa_new_end_date_valid
    requiresValue: false
    showOnReleaseStart: false
  - type: xlrelease.StringVariable
    key: stage_new_adhoc_ctask_sys_id
    requiresValue: false
    showOnReleaseStart: false
    label: Sys Id
    description: The technical id of the task.
  - type: xlrelease.StringVariable
    key: stage_new_adhoc_ctask_number
    requiresValue: false
    showOnReleaseStart: false
    label: Number
    description: The unique number of the task.
  - type: xlrelease.MapStringStringVariable
    key: load_new_adhoc_ctask_data
    requiresValue: false
    showOnReleaseStart: false
    label: Data
    description: Data
  - type: xlrelease.StringVariable
    key: load_new_adhoc_ctask_sys_id
    requiresValue: false
    showOnReleaseStart: false
    label: Sys Id
    description: The technical id of the task.
  - type: xlrelease.StringVariable
    key: load_new_adhoc_ctask_number
    requiresValue: false
    showOnReleaseStart: false
    label: Number
    description: The unique number of the task.
  - type: xlrelease.StringVariable
    key: prod_ctask_type
    requiresValue: false
    showOnReleaseStart: false
    label: Change Task Type
    description: "Please select the type of the ctask. ( Note: If change is approved\
      \ then please select the type as \" UNPLANNED \""
    valueProvider:
      type: xlrelease.ListOfStringValueProviderConfiguration
      values:
      - implementation
      - validation
      - pre-work
      - pre-test
      - unplanned
    value: implementation
  - type: xlrelease.MapStringStringVariable
    key: WDPR
    requiresValue: false
    showOnReleaseStart: false
    value:
      end: 06:00:00
      start: 23:00:00
      std_mnt_window: "[23:00 - 06:00]"
      backout_rollback_time: 04:30:00
  - type: xlrelease.MapStringStringVariable
    key: WDPRD
    requiresValue: false
    showOnReleaseStart: false
    value:
      end: 06:00:00
      start: 23:00:00
      std_mnt_window: "[23:00 - 06:00]"
      backout_rollback_time: 04:30:00
  - type: xlrelease.StringVariable
    key: rundeck_deploy_lambda_options
    requiresValue: false
    showOnReleaseStart: false
    multiline: true
  - type: xlrelease.BooleanVariable
    key: rundeckStageJobFailed
    requiresValue: false
    showOnReleaseStart: false
    label: Precondition
    description: A snippet of code that is evaluated when the task is started.
  - type: xlrelease.BooleanVariable
    key: rundeckLoadJobFailed
    requiresValue: false
    showOnReleaseStart: false
    label: Precondition
    description: A snippet of code that is evaluated when the task is started.
  - type: xlrelease.ListStringVariable
    key: JiraIssueIds
    requiresValue: false
    showOnReleaseStart: false
    label: Issue keys
    description: Issue keys
  scriptUsername: admin
  scriptUserPassword: !value "xlrelease_Release_Deploy___SE___Optional_scriptUserPassword"
  riskProfile: Default risk profile
